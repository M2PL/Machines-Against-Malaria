{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "S5dz-2pZYlnw",
        "outputId": "0fed9b43-4474-4aae-a5b0-8d30e1cef73c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Mounted at /content/drive\n"
          ]
        }
      ],
      "source": [
        "# LOAD the data\n",
        "from google.colab import drive\n",
        "\n",
        "drive.mount('/content/drive')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "f7Hf4GsMY4b_",
        "outputId": "15c2a5f3-e252-4645-9f25-560a8761efb4"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n",
            "Collecting rdkit-pypi\n",
            "  Downloading rdkit_pypi-2022.9.5-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (29.4 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m29.4/29.4 MB\u001b[0m \u001b[31m23.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.9/dist-packages (from rdkit-pypi) (1.22.4)\n",
            "Requirement already satisfied: Pillow in /usr/local/lib/python3.9/dist-packages (from rdkit-pypi) (8.4.0)\n",
            "Installing collected packages: rdkit-pypi\n",
            "Successfully installed rdkit-pypi-2022.9.5\n",
            "\n",
            "real\t0m17.455s\n",
            "user\t0m8.333s\n",
            "sys\t0m0.896s\n"
          ]
        }
      ],
      "source": [
        "!time pip install rdkit-pypi"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "czGg-Fy5Y5Nv"
      },
      "outputs": [],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "# import seaborn as sn\n",
        "# import scipy as sp\n",
        "\n",
        "import random\n",
        "import tensorflow\n",
        "from tensorflow import keras\n",
        "from tensorflow.keras.models import Sequential\n",
        "from tensorflow.keras.layers import Activation, Dense, BatchNormalization, Conv2D, Dropout, Flatten\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.metrics import categorical_crossentropy\n",
        "from tensorflow.keras.wrappers.scikit_learn import KerasClassifier, KerasRegressor\n",
        "from sklearn.model_selection import GridSearchCV\n",
        "from sklearn.model_selection import cross_val_score\n",
        "from sklearn.preprocessing import LabelEncoder\n",
        "from sklearn.model_selection import StratifiedKFold\n",
        "\n",
        "from rdkit import Chem # A core definition\n",
        "from rdkit.Chem.Draw import MolsToGridImage # For displaying multiple molecules\n",
        "from rdkit.Chem.AllChem import * # conformer generation and adding H \n",
        "from rdkit.Chem.rdMolDescriptors import * # To calculate descriptors\n",
        "from rdkit.Chem.Draw import IPythonConsole # This displays the molecule in-line\n",
        "from rdkit.Chem import PandasTools # for pandas dataframe with rdkit\n",
        "from rdkit.DataStructs.cDataStructs import ConvertToNumpyArray\n",
        "import pandas.io.formats.style"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "2CftPmPDY82J",
        "outputId": "e90ff035-54b5-452c-85ae-329336137683"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/drive/MyDrive/PhD/PTS_datasets\n",
            " ABSActiveInactiveFeatCorrelationOnABSActives.csv\n",
            " ABSActiveInactiveFeatCorrelationOnABSInactives.csv\n",
            " absdualGBMFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " absdualLRFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " absdualRFFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " absdualsvmFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " asexualsFeaturesZtestprop.csv\n",
            " asexualsFeaturesZtestpropInact.csv\n",
            " asexualsFeaturesZtestproportionsActvsInactv.csv\n",
            " asexualsFeaturesZtestpropTopABSfeat.csv\n",
            " asexualsFeaturesZtestpropTopDualfeat.csv\n",
            " asexualsFeaturesZtestpropTopfeat.csv\n",
            " asexualsGBMhpt_UMFP_model5atom500bitFinal.pkl\n",
            " asexualsLogisticRegressionFinalHPT_UMFP_model5005.pkl\n",
            " asexualsSVCFinalHPT_UMFP_model5005.pkl\n",
            " axldeepinsighOverUnderXttestMFP.npy\n",
            " axldeepinsighOverUnderXttrainMFP.npy\n",
            " axldeepinsighOverUnderYttestMFP.npy\n",
            " axldeepinsighOverUnderYttrainMFP.npy\n",
            " axl_UnderMFP_GBM_HPT5005_FeatureImp.csv\n",
            " axl_UnderMFP_LR_HPT_FeatureImp.csv\n",
            " axl_UnderMFP_RF_HPT5005_FeatureImp2.csv\n",
            " CTCVAE_300bit5radiusMFP.pkl\n",
            " CTCVAE_300bit5raduisMFP_500samples.csv\n",
            " CTGAN_300bit5radiusMFP.pkl\n",
            " CTGAN_300bit5raduisMFP_500samples.csv\n",
            " data\n",
            " DualactiveFeaturesZtestprop.csv\n",
            " DualActiveInactiveFeatCorrelationOnDualActives.csv\n",
            " DualActiveInactiveFeatCorrelationOnDualInactives.csv\n",
            " finalized_model.sav\n",
            " GanSexualsU_MACCs.pkl\n",
            " image_at_epoch_0000.png\n",
            " M_asexuals_lib_hits_nd_clst_nhts.csv\n",
            " Miniconda3-py37_4.12.0-Linux-x86_64.sh\n",
            " M_sexual_LibrariesC_hits_nd_2ndclst_nhits.csv\n",
            "'Sexual_libraries_hits and nonhits_composition.csv'\n",
            " sexualsFeaturesZtestpropInact.csv\n",
            " SexualsFeaturesZtestpropTopABSfeat.csv\n",
            " SexualsFeaturesZtestpropTopDualfeat.csv\n",
            " sexualsGBMFinalHPT_UMFP_model5005.pkl\n",
            " sexualsLRFinalHPT_UMFP_model5005.pkl\n",
            " sexualsRFFinalHPT_UMFP_model5005.pkl\n",
            " sexualsSVCFinalHPT_UMFP_model5005.pkl\n",
            " sxl_UnderMACCS_LR_HPT_FeatureImp.csv\n",
            " sxl_UnderMFP_GBM_HPT5005_FeatureImp.csv\n",
            " sxl_UnderMFP_LR_HPT5005_FeatureImp.csv\n",
            " sxl_UnderMFP_RF_HPT5005_FeatureImp2.csv\n",
            " sxl_UnderMFP_RF_HPT_FeatureImp2.csv\n",
            " sxl_UnderX_MFP.csv\n",
            " sxl_UnderX_MFP.csv.npy\n",
            " sxl_UnderX_MFP.npy\n",
            " TCGANSexualsU_MACCs.pkl\n",
            "No     8975\n",
            "Yes     916\n",
            "Name: S_Hit, dtype: int64\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                                              Smiles S_Hit\n",
              "0     NC(=O)c1cccc2nc([C@H]3CCN(Cc4ccccn4)C3)[nH]c12   Yes\n",
              "1              Fc1ccc2[nH]c(C3CCCN3Cc3c[nH]cn3)nc2c1   Yes\n",
              "2                      COc1c(C)cnc(CN(C)C2CCCCC2)c1C   Yes\n",
              "3              Cc1cccc(CN2CCCC2c2cccc(Nc3nccs3)n2)c1   Yes\n",
              "4                 CCSCCNc1nc(-c2ccccn2)nc2c1c(C)nn2C   Yes\n",
              "...                                              ...   ...\n",
              "9886        Cc1nc(C)n(C2CCCN(C(=O)c3ncoc3C(C)C)C2)n1    No\n",
              "9887            COCCN1CCN(Cc2c(C)noc2C)Cc2ccc(C)nc21    No\n",
              "9888             CCc1ncnc2c1CCN(Cc1ccc3c(c1)OCO3)CC2    No\n",
              "9889            CCC1CN(CC(=O)NCCN2CCCCCC2)c2ccccc2S1    No\n",
              "9890              Cc1cnn(CC2CCCN2Cc2nc3ccccc3nc2C)c1    No\n",
              "\n",
              "[9891 rows x 2 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-c623c733-69e6-4387-ae8e-499c05c0c536\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Smiles</th>\n",
              "      <th>S_Hit</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NC(=O)c1cccc2nc([C@H]3CCN(Cc4ccccn4)C3)[nH]c12</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>Fc1ccc2[nH]c(C3CCCN3Cc3c[nH]cn3)nc2c1</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>COc1c(C)cnc(CN(C)C2CCCCC2)c1C</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>Cc1cccc(CN2CCCC2c2cccc(Nc3nccs3)n2)c1</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>CCSCCNc1nc(-c2ccccn2)nc2c1c(C)nn2C</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9886</th>\n",
              "      <td>Cc1nc(C)n(C2CCCN(C(=O)c3ncoc3C(C)C)C2)n1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9887</th>\n",
              "      <td>COCCN1CCN(Cc2c(C)noc2C)Cc2ccc(C)nc21</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9888</th>\n",
              "      <td>CCc1ncnc2c1CCN(Cc1ccc3c(c1)OCO3)CC2</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9889</th>\n",
              "      <td>CCC1CN(CC(=O)NCCN2CCCCCC2)c2ccccc2S1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9890</th>\n",
              "      <td>Cc1cnn(CC2CCCN2Cc2nc3ccccc3nc2C)c1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>9891 rows × 2 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c623c733-69e6-4387-ae8e-499c05c0c536')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-c623c733-69e6-4387-ae8e-499c05c0c536 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-c623c733-69e6-4387-ae8e-499c05c0c536');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 4
        }
      ],
      "source": [
        "############################################Sexual data\n",
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/PTS_datasets/\n",
        "!ls '/content/drive/MyDrive/PhD/PTS_datasets/'\n",
        "import pandas as pd\n",
        "sxl= pd.read_csv(\"M_sexual_LibrariesC_hits_nd_2ndclst_nhits.csv\")\n",
        "sxl['S_Hit'] = sxl['S_Hit'].replace(np.nan, \"No\")\n",
        "sxl = sxl.iloc[: , 1:]\n",
        "print(sxl['S_Hit'].value_counts())\n",
        "sxl"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "2QaSmxw8ZxdZ"
      },
      "source": [
        "# MACCSKeysFingerprint"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 537
        },
        "id": "Ob9Gky_4ZfDt",
        "outputId": "d0764049-7ca4-4d45-a3ee-056861f4a48b"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n",
            "Collecting deepchem\n",
            "  Downloading deepchem-2.7.1-py3-none-any.whl (693 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m693.2/693.2 KB\u001b[0m \u001b[31m12.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting scipy<1.9\n",
            "  Downloading scipy-1.8.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (42.2 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.2/42.2 MB\u001b[0m \u001b[31m12.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting rdkit\n",
            "  Downloading rdkit-2022.9.5-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (29.4 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m29.4/29.4 MB\u001b[0m \u001b[31m38.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.4.4)\n",
            "Requirement already satisfied: numpy>=1.21 in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.22.4)\n",
            "Requirement already satisfied: joblib in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.1.1)\n",
            "Requirement already satisfied: scikit-learn in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.2.2)\n",
            "Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.9/dist-packages (from pandas->deepchem) (2.8.2)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.9/dist-packages (from pandas->deepchem) (2022.7.1)\n",
            "Requirement already satisfied: Pillow in /usr/local/lib/python3.9/dist-packages (from rdkit->deepchem) (8.4.0)\n",
            "Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->deepchem) (3.1.0)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.9/dist-packages (from python-dateutil>=2.8.1->pandas->deepchem) (1.15.0)\n",
            "Installing collected packages: scipy, rdkit, deepchem\n",
            "  Attempting uninstall: scipy\n",
            "    Found existing installation: scipy 1.10.1\n",
            "    Uninstalling scipy-1.10.1:\n",
            "      Successfully uninstalled scipy-1.10.1\n",
            "Successfully installed deepchem-2.7.1 rdkit-2022.9.5 scipy-1.8.1\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.colab-display-data+json": {
              "pip_warning": {
                "packages": [
                  "rdkit",
                  "scipy"
                ]
              }
            }
          },
          "metadata": {}
        }
      ],
      "source": [
        "!pip install deepchem"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "sYQZg9gkZeF1",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "93c605e8-8f4a-429f-ad8a-91c52324fcc1"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "WARNING:deepchem.models.torch_models:Skipped loading modules with pytorch-geometric dependency, missing a dependency. No module named 'torch_geometric'\n",
            "WARNING:deepchem.models:Skipped loading modules with pytorch-geometric dependency, missing a dependency. cannot import name 'DMPNN' from 'deepchem.models.torch_models' (/usr/local/lib/python3.9/dist-packages/deepchem/models/torch_models/__init__.py)\n",
            "WARNING:deepchem.models:Skipped loading modules with pytorch-lightning dependency, missing a dependency. No module named 'pytorch_lightning'\n",
            "WARNING:deepchem.models:Skipped loading some Jax models, missing a dependency. No module named 'haiku'\n"
          ]
        }
      ],
      "source": [
        "import deepchem as dc\n",
        "from deepchem.feat import MACCSKeysFingerprint"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "3jAkY8TcbA2v",
        "outputId": "42cd17d5-e16b-4918-88a2-de1dc35b6616"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0    8975\n",
              "1     916\n",
              "Name: Target, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 7
        }
      ],
      "source": [
        "sxl[\"Target\"] = np.where(sxl[\"S_Hit\"]== \"Yes\", 1,0)\n",
        "sxl[\"Target\"].value_counts()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "hTSHuZYYaTmj",
        "outputId": "ced6a7fb-5f6d-4afc-c26f-23574e45ea77"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0       NC(=O)c1cccc2nc([C@H]3CCN(Cc4ccccn4)C3)[nH]c12\n",
              "1                Fc1ccc2[nH]c(C3CCCN3Cc3c[nH]cn3)nc2c1\n",
              "2                        COc1c(C)cnc(CN(C)C2CCCCC2)c1C\n",
              "3                Cc1cccc(CN2CCCC2c2cccc(Nc3nccs3)n2)c1\n",
              "4                   CCSCCNc1nc(-c2ccccn2)nc2c1c(C)nn2C\n",
              "                             ...                      \n",
              "9886          Cc1nc(C)n(C2CCCN(C(=O)c3ncoc3C(C)C)C2)n1\n",
              "9887              COCCN1CCN(Cc2c(C)noc2C)Cc2ccc(C)nc21\n",
              "9888               CCc1ncnc2c1CCN(Cc1ccc3c(c1)OCO3)CC2\n",
              "9889              CCC1CN(CC(=O)NCCN2CCCCCC2)c2ccccc2S1\n",
              "9890                Cc1cnn(CC2CCCN2Cc2nc3ccccc3nc2C)c1\n",
              "Name: Smiles, Length: 9891, dtype: object"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ],
      "source": [
        "dchm= sxl[\"Smiles\"]\n",
        "dchm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "U9oQ6FwCZojx",
        "outputId": "2c1562a9-1f52-40d0-d107-673564eb2692"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 0, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       ...,\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 0, 1, 0]])"
            ]
          },
          "metadata": {},
          "execution_count": 9
        }
      ],
      "source": [
        "mols = [Chem.MolFromSmiles(x) for x in dchm]\n",
        "featurizer = MACCSKeysFingerprint()\n",
        "maccs = featurizer.featurize(mols)\n",
        "maccs"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "4UCT8af-aXiI",
        "outputId": "23c39530-8203-493d-a926-a588032eed54"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 1 0 1 0 1 1 0 0 1 1 1 1 0 0 0 1 1 1 0 0 0 1 1 1 0 1 1 0 0 0 1 0 0 0 0 1\n",
            " 1 0 0 0 0 0 1 1 0 1 1 1 0 0 1 0 0 1 1 0 1 0 0 0 0 0 1 1 0 0 0 1 0 0 1 0 1\n",
            " 1 0 0 1 0 1 1 1 1 0 1 0 0 1 1 1 1 1 0]\n",
            "Target 1\n",
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 0 1 0 0 0 0 1 1 0 0 0 0 1 1 0 1 1 0 1 1 0 1 1 0 0 1 1 0 0 1 0 1\n",
            " 1 0 1 0 0 0 1 1 0 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 0 0 1 1 1 0 0 1 1 1 1 0 1\n",
            " 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]\n",
            "Target [1. 0.]\n",
            "Xt-train input shape: (7912, 167)\n",
            "Yt-train label shape: (7912, 2)\n"
          ]
        }
      ],
      "source": [
        "#Split\n",
        "\n",
        "Xt = np.array(maccs)\n",
        "Yt = np.array(list(sxl[\"Target\"]))\n",
        "print(\"Input\",Xt[0])\n",
        "print(\"Target\",Yt[0])\n",
        "\n",
        "#Split\n",
        "from sklearn.model_selection import train_test_split\n",
        "Xt_train, Xt_test = train_test_split(Xt, test_size=0.2)\n",
        "Yt_train, Yt_test = train_test_split(Yt, test_size=0.2)\n",
        "\n",
        "y_true= Yt_test\n",
        "\n",
        "Yt_train = keras.utils.to_categorical(Yt_train)\n",
        "Yt_test = keras.utils.to_categorical(Yt_test)\n",
        "\n",
        "print(\"Input\",Xt_train[0])\n",
        "print(\"Target\",Yt_train[0])\n",
        "print(\"Xt-train input shape:\", Xt_train.shape)\n",
        "print(\"Yt-train label shape:\", Yt_train.shape)\n",
        "# print(Xt_train.shape)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "5W1SfXrOEUkg",
        "outputId": "9653eb22-8e5b-43d4-e1da-288e66e1cff7"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([0, 0, 0])"
            ]
          },
          "metadata": {},
          "execution_count": 11
        }
      ],
      "source": [
        "###check to see if hits are in correct places\n",
        "maccs[0:4]\n",
        "Yt[0:4]\n",
        "maccs[9887:9890]\n",
        "Yt[9887:9890]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 423
        },
        "id": "OJSxLbwknW-s",
        "outputId": "55fbe5cf-66a8-436a-a225-2fb161bc13c1"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "      0    1    2    3    4    5    6    7    8    9    ...  157  158  159  \\\n",
              "0       0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "1       0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "2       0    0    0    0    0    0    0    0    0    0  ...    1    1    0   \n",
              "3       0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "4       0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "...   ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...   \n",
              "9886    0    0    0    0    0    0    0    0    0    0  ...    0    1    1   \n",
              "9887    0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "9888    0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "9889    0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "9890    0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "\n",
              "      160  161  162  163  164  165  166  \n",
              "0       0    1    1    1    1    1    0  \n",
              "1       0    1    1    1    0    1    0  \n",
              "2       1    1    1    1    1    1    0  \n",
              "3       1    1    1    1    0    1    0  \n",
              "4       1    1    1    1    0    1    0  \n",
              "...   ...  ...  ...  ...  ...  ...  ...  \n",
              "9886    1    1    1    1    1    1    0  \n",
              "9887    1    1    1    1    1    1    0  \n",
              "9888    1    1    1    1    1    1    0  \n",
              "9889    1    1    1    1    1    1    0  \n",
              "9890    1    1    1    1    0    1    0  \n",
              "\n",
              "[9891 rows x 167 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-ad865752-c3e4-47cb-8d52-374f0ee62922\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "      <th>1</th>\n",
              "      <th>2</th>\n",
              "      <th>3</th>\n",
              "      <th>4</th>\n",
              "      <th>5</th>\n",
              "      <th>6</th>\n",
              "      <th>7</th>\n",
              "      <th>8</th>\n",
              "      <th>9</th>\n",
              "      <th>...</th>\n",
              "      <th>157</th>\n",
              "      <th>158</th>\n",
              "      <th>159</th>\n",
              "      <th>160</th>\n",
              "      <th>161</th>\n",
              "      <th>162</th>\n",
              "      <th>163</th>\n",
              "      <th>164</th>\n",
              "      <th>165</th>\n",
              "      <th>166</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9886</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9887</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9888</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9889</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9890</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>9891 rows × 167 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ad865752-c3e4-47cb-8d52-374f0ee62922')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-ad865752-c3e4-47cb-8d52-374f0ee62922 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-ad865752-c3e4-47cb-8d52-374f0ee62922');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 12
        }
      ],
      "source": [
        "df=[]\n",
        "df = pd.DataFrame(maccs)\n",
        "#df[\"Target\"]= sxl[\"Target\"]\n",
        "df"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ch8uoenvndIx"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "Xt_train, Xt_test, Yt_train, Yt_test = train_test_split(df, sxl[\"Target\"],test_size=0.2, random_state=42)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "nYysoO4qEVy1"
      },
      "outputs": [],
      "source": [
        "######################################################################XGBoost (https://www.analyticsvidhya.com/blog/2020/07/10-techniques-to-deal-with-class-imbalance-in-machine-learning/)\n",
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "\n",
        "xgbc = GradientBoostingClassifier()\n",
        "\n",
        "# fit the predictor and target\n",
        "xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "xgbc_predict = xgbc.predict(Xt_test)# check performance\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "LWrdx41Cnz6Y",
        "outputId": "da83d353-c907-4661-eb08-0c95158f3aff"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "/content\n",
            "0.9666498231430015\n"
          ]
        }
      ],
      "source": [
        "# Save Model Using joblib\n",
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "%cd /content/\n",
        "# save the model to disk\n",
        "filename = 'sexualsXGBoost_UMACCS_model.sav'\n",
        "joblib.dump(xgbc, filename)\n",
        " \n",
        "# some time later...\n",
        " \n",
        "# load the model from disk\n",
        "loaded_model = joblib.load(filename)\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "xwixRSN6n7K0"
      },
      "outputs": [],
      "source": [
        "!cp 'sexualsXGBoost_UMACCS_model.sav' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ENq6VsgWn3jZ",
        "outputId": "a1f43cd7-6ba7-4862-fa02-40cc019edf49"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "/content/drive/MyDrive/PhD/XGBoost_MACCS\n",
            "sexualsXGBoost_UMACCS_model.sav\n"
          ]
        }
      ],
      "source": [
        "###Import model\n",
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/XGBoost_MACCS\n",
        "!ls '/content/drive/MyDrive/PhD/XGBoost_MACCS'"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "g1YPBp8un0Iq",
        "outputId": "118e5747-7aa1-43b8-ae98-aef64e3b6571"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "0.9666498231430015\n"
          ]
        }
      ],
      "source": [
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "# load the model from disk\n",
        "loaded_model = joblib.load('/content/drive/MyDrive/PhD/XGBoost_MACCS/sexualsXGBoost_UMACCS_model.sav')\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "6QjNj3qdnjmg",
        "outputId": "a3e4e074-0657-415c-bf15-1bfb98e58f26"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Accuracy: 0.966650\n",
            "Recall 0.701571\n",
            "precision 0.937063\n",
            "F1 score: 0.802395\n"
          ]
        },
        {
          "data": {
            "text/plain": [
              "array([[1779,    9],\n",
              "       [  57,  134]])"
            ]
          },
          "execution_count": 20,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgbc_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgbc_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgbc_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgbc_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgbc_predict)\n",
        "cm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "x89_mEJxnqjB",
        "outputId": "4ac79dd8-ddb7-4d7b-c908-652f0120c0c7"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "ROCAUC score: 0.8482685617906462\n",
            "Accuracy score: 0.9666498231430015\n",
            "F1 score: 0.8023952095808383\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgbc_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgbc_predict))\n",
        "print('F1 score:',f1_score(Yt_test,xgbc_predict))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "BxsLy-iynwgM",
        "outputId": "bd498cc6-9433-44ba-bf85-a7edddfa9fc7"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Cohens kappa: 0.784593\n",
            "ROC AUC: 0.848269\n",
            "[[1779    9]\n",
            " [  57  134]]\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgbc_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgbc_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgbc_predict)\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "iAXL4ZfIq29T",
        "outputId": "e7590b75-d0ea-4b6c-9d8d-71955fedc17b"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Test Set: 1979\n",
            "0    1788\n",
            "1     191\n",
            "Name: Target, dtype: int64\n",
            "[[1779    9]\n",
            " [  57  134]]\n"
          ]
        }
      ],
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "E9gDI4nzvqF1"
      },
      "outputs": [],
      "source": [
        "##################################################Cross validation kfold=10\n",
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "\n",
        "xgbc = GradientBoostingClassifier()\n",
        "\n",
        "# fit the predictor and target\n",
        "fit= xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "xgbc_predict = xgbc.predict(Xt_test)# check performance\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Svk23mW2vqJ1"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(xgbc,Xt_train, Yt_train, cv=10)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "-N32Og9CvqNK",
        "outputId": "1baa59d9-926d-496a-e10e-00996c003956"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "0.96 accuracy with a standard deviation of 0.00\n"
          ]
        }
      ],
      "source": [
        "print(\"%0.2f accuracy with a standard deviation of %0.2f\" % (scores.mean(), scores.std()))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "V0xRyWIqvqQc",
        "outputId": "dc1034af-3d42-42af-f2b6-8a73563bb718"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Accuracy: 0.966650\n",
            "Recall 0.701571\n",
            "precision 0.937063\n",
            "F1 score: 0.802395\n"
          ]
        },
        {
          "data": {
            "text/plain": [
              "array([[1779,    9],\n",
              "       [  57,  134]])"
            ]
          },
          "execution_count": 17,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgbc_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgbc_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgbc_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgbc_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgbc_predict)\n",
        "cm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "j_jiEXdWvqTj",
        "outputId": "9f9ea2cc-40ef-4b9c-b940-423d820863cf"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "ROCAUC score: 0.8482685617906462\n",
            "Accuracy score: 0.9666498231430015\n",
            "F1 score: 0.8023952095808383\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgbc_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgbc_predict))\n",
        "print('F1 score:',f1_score(Yt_test,xgbc_predict))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "nLQRkJsWvqYm",
        "outputId": "e9ce5720-1e00-4ac4-cd65-ecc695c60ecc"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Cohens kappa: 0.784593\n",
            "ROC AUC: 0.848269\n",
            "[[1779    9]\n",
            " [  57  134]]\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgbc_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgbc_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgbc_predict)\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Ajq00dy_wLx_",
        "outputId": "a49de83a-2654-40c1-856b-942302eef1d9"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Test Set: 1979\n",
            "0    1788\n",
            "1     191\n",
            "Name: Target, dtype: int64\n",
            "[[1779    9]\n",
            " [  57  134]]\n"
          ]
        }
      ],
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "b3vlYuHR0Fja"
      },
      "source": [
        "# Hyperparameter Tuning\n",
        "\n",
        "---\n",
        "\n",
        "Random Forest Hyperparameters we’ll be Looking at:\n",
        "\n",
        "*   Number of trees (n_estimators)\n",
        "*   Number of Samples (subsample)\n",
        "*   Number of Features (max_features)\n",
        "*   Learning Rate\n",
        "*   Tree Depth (max_depth)\n",
        "---\n",
        "https://machinelearningmastery.com/gradient-boosting-machine-ensemble-in-python/\n",
        "https://www.analyticsvidhya.com/blog/2016/02/complete-guide-parameter-tuning-gradient-boosting-gbm-python/\n",
        "https://machinelearningmastery.com/gradient-boosting-with-scikit-learn-xgboost-lightgbm-and-catboost/"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "o_FBs4at2YL2"
      },
      "outputs": [],
      "source": [
        "\n",
        "# evaluate gradient boosting algorithm for classification\n",
        "from numpy import mean\n",
        "from numpy import std\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import cross_val_score\n",
        "from sklearn.model_selection import RepeatedStratifiedKFold\n",
        "from sklearn.ensemble import GradientBoostingClassifier"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 369
        },
        "id": "mmaftIv_2YT_",
        "outputId": "e0cd160d-9880-46d4-f859-b3860c848b59"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">10 0.943 (0.003)\n",
            ">50 0.960 (0.005)\n",
            ">100 0.965 (0.005)\n",
            ">500 0.977 (0.004)\n",
            ">1000 0.979 (0.004)\n",
            ">5000 0.978 (0.005)\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ],
      "source": [
        "\n",
        "# explore gradient boosting number of trees effect on performance\n",
        "from numpy import mean\n",
        "from numpy import std\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import cross_val_score\n",
        "from sklearn.model_selection import RepeatedStratifiedKFold\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "from matplotlib import pyplot\n",
        " \n",
        " \n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# define number of trees to consider\n",
        "\tn_trees = [10, 50, 100, 500, 1000, 5000]\n",
        "\tfor n in n_trees:\n",
        "\t\tmodels[str(n)] = GradientBoostingClassifier(n_estimators=n)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        "# define dataset\n",
        "X = df\n",
        "y = sxl[\"Target\"]\n",
        "\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "CF19PqYY2YVP",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 612
        },
        "outputId": "2c378cd9-1707-467b-bcb3-b5add15117e9"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">0.1 0.940 (0.025)\n",
            ">1.1 nan (nan)\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py:372: FitFailedWarning: \n",
            "30 fits failed out of a total of 30.\n",
            "The score on these train-test partitions for these parameters will be set to nan.\n",
            "If these failures are not expected, you can try to debug them by setting error_score='raise'.\n",
            "\n",
            "Below are more details about the failures:\n",
            "--------------------------------------------------------------------------------\n",
            "30 fits failed with the following error:\n",
            "Traceback (most recent call last):\n",
            "  File \"/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\", line 680, in _fit_and_score\n",
            "    estimator.fit(X_train, y_train, **fit_params)\n",
            "  File \"/usr/local/lib/python3.7/dist-packages/sklearn/ensemble/_gb.py\", line 525, in fit\n",
            "    self._check_params()\n",
            "  File \"/usr/local/lib/python3.7/dist-packages/sklearn/ensemble/_gb.py\", line 317, in _check_params\n",
            "    raise ValueError(\"subsample must be in (0,1] but was %r\" % self.subsample)\n",
            "ValueError: subsample must be in (0,1] but was 1.1\n",
            "\n",
            "  warnings.warn(some_fits_failed_message, FitFailedWarning)\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXoAAAD4CAYAAADiry33AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAQAklEQVR4nO3df6zddX3H8eeLQuemoEBv2EaR1gSzXpGIHrst6yxo5gp/QGC/qDrt0siSDfaPZIHUDFbTsES2mLBuhKXMoVkbQqY2kYiGHzFdWNJToHXlrnhHFFo2uQyJcYy10Pf+uKfscL3tPbWnPe3nPh9Jwzmfz/fc+z6hed5vzzn3nFQVkqR2nTbqASRJx5ehl6TGGXpJapyhl6TGGXpJatzpox5gpkWLFtWSJUtGPYYknVJ27NjxYlWNzbZ30oV+yZIldLvdUY8hSaeUJN8/3J4P3UhS4wy9JDXO0EtS4wy9JDXO0EtS4wy9JDXO0EtS4wy9JDXupPuFKf10khz1bfwsAml+MPSNOFy0kxh0aZ7zoRtJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGDRT6JKuS7EkymeTmWfYvTPJQkl1JHk2yuG/vnUm+mWQiyVNJlgxvfEnSXOYMfZIFwEbgCmAcWJ1kfMZhdwD3VtUlwHrg9r69e4HPV9UyYDnwwjAGlyQNZpAz+uXAZFU9U1X7gS3A1TOOGQce7l1+5NB+7wfC6VX1LYCq+nFVvTKUySVJAxkk9OcDz/Vd39tb67cTuLZ3+RrgzCTnAu8GXk7yT0meSPL53r8Q3iTJ9Um6SbpTU1NHfy8kSYc1rCdjbwJWJnkCWAnsA15n+oNNfr23/0HgXcCamTeuqrurqlNVnbGxsSGNJEmCwUK/D7ig7/ri3tobqur5qrq2qi4F1vXWXmb67P/J3sM+rwFfBd4/lMklSQMZJPTbgYuSLE2yELgO2Np/QJJFSQ59rVuAe/pu+44kh07TPww8dexjS5IGNWfoe2fiNwAPAhPAfVW1O8n6JFf1DrsM2JPkaeA8YEPvtq8z/bDNQ0m+AwT4u6Hfi3nknHPOIcnAf4CjOj4J55xzzojvpaRhysn2wdGdTqe63e6oxzhpnYgP+/YDxaVTT5IdVdWZbc/fjJWkxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxhl6SWqcoZekxp0+6gF0dOrWs+C2tx//7yGpGYb+FJM//xFVdXy/R0Lddly/haQTyIduJKlxhl6SGmfoJalxhl6SGjdQ6JOsSrInyWSSm2fZvzDJQ0l2JXk0yeIZ+2cl2Zvkr4c1uOY29coUa76xhhf/58VRjyJphOYMfZIFwEbgCmAcWJ1kfMZhdwD3VtUlwHrg9hn7nwO+fezj6mjctesuHv/B49y1865RjyJphAY5o18OTFbVM1W1H9gCXD3jmHHg4d7lR/r3k3wAOA/45rGPq0FNvTLF1ya/RlF8dfKrntVL89ggoT8feK7v+t7eWr+dwLW9y9cAZyY5N8lpwF8CNx3pGyS5Pkk3SXdqamqwyXVEd+26i4N1EICDddCzemkeG9aTsTcBK5M8AawE9gGvA38EPFBVe49046q6u6o6VdUZGxsb0kjz16Gz+QMHDwBw4OABz+qleWyQ0O8DLui7vri39oaqer6qrq2qS4F1vbWXgV8FbkjyPaYfx/9kkr8YxuA6vP6z+UM8q5fmr0HeAmE7cFGSpUwH/jrgY/0HJFkEvFRVB4FbgHsAqurjfcesATpV9ROv2tFw7Xxh5xtn84ccOHiAJ194ckQTSRqlOUNfVa8luQF4EFgA3FNVu5OsB7pVtRW4DLg9STH96po/Po4zaw73X3X/qEeQdBLJ8X6DrKPV6XSq2+2OeoyTVpIT86ZmJ9nfC0lHlmRHVXVm2/M3YyWpcYZekhpn6CWpcYZekhpn6CWpcYZekhpn6CWpcYZekhpn6CWpcYZekhpn6CWpcYZekhpn6CWpcYZekhpn6CWpcYZekhpn6CWpcYN8ZqxOMkmO69c/++yzj+vXl3RiGfpTzNF+xJ8fCyjJh24kqXGGXpIaZ+glqXGGXpIaZ+glqXGGXpIaZ+glqXEDhT7JqiR7kkwmuXmW/QuTPJRkV5JHkyzurb8vyWNJdvf2fm/Yd0CSdGRzhj7JAmAjcAUwDqxOMj7jsDuAe6vqEmA9cHtv/RXgk1X1HmAV8IUk7xjW8JKkuQ1yRr8cmKyqZ6pqP7AFuHrGMePAw73Ljxzar6qnq+q7vcvPAy8AY8MYXJI0mEFCfz7wXN/1vb21fjuBa3uXrwHOTHJu/wFJlgMLgX//6UaVJP00hvVk7E3AyiRPACuBfcDrhzaT/ALwJeAPqurgzBsnuT5JN0l3ampqSCNJkmCw0O8DLui7vri39oaqer6qrq2qS4F1vbWXAZKcBXwdWFdV/zLbN6iqu6uqU1WdsTEf2ZGkYRok9NuBi5IsTbIQuA7Y2n9AkkVJDn2tW4B7eusLga8w/UTt/cMbW5I0qDlDX1WvATcADwITwH1VtTvJ+iRX9Q67DNiT5GngPGBDb/13gQ8Ba5I82fvzvmHfCUnS4eVke6/yTqdT3W531GM0w/ejl+aHJDuqqjPbnr8ZK0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNM/SS1DhDL0mNGyj0SVYl2ZNkMsnNs+xfmOShJLuSPJpkcd/ep5J8t/fnU8McXpI0tzlDn2QBsBG4AhgHVicZn3HYHcC9VXUJsB64vXfbc4BbgV8GlgO3Jjl7eONLkuYyyBn9cmCyqp6pqv3AFuDqGceMAw/3Lj/St/+bwLeq6qWq+iHwLWDVsY8tSRrUIKE/H3iu7/re3lq/ncC1vcvXAGcmOXfA25Lk+iTdJN2pqalBZ5ckDWBYT8beBKxM8gSwEtgHvD7ojavq7qrqVFVnbGxsSCNJkgBOH+CYfcAFfdcX99beUFXP0zujT/I24Leq6uUk+4DLZtz20WOYV5J0lAY5o98OXJRkaZKFwHXA1v4DkixKcuhr3QLc07v8IPDRJGf3noT9aG9NknSCzBn6qnoNuIHpQE8A91XV7iTrk1zVO+wyYE+Sp4HzgA29274EfI7pHxbbgfW9NUnSCZKqGvUMb9LpdKrb7Y56jGYk4WT7fyxp+JLsqKrObHv+ZqwkNc7QS1LjDL0kNc7QS1LjDL0kNc7QS1LjDL0kNc7QS1LjDL0kNc7QS1LjDL0kNc7QS1LjBnk/ep0Ckhz1nm92Js0Phr4RRlvS4fjQjSQ1ztBLUuMMvSQ1ztBLUuMMvSQ1ztBLUuMMvSQ1ztBLUuMMvSQ1ztBLUuMMvSQ1ztBLUuMGCn2SVUn2JJlMcvMs++9M8kiSJ5LsSnJlb/2MJP+Q5DtJJpLcMuw7IEk6sjlDn2QBsBG4AhgHVicZn3HYZ4H7qupS4Drgb3rrvwP8TFW9F/gA8IdJlgxndEnSIAY5o18OTFbVM1W1H9gCXD3jmALO6l1+O/B83/pbk5wO/CywH/jRMU8tSRrYIKE/H3iu7/re3lq/24BPJNkLPADc2Fu/H/hv4D+AZ4E7quqlYxlYknR0hvVk7Grgi1W1GLgS+FKS05j+18DrwC8CS4HPJHnXzBsnuT5JN0l3ampqSCNJkmCw0O8DLui7vri31m8tcB9AVT0GvAVYBHwM+EZVHaiqF4B/Bjozv0FV3V1VnarqjI2NHf29kCQd1iCh3w5clGRpkoVMP9m6dcYxzwIfAUiyjOnQT/XWP9xbfyvwK8C/DWd0SdIg5gx9Vb0G3AA8CEww/eqa3UnWJ7mqd9hngE8n2QlsBtbU9IeYbgTelmQ30z8w/r6qdh2POyJJml1Otg+V7nQ61e12Rz2GJJ1Skuyoqp94aBz8zVhJap6hl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJapyhl6TGGXpJatxAoU+yKsmeJJNJbp5l/51JHknyRJJdSa7s27skyWNJdif5TpK3DPMOSJKO7PS5DkiyANgI/AawF9ieZGtVPdV32GeB+6rqb5OMAw8AS5KcDnwZ+P2q2pnkXODA0O+FJOmwBjmjXw5MVtUzVbUf2AJcPeOYAs7qXX478Hzv8keBXVW1E6Cq/quqXj/2sSVJgxok9OcDz/Vd39tb63cb8Ikke5k+m7+xt/5uoJI8mOTxJH862zdIcn2SbpLu1NTUUd0BzW7z5s1cfPHFLFiwgIsvvpjNmzePeiRJIzKsJ2NXA1+sqsXAlcCXkpzG9ENDK4CP9/57TZKPzLxxVd1dVZ2q6oyNjQ1ppPlr8+bNrFu3jjvvvJNXX32VO++8k3Xr1hl7aZ4aJPT7gAv6ri/urfVbC9wHUFWPAW8BFjF99v/tqnqxql5h+mz//cc6tI5sw4YNbNq0icsvv5wzzjiDyy+/nE2bNrFhw4ZRjyZpBAYJ/XbgoiRLkywErgO2zjjmWeAjAEmWMR36KeBB4L1Jfq73xOxK4Cl0XE1MTLBixYo3ra1YsYKJiYkRTSRplOYMfVW9BtzAdLQnmH51ze4k65Nc1TvsM8Cnk+wENgNratoPgb9i+ofFk8DjVfX143FH9P+WLVvGtm3b3rS2bds2li1bNqKJJI3SnC+vBKiqB5h+2KV/7c/6Lj8F/Nphbvtlpl9iqRNk3bp1rF27lk2bNrFixQq2bdvG2rVrfehGmqcGCr1OLatXrwbgxhtvZGJigmXLlrFhw4Y31iXNL6mqUc/wJp1Op7rd7qjHkKRTSpIdVdWZbc/3upGkxhl6SWqcoZekxhl6SWqcoZekxp10r7pJMgV8f9RzNGQR8OKoh5AOw7+fw3NhVc36ZmEnXeg1XEm6h3vJlTRq/v08MXzoRpIaZ+glqXGGvn13j3oA6Qj8+3kC+Bi9JDXOM3pJapyhl6TGGfpGJFmVZE+SySQ3z7L/od4HtL+W5LdHMaPmpyT3JHkhyb8eZv+XkjyW5H+T3HSi55sPDH0DkiwANgJXAOPA6iTjMw57FlgD/OOJnU7ii8CqI+y/BPwJcMcJmWYeMvRtWA5MVtUzVbUf2AJc3X9AVX2vqnYBB0cxoOavqvo20zE/3P4LVbUdOHDipppfDH0bzgee67u+t7cmSYZeklpn6NuwD7ig7/ri3pokGfpGbAcuSrI0yULgOmDriGeSdJLwN2MbkeRK4AvAAuCeqtqQZD3QraqtST4IfAU4G3gV+M+qes/oJtZ8kWQzcBnTb0n8A+BW4AyAqroryc8DXeAspl8s8GNgvKp+NJKBG2ToJalxPnQjSY0z9JLUOEMvSY0z9JLUOEMvSY0z9JLUOEMvSY37P9EITaraZRbmAAAAAElFTkSuQmCC\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ],
      "source": [
        "\n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# explore sample ratio from 10% to 100% in 10% increments\n",
        "\tfor i in (0.1, 1.1, 0.1):\n",
        "\t\tkey = '%.1f' % i\n",
        "\t\tmodels[key] = GradientBoostingClassifier(subsample=i, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        "# define dataset\n",
        "X = df\n",
        "y = sxl[\"Target\"]\n",
        "\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "syMcJGhb2YX6",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 466
        },
        "outputId": "bb73484d-2164-4597-d254-b756847e205e"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">1 0.963 (0.019)\n",
            ">2 0.935 (0.094)\n",
            ">3 0.953 (0.047)\n",
            ">4 0.916 (0.098)\n",
            ">5 0.898 (0.109)\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "KeyboardInterrupt",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-19-42d68f428fb7>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     25\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     26\u001b[0m         \u001b[0;31m# evaluate the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 27\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mevaluate_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     28\u001b[0m         \u001b[0;31m# store the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     29\u001b[0m         \u001b[0mresults\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscores\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m<ipython-input-19-42d68f428fb7>\u001b[0m in \u001b[0;36mevaluate_model\u001b[0;34m(model, X, y)\u001b[0m\n\u001b[1;32m     13\u001b[0m         \u001b[0mcv\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mRepeatedStratifiedKFold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn_splits\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m10\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_repeats\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrandom_state\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     14\u001b[0m         \u001b[0;31m# evaluate the model and collect the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 15\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcross_val_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mscoring\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'accuracy'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcv\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     16\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mscores\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     17\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_val_score\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, error_score)\u001b[0m\n\u001b[1;32m    518\u001b[0m         \u001b[0mfit_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfit_params\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    519\u001b[0m         \u001b[0mpre_dispatch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpre_dispatch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 520\u001b[0;31m         \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    521\u001b[0m     )\n\u001b[1;32m    522\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mcv_results\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"test_score\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_validate\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, return_train_score, return_estimator, error_score)\u001b[0m\n\u001b[1;32m    281\u001b[0m             \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    282\u001b[0m         )\n\u001b[0;32m--> 283\u001b[0;31m         \u001b[0;32mfor\u001b[0m \u001b[0mtrain\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgroups\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    284\u001b[0m     )\n\u001b[1;32m    285\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m   1054\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1055\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieval_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1056\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1057\u001b[0m             \u001b[0;31m# Make sure that we get a last message telling us we are done\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1058\u001b[0m             \u001b[0melapsed_time\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_start_time\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36mretrieve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    933\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    934\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'supports_timeout'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 935\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    936\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    937\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/_parallel_backends.py\u001b[0m in \u001b[0;36mwrap_future_result\u001b[0;34m(future, timeout)\u001b[0m\n\u001b[1;32m    540\u001b[0m         AsyncResults.get from multiprocessing.\"\"\"\n\u001b[1;32m    541\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 542\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfuture\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    543\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mCfTimeoutError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    544\u001b[0m             \u001b[0;32mraise\u001b[0m \u001b[0mTimeoutError\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/concurrent/futures/_base.py\u001b[0m in \u001b[0;36mresult\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    428\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__get_result\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    429\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 430\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_condition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    431\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    432\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_state\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mCANCELLED\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mCANCELLED_AND_NOTIFIED\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/threading.py\u001b[0m in \u001b[0;36mwait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    294\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m    \u001b[0;31m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    295\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 296\u001b[0;31m                 \u001b[0mwaiter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macquire\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    297\u001b[0m                 \u001b[0mgotit\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    298\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          ]
        }
      ],
      "source": [
        "\n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# explore number of features from 1 to 20\n",
        "\tfor i in range(1,21):\n",
        "\t\tmodels[str(i)] = GradientBoostingClassifier(max_features=i, subsample=0.1, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        "# define dataset\n",
        "X = df\n",
        "y = sxl[\"Target\"]\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "2yQ8aIwf4HNr"
      },
      "outputs": [],
      "source": [
        " \n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# define learning rates to explore\n",
        "\tfor i in [0.0001, 0.001, 0.01, 0.1, 1.0]:\n",
        "\t\tkey = '%.4f' % i\n",
        "\t\tmodels[key] = GradientBoostingClassifier(learning_rate=i, max_features=i, subsample=0.1, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        "# define dataset\n",
        "X = df\n",
        "y = sxl[\"Target\"]\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "nXAFYhA74Tdf"
      },
      "outputs": [],
      "source": [
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# define max tree depths to explore between 1 and 10\n",
        "\tfor i in range(1,11):\n",
        "\t\tmodels[str(i)] = GradientBoostingClassifier(max_depth=i, learning_rate=i, max_features=i, subsample=0.1, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        "# define dataset\n",
        "X = df\n",
        "y = sxl[\"Target\"]\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "vK6xPJUY4ZBH",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "3e2b706d-775a-43e3-de40-6af24a3c9707"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Best: 0.969877 using {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.908367 (0.000610) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.908367 (0.000610) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.908367 (0.000610) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.960439 (0.005620) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.969413 (0.005733) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.969877 (0.005482) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.959385 (0.014274) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.693676 (0.179044) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.674639 (0.170951) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n"
          ]
        }
      ],
      "source": [
        "# example of grid searching key hyperparameters for gradient boosting on a classification dataset\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import RepeatedStratifiedKFold\n",
        "from sklearn.model_selection import GridSearchCV\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "# define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "# define the model with default hyperparameters\n",
        "model = GradientBoostingClassifier()\n",
        "# define the grid of values to search\n",
        "grid = dict()\n",
        "grid['n_estimators'] = [ 500]\n",
        "grid['learning_rate'] = [ 0.001, 0.01, 0.1]\n",
        "grid['subsample'] = [0.1]\n",
        "grid['max_depth'] = [3, 7, 9]\n",
        "# define the evaluation procedure\n",
        "cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "# define the grid search procedure\n",
        "grid_search = GridSearchCV(estimator=model, param_grid=grid, n_jobs=-1, cv=cv, scoring='accuracy')\n",
        "# execute the grid search\n",
        "grid_result = grid_search.fit(X, y)\n",
        "# summarize the best score and configuration\n",
        "print(\"Best: %f using %s\" % (grid_result.best_score_, grid_result.best_params_))\n",
        "# summarize all scores that were evaluated\n",
        "means = grid_result.cv_results_['mean_test_score']\n",
        "stds = grid_result.cv_results_['std_test_score']\n",
        "params = grid_result.cv_results_['params']\n",
        "for mean, stdev, param in zip(means, stds, params):\n",
        "    print(\"%f (%f) with: %r\" % (mean, stdev, param))"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#Feature Importance\n",
        "---\n",
        "\n",
        "https://scikit-learn.org/stable/modules/permutation_importance.html#permutation-importance\n",
        "https://scikit-learn.org/stable/auto_examples/ensemble/plot_gradient_boosting_regression.html\n"
      ],
      "metadata": {
        "id": "M2ghpAZrs9za"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "# Best: 0.969877 using {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
        "xgbc = GradientBoostingClassifier( learning_rate=0.01, subsample=0.1, n_estimators=500, max_depth= 9)\n",
        "\n",
        "# fit the predictor and target\n",
        "xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "gbm_predict = xgbc.predict(Xt_test)# check performance"
      ],
      "metadata": {
        "id": "UMGW1OYYt0Ea"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,gbm_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,gbm_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,gbm_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,gbm_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,gbm_predict)\n",
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, gbm_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, gbm_predict))\n",
        "print('F1 score:',f1_score(Yt_test, gbm_predict))\n",
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, gbm_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, gbm_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, gbm_predict)\n",
        "print(matrix)\n",
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(xgbc,Xt_train, Yt_train, cv=10)\n",
        "\n",
        "print(\"%0.2f accuracy with a standard deviation of %0.2f\" % (scores.mean(), scores.std()))\n",
        "print(scores.mean())\n",
        "print(scores.std())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "vHkN3FI5RBq3",
        "outputId": "9d9f80f7-cad9-482f-e5b8-513e53ccb0d7"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.967660\n",
            "Recall 0.717277\n",
            "precision 0.931973\n",
            "F1 score: 0.810651\n",
            "ROCAUC score: 0.8558423228738419\n",
            "Accuracy score: 0.9676604345629105\n",
            "F1 score: 0.8106508875739645\n",
            "Cohens kappa: 0.793298\n",
            "ROC AUC: 0.855842\n",
            "[[1778   10]\n",
            " [  54  137]]\n",
            "0.97 accuracy with a standard deviation of 0.00\n",
            "0.9697924248809204\n",
            "0.003070413774559095\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Save Model Using joblib\n",
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "%cd /content/\n",
        "# save the model to disk\n",
        "filename = 'sexualsGBM_HPTFInal_UMACCS_model.pkl'\n",
        "joblib.dump(xgbc, filename)\n",
        " \n",
        "# some time later...\n",
        " \n",
        "# load the model from disk\n",
        "loaded_model = joblib.load(filename)\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "4eNM4vxqRZOc",
        "outputId": "0ef27303-9315-40ae-c6b5-b791b06097ea"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content\n",
            "0.9676604345629105\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "342JsK1QSDqc"
      },
      "outputs": [],
      "source": [
        "!cp 'sexualsGBM_HPTFInal_UMACCS_model.pkl' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "Pwfm3p4cSDfJ"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "cc3bb993-7090-4b72-ca48-4408eba3d1c6",
        "id": "BvxIzumg6XTw"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content\n",
            "0.9696816574027286\n"
          ]
        }
      ],
      "source": [
        "# Save Model Using joblib\n",
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "%cd /content/\n",
        "# save the model to disk\n",
        "filename = 'sexualsXGBoostHPTFInal_UMACCS_model.sav'\n",
        "joblib.dump(xgbc, filename)\n",
        " \n",
        "# some time later...\n",
        " \n",
        "# load the model from disk\n",
        "loaded_model = joblib.load(filename)\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "NzWrzJOx6XTy"
      },
      "outputs": [],
      "source": [
        "!cp 'sexualsXGBoostHPTFInal_UMACCS_model.sav' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "1e6b7e39-62d4-4829-8198-58b434c7e13d",
        "id": "IAbAk-ol6XTz"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/drive/MyDrive/PhD/XGBoost_MACCS\n",
            "sexualsXGBoostHPTFInal_UMACCS_model.sav  sxl_UnderMACCS_XGB_HPT_FeatureImp.csv\n",
            "sexualsXGBoost_UMACCS_model.sav\n"
          ]
        }
      ],
      "source": [
        "###Import model\n",
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/XGBoost_MACCS\n",
        "!ls '/content/drive/MyDrive/PhD/XGBoost_MACCS'"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "f71395e3-75bc-486d-f5c1-be3ad748a8cc",
        "id": "ZYhZB_sr6XTz"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.9696816574027286\n"
          ]
        }
      ],
      "source": [
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "# load the model from disk\n",
        "loaded_model = joblib.load('/content/drive/MyDrive/PhD/XGBoost_MACCS/sexualsXGBoostHPTFInal_UMACCS_model.sav')\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "iDuz0h4axxU8"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(xgbc,Xt_train, Yt_train, cv=10)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "c9acb268-8235-452e-de09-af7c836984e1",
        "id": "_xhXMAibxxVV"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.97 accuracy with a standard deviation of 0.00\n",
            "0.969035008747398\n",
            "0.004699823778063684\n"
          ]
        }
      ],
      "source": [
        "print(\"%0.2f accuracy with a standard deviation of %0.2f\" % (scores.mean(), scores.std()))\n",
        "print(scores.mean())\n",
        "print(scores.std())"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "ee7b67f2-3d76-4102-97dc-58ba5fc5b957",
        "id": "snKWC0MRxxVW"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.969682\n",
            "Recall 0.712042\n",
            "precision 0.964539\n",
            "F1 score: 0.819277\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[1783,    5],\n",
              "       [  55,  136]])"
            ]
          },
          "metadata": {},
          "execution_count": 23
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgbc_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgbc_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgbc_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgbc_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgbc_predict)\n",
        "cm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "08d7d6ca-84b3-42ef-9caa-9b4e9e504176",
        "id": "T9KWsOXIxxVX"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "ROCAUC score: 0.854622732117549\n",
            "Accuracy score: 0.9696816574027286\n",
            "F1 score: 0.8192771084337349\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgbc_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgbc_predict))\n",
        "print('F1 score:',f1_score(Yt_test,xgbc_predict))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "bc1e9c8d-062d-4462-affa-0490d791937e",
        "id": "d-GlDRNOxxVY"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cohens kappa: 0.803139\n",
            "ROC AUC: 0.854623\n",
            "[[1783    5]\n",
            " [  55  136]]\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgbc_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgbc_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgbc_predict)\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "d59f854f-364a-4acd-997b-8b07de8fa5e2",
        "id": "ipykFal2xxVY"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Test Set: 1979\n",
            "0    1788\n",
            "1     191\n",
            "Name: Target, dtype: int64\n",
            "[[1783    5]\n",
            " [  55  136]]\n"
          ]
        }
      ],
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import matplotlib.pyplot as plt\n",
        "plt.rcParams[\"figure.figsize\"] = (35,10)"
      ],
      "metadata": {
        "id": "BTew6r1-ywv5"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# feature importance\n",
        "import matplotlib.pyplot as pyplot\n",
        "print(xgbc.feature_importances_)\n",
        "# plot\n",
        "pyplot.bar(range(len(xgbc.feature_importances_)), xgbc.feature_importances_)\n",
        "plt.xticks([x for x in range(len(xgbc.feature_importances_))], rotation=90)\n",
        "pyplot.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "Mm2xmEwV0YDM",
        "outputId": "9d1bc18f-f353-4af6-8266-e6ad4ca7f18c"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00\n",
            " 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00\n",
            " 1.60067016e-03 0.00000000e+00 0.00000000e+00 3.85411192e-03\n",
            " 0.00000000e+00 6.56003248e-07 0.00000000e+00 0.00000000e+00\n",
            " 0.00000000e+00 1.16449384e-03 0.00000000e+00 4.35466444e-03\n",
            " 0.00000000e+00 3.80332941e-05 1.40204549e-03 2.47815232e-03\n",
            " 9.17889844e-04 1.14510255e-02 1.02527525e-03 2.80960176e-03\n",
            " 1.27872590e-03 0.00000000e+00 0.00000000e+00 0.00000000e+00\n",
            " 5.26862507e-04 6.74367060e-04 1.09410521e-03 0.00000000e+00\n",
            " 6.68438278e-03 2.96121904e-03 8.42071328e-03 1.18078733e-04\n",
            " 5.34619865e-05 6.07827163e-03 7.48060805e-03 4.76812691e-03\n",
            " 0.00000000e+00 2.62694491e-03 5.43326919e-03 7.57967848e-03\n",
            " 1.59729755e-05 6.85055886e-04 2.44441548e-03 3.03395276e-04\n",
            " 4.60532819e-03 1.42197632e-02 7.52449172e-03 1.86800751e-04\n",
            " 2.82460450e-03 6.27484646e-03 3.48738068e-04 3.32711549e-03\n",
            " 4.19012990e-04 1.17313820e-04 1.51820213e-02 3.98571578e-03\n",
            " 3.70205221e-03 8.37169855e-03 5.66371466e-03 8.00179626e-04\n",
            " 3.03205665e-03 2.31507258e-03 1.73609263e-04 1.62762188e-03\n",
            " 6.22661165e-03 1.07419676e-03 6.33419721e-03 8.12289994e-03\n",
            " 1.94460326e-03 8.49961495e-03 6.40658610e-03 7.77632792e-03\n",
            " 9.23594574e-03 3.76233603e-03 7.65942340e-03 5.36306213e-03\n",
            " 9.17762308e-03 5.72605003e-03 5.25414315e-03 4.16581630e-03\n",
            " 3.07475506e-03 6.88410316e-03 8.82144580e-03 7.42591914e-03\n",
            " 4.58249281e-03 7.42240658e-03 3.87384783e-03 8.57437571e-03\n",
            " 9.23632191e-03 8.22664765e-03 7.23358466e-03 8.02793248e-03\n",
            " 6.15362373e-03 1.67364767e-02 6.73566486e-04 1.78697587e-02\n",
            " 8.30962218e-03 9.47825535e-03 6.90943921e-03 2.80909688e-03\n",
            " 6.16383626e-03 5.99183380e-03 5.28907737e-03 1.20887163e-02\n",
            " 5.82516021e-03 7.56543245e-03 9.21745757e-03 6.56455118e-03\n",
            " 6.47356356e-03 2.13734120e-02 2.34484973e-03 2.42436212e-02\n",
            " 8.04808447e-03 1.75587024e-03 4.13322159e-03 3.41876972e-03\n",
            " 8.97754091e-03 9.89243506e-03 7.39957780e-03 2.53088493e-03\n",
            " 7.27502345e-03 5.13615734e-03 3.27240851e-03 1.79128288e-02\n",
            " 1.08335840e-02 7.95349168e-03 5.00907375e-03 8.00947992e-03\n",
            " 5.59818833e-03 5.48244221e-03 5.25115857e-03 5.46064861e-03\n",
            " 6.48485470e-03 6.81573427e-03 3.15198295e-03 2.70461201e-03\n",
            " 8.57915914e-03 2.96679922e-02 4.51681293e-03 2.91953499e-03\n",
            " 1.08060333e-02 9.34976084e-03 7.58992515e-03 9.41005513e-03\n",
            " 7.95963643e-03 1.74803739e-02 8.42529860e-03 6.64818174e-03\n",
            " 9.54627478e-03 3.48066275e-03 5.88007372e-03 9.93916825e-03\n",
            " 8.63246475e-03 2.76328141e-03 3.17761066e-05 2.72799935e-04\n",
            " 1.29536401e-02 1.56181413e-12 1.33418386e-01]\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 2520x720 with 1 Axes>"
            ],
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAB8wAAAJLCAYAAACCM2w4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nOzdX4jl91nH8c+TXRM1pX8Mg2gSSaSRsqVS7HSrYKMYqRuErMJGk1ZMpBCl5EpFV4S0pjetaONFc9FAI7GhpCEgLGQ1FnpRkFp2EjRlG6NjjMlGodskVmIJ6TaPF3sC4zDJnN2Z7YY8rxcs+/t9v9/fmedcvznnVHcHAAAAAAAAAKa54HwPAAAAAAAAAADng2AOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASEsF86o6UFWPV9V6VR3eYv/qqnqkqk5V1aEt9t9cVSeq6tO7MTQAAAAAAAAA7NS2wbyq9iS5M8m1SfYlubGq9m069lSSm5N8/lVe5uNJvnz2YwIAAAAAAADA7lrmE+b7k6x39xPd/VKS+5Ic3Higu5/s7keTvLz54ap6T5IfTvJ3uzAvAAAAAAAAAOyKvUucuTTJ0xvuTyR53zIvXlUXJPnzJL+R5Bdf49wtSW5Jkosvvvg973jHO5Z5eQAAAAAAAAB4TQ8//PA3u3tlq71lgvlOfCTJ0e4+UVWveqi770pyV5Ksrq722traOR4LAAAAAAAAgAmq6j9ebW+ZYP5Mkss33F+2WFvGzyR5f1V9JMmbklxYVS909+ElnwcAAAAAAACAc2KZYH4syVVVdWVOh/IbknxwmRfv7g+9cl1VNydZFcsBAAAAAAAAeD24YLsD3X0qya1JHkryWJL7u/t4Vd1eVdclSVW9t6pOJLk+yWeq6vi5HBoAAAAAAAAAdqq6+3zP8P/4DXMAAAAAAAAAdktVPdzdq1vtbfsJcwAAAAAAAAB4IxLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkfae7wEAAAAAAAAA3qiuOPzgtmee/MQvfw8mYSs+YQ4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADDSUsG8qg5U1eNVtV5Vh7fYv7qqHqmqU1V1aMP6u6vqK1V1vKoerapf383hAQAAAAAAAOBsbRvMq2pPkjuTXJtkX5Ibq2rfpmNPJbk5yec3rX87yW929zuTHEjyF1X11p0ODQAAAAAAAAA7tXeJM/uTrHf3E0lSVfclOZjk668c6O4nF3svb3ywu/9lw/V/VtU3kqwk+e8dTw4AAAAAAAAAO7DMV7JfmuTpDfcnFmtnpKr2J7kwyb9tsXdLVa1V1drJkyfP9KUBAAAAAAAA4Iwt9RvmO1VVP5Lkc0l+q7tf3rzf3Xd192p3r66srHwvRgIAAAAAAABguGWC+TNJLt9wf9libSlV9eYkDyb54+7+hzMbDwAAAAAAAADOjWWC+bEkV1XVlVV1YZIbkhxZ5sUX5/86yV919wNnPyYAAAAAAAAA7K5tg3l3n0pya5KHkjyW5P7uPl5Vt1fVdUlSVe+tqhNJrk/ymao6vnj815JcneTmqvrHxb93n5N3AgAAAAAAAABnYO8yh7r7aJKjm9Zu23B9LKe/qn3zc/cmuXeHMwIAAAAAAADArlvmK9kBAAAAAAAA4A1HMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEZaKphX1YGqeryq1qvq8Bb7V1fVI1V1qqoObdq7qar+dfHvpt0aHAAAAAAAAAB2YttgXlV7ktyZ5Nok+5LcWFX7Nh17KsnNST6/6dkfSvLRJO9Lsj/JR6vqbTsfGwAAAAAAAAB2ZplPmO9Pst7dT3T3S0nuS3Jw44HufrK7H03y8qZnfynJF7v7ue5+PskXkxzYhbkBAAAAAAAAYEeWCeaXJnl6w/2JxdoydvIsAAAAAAAAAJwzS/2G+blWVbdU1VpVrZ08efJ8jwMAAAAAAADAAMsE82eSXL7h/rLF2jKWera77+ru1e5eXVlZWfKlAQAAAAAAAODsLRPMjyW5qqqurKoLk9yQ5MiSr/9Qkg9U1duq6m1JPrBYAwAAAAAAAIDzattg3t2nktya06H7sST3d/fxqrq9qq5Lkqp6b1WdSHJ9ks9U1fHFs88l+XhOR/djSW5frAEAAAAAAADAebV3mUPdfTTJ0U1rt224PpbTX7e+1bN3J7l7BzMCAAAAAAAAwK5b5ivZAQAAAAAAAOANRzAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGGmpYF5VB6rq8apar6rDW+xfVFVfWOx/taquWKx/X1XdU1Vfq6rHquqPdnd8AAAAAAAAADg72wbzqtqT5M4k1ybZl+TGqtq36diHkzzf3W9PckeSTy7Wr09yUXe/K8l7kvz2KzEdAAAAAAAAAM6nZT5hvj/Jenc/0d0vJbkvycFNZw4muWdx/UCSa6qqknSSi6tqb5IfSPJSkv/ZlckBAAAAAAAAYAeWCeaXJnl6w/2JxdqWZ7r7VJJvJbkkp+P5/yb5ryRPJfmz7n5u8x+oqluqaq2q1k6ePHnGbwIAAAAAAAAAztRSv2G+A/uTfDfJjya5MsnvVdWPbz7U3Xd192p3r66srJzjkQAAAAAAAABguWD+TJLLN9xftljb8szi69ffkuTZJB9M8rfd/Z3u/kaSv0+yutOhAQAAAAAAAGCnlgnmx5JcVVVXVtWFSW5IcmTTmSNJblpcH0rype7unP4a9l9Ikqq6OMlPJ/nn3RgcAAAAAAAAAHZi22C++E3yW5M8lOSxJPd39/Gqur2qrlsc+2ySS6pqPcnvJjm8WL8zyZuq6nhOh/e/7O5Hd/tNAAAAAAAAAMCZ2rvMoe4+muToprXbNly/mOT6LZ57Yat1AAAAAAAAADjflvlKdgAAAAAAAAB4wxHMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEZaKphX1YGqeryq1qvq8Bb7F1XVFxb7X62qKzbs/WRVfaWqjlfV16rq+3dvfAAAAAAAAAA4O9sG86rak+TOJNcm2Zfkxqrat+nYh5M8391vT3JHkk8unt2b5N4kv9Pd70zy80m+s2vTAwAAAAAAAMBZWuYT5vuTrHf3E939UpL7khzcdOZgknsW1w8kuaaqKskHkjza3f+UJN39bHd/d3dGBwAAAAAAAICzt0wwvzTJ0xvuTyzWtjzT3aeSfCvJJUl+IklX1UNV9UhV/cFWf6CqbqmqtapaO3ny5Jm+BwAAAAAAAAA4Y0v9hvkO7E3ys0k+tPj/V6vqms2Huvuu7l7t7tWVlZVzPBIAAAAAAAAALBfMn0ly+Yb7yxZrW55Z/G75W5I8m9OfRv9yd3+zu7+d5GiSn9rp0AAAAAAAAACwU8sE82NJrqqqK6vqwiQ3JDmy6cyRJDctrg8l+VJ3d5KHkryrqn5wEdJ/LsnXd2d0AAAAAAAAADh7e7c70N2nqurWnI7fe5Lc3d3Hq+r2JGvdfSTJZ5N8rqrWkzyX01E93f18VX0qp6N7Jzna3Q+eo/cCAAAAAAAAAEvbNpgnSXcfzemvU9+4dtuG6xeTXP8qz96b5N4dzAgAAAAAAAAAu26Zr2QHAAAAAAAAgDccwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhpqWBeVQeq6vGqWq+qw1vsX1RVX1jsf7Wqrti0/2NV9UJV/f7ujA0AAAAAAAAAO7NtMK+qPUnuTHJtkn1JbqyqfZuOfTjJ89399iR3JPnkpv1PJfmbnY8LAAAAAAAAALtjmU+Y70+y3t1PdPdLSe5LcnDTmYNJ7llcP5DkmqqqJKmqX0ny70mO787IAAAAAAAAALBzywTzS5M8veH+xGJtyzPdfSrJt5JcUlVvSvKHSf7ktf5AVd1SVWtVtXby5MllZwcAAAAAAACAs7bUb5jvwMeS3NHdL7zWoe6+q7tXu3t1ZWXlHI8EAAAAAAAAAMneJc48k+TyDfeXLda2OnOiqvYmeUuSZ5O8L8mhqvrTJG9N8nJVvdjdn97x5AAAAAAAAACwA8sE82NJrqqqK3M6jN+Q5IObzhxJclOSryQ5lORL3d1J3v/Kgar6WJIXxHIAAAAAAAAAXg+2Debdfaqqbk3yUJI9Se7u7uNVdXuSte4+kuSzST5XVetJnsvpqA4AAAAAAAAAr1vLfMI83X00ydFNa7dtuH4xyfXbvMbHzmI+AAAAAAAAADgnLjjfAwAAAAAAAADA+SCYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEh7z/cAAAAAAAAAnHtXHH7wNfef/MQvf48mAXj98AlzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAPi/9u48XpqqPPD473l5BUFke0HceVFABbcgguuA66BMwAVHxCTAaEyiiOMSwdERNS5goo4GMaMiRgwqbhFF3FGjhk12RAVZlEQN4DpREyVn/jjn5q33vNX3Vt3bdfve7t/386nPra5+7jmn6qk+3V2nqlqSJEmSJEmSZpID5pIkSZIkSZIkSZKkmeSAuSRJkiRJkiRJkiRpJjlgLkmSJEmSJEmSJEmaSQ6YS5IkSZIkSZIkSZJmkgPmkiRJkiRJkiRJkqSZ5IC5JEmSJEmSJEmSJGkmOWAuSZIkSZIkSZIkSZpJDphLkiRJkiRJkiRJkmaSA+aSJEmSJEmSJEmSpJnkgLkkSZIkSZIkSZIkaSatnXQDJEmSJEmSJEnt1h931rzPX3/CQcvUEkmSpOnkFeaSJEmSJEmSJEmSpJnkgLkkSZIkSZIkSZIkaSY5YC5JkiRJkiRJkiRJmkkOmEuSJEmSJEmSJEmSZpID5pIkSZIkSZIkSZKkmeSAuSRJkiRJkiRJkiRpJjlgLkmSJEmSJEmSJEmaSQ6YS5IkSZIkSZIkSZJmkgPmkiRJkiRJkiRJkqSZ5IC5JEmSJEmSJEmSJGkmrZ10AyRJkiRJkiRpGqw/7qx5n7/+hIOWqSWSJEnqyivMJUmSJEmSJEmSJEkzqdOAeUQcGBHfiYhrIuK4lue3iIgPlefPi4j1ZfnjIuKbEXF5+fvo8TZfkiRJkiRJkiRJkqTFWXDAPCI2A94OPAHYE3hGROxZhT0L+GlKaTfgLcCJZfnNwO+nlO4HHAGcNq6GS5IkSZIkSZIkSZK0FF2uMN8XuCaldG1K6d+BDwKHVDGHAH9b5j8CPCYiIqV0cUrpn8vyK4EtI2KLcTRckiRJkiRJkiRJkqSl6DJgfhfgB43HN5ZlrTEppd8BPwfWVTFPBS5KKf1bXUFEPCciLoyIC2+66aaubZckSZIkSZIkSZIkadE6/Yb5UkXEXuTbtP9J2/MppXemlPZJKe2z0047LUeTJEmSJEmSJEmSJEkzrsuA+T8Bd2s8vmtZ1hoTEWuBbYFbyuO7Ah8H/iil9L2lNliSJEmSJEmSJEmSpHHoMmB+AbB7ROwaEZsDhwFnVjFnAkeU+UOBL6WUUkRsB5wFHJdS+vq4Gi1JkiRJkiRJkiRJ0lItOGBefpP8aOCzwFXAGSmlKyPiNRFxcAk7BVgXEdcALwKOK8uPBnYDXhkRl5TpDmNfC0mSJEmSJEmSJEmSelrbJSil9Gng09WyVzbmfwM8reX/Xgu8doltlCRJkiRJkiRJkiRp7Lrckl2SJEmSJEmSJEmSpKnjgLkkSZIkSZIkSZIkaSZ1uiW7JEmSJEmSNG3WH3fWvM9ff8JBy9QSSWpnPyVJ0vC8wlySJEmSJEmSJEmSNJO8wlySJEmSJEmSJElaBO8EIa1+XmEuSZIkSZIkSZIkSZpJDphLkiRJkiRJkiRJkmaSt2SXJEmSJEnSirbQrU7B251KkiRJWhyvMJckSZIkSZIkSZIkzSQHzCVJkiRJkiRJkiRJM8kBc0mSJEmSJEmSJEnSTHLAXJIkSZIkSZIkSZI0kxwwlyRJkiRJkiRJkiTNpLWTboAkSZKk1WX9cWctGHP9CQctQ0skSZIkSZKkpfEKc0mSJEmSJEmSJEnSTHLAXJIkSZIkSZIkSZI0k7wluyRJklYdbwkuSZIkSZIkaRy8wlySJEmSJEmSJEmSNJMcMJckSZIkSZIkSZIkzSQHzCVJkiRJkiRJkiRJM8kBc0mSJEmSJEmSJEnSTFo76QZIkiRJkiRJkiRJ0kqw/riz5n3++hMOWqaWaGaIYfoAACAASURBVLl4hbkkSZIkSZIkSZIkaSY5YC5JkiRJkiRJkiRJmkkOmEuSJEmSJEmSJEmSZpK/YS5JkiRJkiRpLPzNT0mSJK02XmEuSZIkSZIkSZIkSZpJXmEuSdrEQlcEgFcFSJIkSZIkSZKk1c8rzCVJkiRJkiRJkiRJM8kBc0mSJEmSJEmSJEnSTPKW7JIkSZIkSZIkrWL+vJ5Wi4X2VfdTSZPgFeaSJEmSJEmSJEmSpJnkgLkkSZIkSZIkSZIkaSZ5S3ZJkiRJkiRJ0ork7ZslaWWzn9Y08ApzSZIkSZIkSZIkSdJM8gpzSZIkSZIkaUy8ykqSpKVb6P0U+r+nDlHmSuBnD2npHDCXJEmSJKmj1XIwaloPBqob869Ztlr6aUmSJK0cDphLkiRJkqSp4oCxJK1s9tOSJGklccBckiRJkiRphXNwSZIkjeLnBK0G7qdayRwwlyRJi+btDiVNgl+yZ5vvPZImwfceSZK0VH6ekFYuB8wlSZIkSYNwcFta+XydStPF17QkSVJ/DphLkiRJkmaaV3pI4+VrSpJWtiFOrLDv17Rxn5ZmiwPmkiRJq5RXj3Tjl1xJK539lCTNz35SkjQfj49IWioHzCVJ0tTzAJskSRrFq+wkaToM1fc6ECdJ0vRzwFySJEmSJEnz8iQASZIkSdPKAXNJkiRJkrQqeJWfpo37tCRNB08sk6TVzQFzSZJmgF/cJEmSJGkDvyNJklYy36ek5eWAuSRJkjQgrxzTtFkt+7QHmCRJ47Ja3vskjZefJyVpdjhgLkmSVi0PXEnS/OwnJa109lPj13WbOhAkSZIkZQ6YS5IkSZI0wxywlDQJDthLkrRy+T6tWeOAuSRJkqSp5UCgJEmStLJM+k4YfkeQJNUcMJckSVpB/OIuSZrPpN8nJl2/pMnwKjNJK539lCRpKRwwlyRJkiRJkiRpCaZ1wNaT5SRJs8ABc0mSpAYPBkiSJEmSJEnS7HDAXJIkSSuGJyxIklaqab1yUJIkqY2ffSTNEgfMJamFHwglSZIkSZIkSZKmnwPmkiRJkgbjXQOk2eQJqJI0Pfw8J0mSpp0D5tIU8GCUJEla7fw8o2njPq2uHIiSJEmSpMlywFySJEmSJEmStCSeLCZJK5v9tDSaA+aSJEnSKuOXXEmSJGn18u4is838S9LK44C5JEnaiANxkjQ/+0lpvDxoLEmStLr5eU7SaueAuSRp2fjhWbPKwbXpY04lSdJy8rOHJM0e+37NMo8ja7k5YC5Jq5wfniVNgn2PJEmSpNXK7zOSJKnJAXNJkiRJGohnxUuSpDYO2EqSJK0cDphLkiRJkibKQQNJkiRJkjQpDphLY+ABPkmSJC0Xr1qXJElL5bEsSZKkDRwwl6QVyC+ukiRJkiRJkiRJw3PAXNKq5+Dy9Jn1nM76+kuSJEmSJEmStFw6DZhHxIHAW4HNgHenlE6ont8CeB/wIOAW4OkppevLcy8DngXcChyTUvrs2FovSepliFu4eltYSZJWP0/WkiRJkiRJs2rBAfOI2Ax4O/A44Ebggog4M6X0rUbYs4CfppR2i4jDgBOBp0fEnsBhwF7AnYEvRMQeKaVbx70ikiStZA5EaLXwJBjNKvtpSZoefp6RJEmS1EeXK8z3Ba5JKV0LEBEfBA4BmgPmhwCvKvMfAU6KiCjLP5hS+jfguoi4ppT3j+NpviRJk+XBOGlhDkR2551AJEmSJEmSpOXVZcD8LsAPGo9vBPYbFZNS+l1E/BxYV5afW/3vXRbdWkmStCr1GTB1cFWTNOuDy7O+/pNk3ydJkiRJ0nD83q35REpp/oCIQ4EDU0rPLo//ENgvpXR0I+aKEnNjefw98qD6q4BzU0rvL8tPAc5OKX2kquM5wHPKw3sB31n6qqmHHYGbJxhr/dNX/zSuk/XPdv3TuE7W7z5l/dNV/zSuk/XPdv3TuE7W7z5l/dNV/zSuk/W7T1m/9a/0Mq1/tuufxnWyfveprmVqPHZJKe3U+kxKad4JeCjw2cbjlwEvq2I+Czy0zK8lJzjq2Gac08qZgAsnGWv901f/NK6T9c92/dO4TtbvPmX901X/NK6T9c92/dO4TtbvPmX901X/NK6T9btPWb/1r/QyrX+265/GdbJ+96muZToNP61hYRcAu0fErhGxOXAYcGYVcyZwRJk/FPhSytk+EzgsIraIiF2B3YHzO9QpSZIkSZIkSZIkSdKgFvwN85R/k/xo8tXhmwHvSSldGRGvIZ/9cCZwCnBaRFwD/IQ8qE6JOwP4FvA74HkppVsHWhdJkiRJkiRJkiRJkjpbcMAcIKX0aeDT1bJXNuZ/AzxtxP++DnjdEtqo4b1zwrHWP331T+M6Wf9s1z+N62T97lPWP131T+M6Wf9s1z+N62T97lPWP131T+M6Wb/7lPVb/0ov0/pnu/5pXCfrd5/SChHlPvmSJEmSJEmSJEmSJM2ULr9hLkmSJEmSJEmSJEnS1HHAXJIkSZIkSZIkSZI0kxwwlyRJkiRJkiRJkiTNJAfMZ1BE3Dsijo2It5Xp2Ii4z5jKfUxEbF0tP7B6vG9EPLjM7xkRL4qIJ3Yo/3092vKIUu7jq+X7RcQ2ZX7LiHh1RHwyIk6MiG2r2GMi4m4d6to8Iv4oIh5bHh8eESdFxPMi4jYt8feIiJdExFsj4s0R8adzbZKWW0TcYYAy1427TEkaJ/u+1WGIPJVyzdWY+ZqSxsvXlCRJkiQtLwfMZ0xEHAt8EAjg/DIF8IGIOK5HOUdVj48BPgE8H7giIg5pPP36RtzxwNuAd0TEG4CTgNsBx0XEyxtxZ1bTJ4GnzD1uac/5jfk/LuXeHji+Wq/3AL8q828FtgVOLMtOrYr9C+C8iPiHiHhuROw0YnOcChwEvCAiTgOeBpwHPBh4d8t2+hvgtuX5LYC7AedGxAEjyl+VZuUgT0RsGxEnRMS3I+InEXFLRFxVlm3Xo5yzG/PbRMQbIuK0iDi8iju5enzHiHhHRLw9ItZFxKsi4vKIOCMi7lTF7lBN64DzI2L7iNihEXdgY37biDglIi6LiNMjYueqzBMiYscyv09EXEt+3dwQEftXsRdFxCsi4p4LbIt9IuKciHh/RNwtIj4fET+PiAsi4veq2K0j4jURcWWJuSkizo2II1vKXRsRfxIRnynrc1lEnF1OWtnk5JYRbXtn9XizUuZfRMTDq+de0ZjfKiJeGhF/HhG3jYgjS3/2xqhOMhpR73dHLL9/Y/42ZfueGRGvj4itGs8d3cjTbhHx1Yj4WUScFxH3q8r8WET8Qcd23SMi3hMRry25eFdEXBERH46I9Y24NRHxPyLirIi4tOwLH2zr9yaZp/J40blaap7K851yNek8lfgl93/R6PvK4079XwzQ95XYTv1fDND3NcpasP+Lfn3fqnifGiJP5flOuRoiTyW2U66GyFN57Gtq/K8p36dWwfvUEK+prq+n8tjP6B1fU43/2Tki9i7TzqPi5vn/Bfe1HmXtsHDUf8YePM4yy+vqqRGxZ8tzffbdtY35rUv+RrYhInaKiN+LiPuP2paR7RcRTynTfhERXdu0VKUPWFPmNy/7Stft+txhW7d4EXH3udxGxPqIODQi7rvEMldlrmYtT6Wsqe77upY7rr6vxHfu/7r0fY3YRedqnHkq5XXt+8aapxLXmqsh81RifJ+agAH7vlWZq5WaJ41RSslphibgu8BtWpZvDlzdo5zvV48vB7Yu8+uBC4EXlMcXV3GbAVsBvwC2Kcu3BC5rxF0EvB84ANi//P1hmd+/pT3NOi4AdirztwMubzx3VbOOqoxL6jLJJ5U8HjgFuAn4DHAEcPtG3GXl71rgx8Bm5XE016m5/mV+K+DLZf7uzXUoy7YFTgC+DfwEuAW4qizbrkeuzm7MbwO8ATgNOLyKO7l6fEfgHcDbgXXAq0r7zwDuVMXuUE3rgOuB7YEdGnEHVut3CnAZcDqwc1XmCcCOZX4f4FrgGuCGeh8o+8srgHsusC32Ac4p+9bdgM8DPy/7zO9VsVsDrwGuLDE3AecCR1ZxnwWOBe5Ybbtjgc9VsXuPmB4E/LAR99Gy/k8CziyPtxix336GfKLKcWVbHlvW7fnAJ6rY/wCuq6bflr/Xtr02yCd9vBbYBXgh8Pf1Pt2YPwd4cJnfA7iwir0O+Cvg++STdV4I3LklT+cDTwCeAfwAOLQsfwzwj1XsJ4AjgbsCLwL+N7A78LfA66vYD5D36YeU+LuW+XcAH5pnf27u1zdWZb6bvP/+T+CbwJtHbMczgDcBJwNfJJ/U80jgL4HTqjJ/Se4ff1HmfwncOre83vcb828C3kvuJ98CvK/x3JWN+bOAJ5f5A4CvV2X+E/ARcr9zBvBkYPMRr6mvAn9G3v+uAF5M3v+eBXypEXcquQ95BPB/yK+txwFfAJ6/UvLUJ1dD5KlPriadpz79Hx37vj79HwP0fX36Pwbo+/r0f/Tr+1bF+9QQeeqTqyHy1CdXQ+TJ19RgrynfpzbMr9j3KVZJ39fnNcX0fkZ/IPl71lUll18gfwc+F9i7bZ8ZsR99vzF/v/L/PwDeCWzfXI/q/x5e6r4S2I/8HfF75X8fWsU+pZqeCvxo7nEj7hWN+T3Jx2GuI39H3q8q8xw2fO/9wxL7bvJ373q//l3ZPs9inmMCZdvfUsp6Avm79BfLOj2jit2zlHkN8O/kk/+vI/cD2zbiHl9izi7tezd5P78GeHyPPN17xPK241Q7NuafRD7e8kPgkNLOLwI3Ar9f/d+LqunFwM1zjxdo39bk1/921fLNgWg8flQp9wktZdy/x/Y4rmzvbwPPLn9PKfvjJm0lH9N4MnDwPNtysFwtlKc+uRoiT31yNWSeuuSKAfq+8rhT/8cAfV+J7dT/MUDfV2KPpEP/R8e+b1y5Wmye+uRqiDz1ydUQeeqTK2bgfYox9H3luU79HwP0fePK1WLz1CdXi83TOHPltPzTxBvgtMwJzx3bLi3LdwG+Uy27bMR0OfBvVeyV1eOtS0f3ZhoD0Ww8sF0PEDfj1pC/qH8eeGBZdu0863UpeXB2HZseAGjW+WHgqDJ/KrBPmd8DuKD6v/qgx21KZ/8B4KbG8itKR7c9+QDUDmX5bWkM0Jdll7PhoMr2bHyg9ooq1oM8G+bPYYUe5KF63VRl1K+pW4EvlfWpp1+3vRbK45cDXyfv33Wemvt3/QG8LufFJa/3a267lnZfNE8Z9eOrgLVl/txROWwp95HkA70/Kuv/nI7rVPcbl1aPLyh/1wDfrp777jy5+m5j/lbyh/Xm/jz3+N+r/2ue6LOW/EXnY+S7RzTX45LyN8o6R+NxfWLN24D30TiJpC1PLdvqEsoHw7rc5r7Ipn1dXf/F5e825C9DnyafMHIq1QfXrrlqqePc8ncLNu0nJ5anPrkaIk99cjXpPNVtne85OvZ9ze3feNza/y2wTovq+8ryTv0fA/R9PXPVp+9bFe9TQ+SpT66GyFOfXA2Rpz656pqnoXLVNU9D5aprnsoy36eq7TRiPSb9eWJV9H19XlNM72f0S6gOzpflD2kppz5w2TyA+ZNG3NeAA4HtgJeQD+zec0RbzycPXDyUfBD0EWX53mx6YulvgU+R71x3apl+Wf6+Z8Q2PYtyABTYF/hGVeYVze0ErCvzW9F+Av5/A/6OPNDwCeAwYMuWuB2BXcknzcyt+84tZZ4L3KvRvr8t838MfKTap9a35GlXWj4nzvP6q/edR5EPUN8MfK5ZR7UdLyYfD5lbp7k278Kmxwd+CXwIeCVwfJl+OjdfxZ7cmH8E+ZjCOeTjBU9s7tOUAS3gz4FvkE/a/zzwhqrMW4GryXct3HOB7XEl+QKSdaXdzYs/mvvG/uQLU75Q1uVT5P7ny8DdWl7/Y81V1zz1ydUQeeqTqyHy1CdXDND3ldhO/R8D9H0tr9uR/R8D9H2N2AX7Pzr2fX1yNUSe+uRqiDz1ydUQeeqTK6bwfYoB+r7yfKf+jwH6vnHlarF56pOrrnkaMldOyz9NvAFOy5zw/GY8dwbPO8s0dwbPgVXsj8ln0e1STeuBf65iv0QZ2G4sW0s+SHNrY9l5wFZlfk1j+bZ151WW35U8yH1S3RFWcdez4QDUtZQroMkD95dU9byXfCbeeeQPE9cCXwEeUJV58Tz1bdWYf2Ep4wbgGPIZSe8iv/kfX/3fC8iDz+8in7wwN3i/E/DVKtaDPKvgIA/5TfilbHwwcmfyCQZfqMq4Ath9RE5/UK37mur5I8kfVG4Y1U7gtfNtp+o19WbyzxZsciIK+QPG3If6a9n4rLf6g+vzyzZ4NPmKn7eSPyS9mk2vnG57jW9G7pdObSz7R/LZhk8jv66eVJbvz6YfMr/Bhi8LBwOfned1cm4ps9n3rAGeDpzXWHY1cPeF8lQef7sl5njy6+rqxrJmP1R/Ubm0pYwHkV/Tx5Q2tp4wVPIzd+ZwfaC4uW+8jtz33QP4X+Qr2HYBjgI+1SFP64A/pXGVV1n+TfJJLPuSP5TOnYS0Gxt/cfomG74A7U2jvwO+tVLy1DdXPfP05IXy1CdXi8zTg8eVp7KsU/9Hx76vPO7U/zF/33dZSz0L9n0lrlP/xwB9X1neqf+jX9+3kt+n6veUseapT65o+dy31Dz1ydUQeZri19TYc9U1T+XxtL5PLfh5ojwe8n2q/jyxO4v/PLFq+r7qNfUWpu8z+iHM/5oaeac74Jrq8W/IB3ePb5l+Ns9++yjya/Ih9fqy8XfEev+vYx9M/r7/Z41l17W0u/WEpFGPgbuU+XOA2zZyUF+Y0Cx3S+C/k0+uuQU4vfFcs5+oj93U+0q9rZp1NO/QdzXl+3kVv3lLnt42YvprNr3DxQXAXmX+0Lk8teSmOV8fpK/zdHfy6+lENhx/GtX/Ndf3HMrVouQ+rvUCB/KAwJZlfm3LNr0YuC+5v7yGfGD8ONoHB+buWLgZ8C9s/N5yRVXm3EDFrsDHy/zj2PSCirHnqmue+uRqiDz1ydUQeeqTKwbo+0a8plv7Pwbo+1pyNd++Mfa+rzzfqf9r2U6tfV+fXA2Rpz65GiJPfXI1RJ765IopfJ9igL6vkdMF+z8G6Pv65GqIPPXJVdc8DZkrp+WfJt4ApwkkPR8seQj5gMhTy/xmLXGnUL7ktjxXv9HdlcaV0NVzD2/MbzEiZkcag60tzx9Edeu2juu6FbBry/JtgAeQDyLtPOJ/9+hRz50pVzSTzw48FNh3ROxe5fnWW4c04lbyQR4HYjfMb09+4/w2+Syzn5TtfCKN29GX2EMpZ621tPdJjfk3Ao9tiTmQTQ+avobycwjV8t2ozoqtnj+YfMD3Ry3P1R/s5z7w3JHqtpxl+QHkM+4uJp8o8mngOVS3wQE+2PH19ADyHRbOBu5dcv+zsp8+rCX2/LLtv8aGswJ3Ao6pYteXdv4L+bZP3y3zH6LRTwDPozqBprlfVo/fT3WyUVn+bOC3jcfvHpGnewJfG1HXGvIB7n+g+gLRiDm1mnZu5OqLVeyR5BOFbiafJfkt4PVseruxr7bVNaL+xwDfKfv8I8h3rbi6bNdDGnGPJp9deTX5xKb9Gnl644g83VRyNFfe4HlaTK465um9XfNUlh+1UK7GmKdm3zOXp2tKnua+XGySp7K8U/9Hx76vPO7U/zFA31ee79z/Mea+r8Q+kE37v5+S+7/m56m679ujkau671t171PjzFPXXPXMU9v71CZ5KrH375KrIfK0Cl9Tj1ooT2PK1SafKRp5+tl8eSrL1jOhzxNl2RDvU6ey8dVIC71PHcnyvU8t9vPE3GvqKvLracX3fQu9ptj4tfRKuvd9F7HhNfUnjPcz+qi+r8/71NvIV7c9HXhYmZ5elp1UxX4DeNCI9jW/917Kpp9x71/2nVuq5c3vvXUfekVLPWvIJ8KfQz7Jo+1778/Id3T7JPkz7Vajyix5urLsMyeVdTyefJXRS6rY1pP6yRcGHNF4fCb5p9hOIp808ybyLX2Pp/G9tsR+jHw3tYeXuPeU5bdh4++9LyP3z8cCh5fp2LLsZVWZvyT330e0TDeP2v7l8V7k/uBJbHrl3poyv29j+WZteSrPHUI+8ejQtjyVmGYd35znuW8A9y3zn2HDlWG3bclpPTCyL/k4yY1seuXme8k/yfEJ8t0MTwOeST4ed0Yj7rJqnZttqwcXx56rrnlaTK7Gmac+uRoiT31yxQB931yu6ND/MUDfV+I69X8M0PeVZZ36Pzr2fX1yNUSe+uZq3Hnqk6sh8tQnV0zh+xQD9H0j/re1/2OAvm+eXB1X52qIPC0mVwvlachcOS3/NPEGODk5tU9sfOC0PsizfRW7Gg/yHM/iD3CvreKGGIjtdIC7LLs38Nh6e9F+4PPe5IOC88bOE9f22zOdyqxjyWd83rdn/Ytep57rf58eZd6nx/bfj/xBcB35w/ZLqG6NU+L2ZcPPAOxJPtFjk7g+sSPiDqJx4siI2EeSD4qOqn+/RdS/F/nElSWtU0v9e82zTR/atczG/6wr0/vni2vEb9KPjDO2LVeNmDtRfbEdY/2nDVDmp6hOoJpbRzb+Ha4+ZT6y7Ffz/uYUeTDkRQvF9YntWeYjybe7Gmf9ndZ9kW1d0jYtr9Fty/xW5Pf3T5E/T9QHafYDtinzW5bYT9axVZkj40aU+ep5ytym0c43km/nNqrMep261D9y/buu+zzrP982bbZ11PofQ3WrunnyPfbYpZRJ4/PEJOqfwPpvTj5I8zjye9QzyXc3eh4bn4SxBfBHlM/e5ANBJ9VxHWI37xF7m6qdzbg/JJ+w+twR9R/Rsa11uc8E3r7E9d+8qn/UNt2cfFLZ0xYqszx/T/JtDt9GvnL7Tymv85bYe5A/w7yVfMCwNbZr3BJj/y/55OG2+ufWqWuZ417/uv4/m6fM5vZfqK1PAP6G3D9+ssy3fZ68F+U7ZMtzzRPND6ec+FfF3B14V7XsYBoDBVX7XzpPX3AX4AzaD3DvX023n2sj8LyW+G3LtnwL+aqpY2n/zeOXjGpPFbcN+WD0ceTvfYeS36dOptyNrxG7Hfk991PkK81u32jTQ6rY+5Qy/7pMx9FyK1fy4MfDRrTtuurxhVQXX5BPxr8E+GVj2YMpVzVWseuBP5hnW9wO+EtGnMQD/IoNPz34SzYctF7DxoN79ycPcL2vTN8jn2B0IXB4VeaoQaMA9q+WrSX/ZNxhZf5h5H7tpcDtGnHvIQ9QPJN8jOTNZflWtN+lZM9x5qprnhabq3HlqU+uhshT31wBT2SMfV953Kn/Y/F9350Z0feV5+v+b+u5dlL1f4y57yuxdf/3VFr6P3r0fWX5gu9TJU87jmjXovK02FyNM09dczWmPL0d36cG7ftKbKf+j4H6vq65GiJPi83VfHkaMldOyz/N/d6ZpFUkIo5KKZ06zthxlhkRW5Jvl3jFJOpfTOxiy4yIY8gH6a4iXxn4gpTSJ8pzF6WU9m78X6fYiHg+cHTHMvvEDlF/n/XvVG4p87nkk0W61N819njyl5y15DNh9yX/ls7jyGewvm5E3H7ks3M3iusTu8QyW9u5xHXqU+aS29qz/jPZ1KPJH5RJKR08Ii7IVyduFDdUbNd2DhW7xHXqWubIdpb481NK+5b5Z5P7gr8n38njkymlE1ri/rjEfbyO6xO7xDKf29bOEet0dIf6R677UG3t2s7y/JXkq1x/FxHvBP6VfPXmY8ryp8wT+yvgI3Vs17gllrnkdvYpd4gye67/z0s53yOfxf/hlNLNtKhiP1Bib1pK7BLLPGOpbV1h6386+eTQUWX+Hfn9bEvg5+SDJx8n5zRSSkdUcVuRT9DcmnyFzEZxHWJJKR3ZN7YlrrWdY6h/nOu/lG1at/MY8u9ofpU8IHFx+Z8nA89NKX25b+wQZTZif5/8M2Hjqv8F5BMzV/z6a/pExA7Ab1JKv+oQ+1jgppTSpdXybYGjm98ThhARu1SL/jml9NuI2BH4LymljzViNyN/1tqD3BfdSP4u87OqzMNTSqePuZ23If9e757kg+zvSSndWo693CGldMMiy+2Uq9WUpxK/YK6GyFMpd5BcaWWJiDuklP5lXHFDxUbEzimlH0+w/omu/zz/P473qe3IJxcM1v+19H0/TCn9+1L6vhK34t6nImJdSumWatmy5amt/j5xQ+VKE5BWwKi9k5NTv4l5fs99sbFDlDkL9ZPPHJs7E3M9+WywF5TH9W+kdIodokzr/8/YzcgHWX/BxlcSXtY3btJlTnH9F5FvTXsA+UznA4Aflvn9G3EXd4kbKrZrOxdR/8TWv0+ZLa/bC9hw15Db0fjpjq5xky5ziutv/q5bfSuwSxYTu1rKXGX1X0w++/zx5DPzbyLfnu0IylUUQ8Zaf68y537Lby3wY8pPW5FPXLqsb9xQsdNYf88yL288vxXw5TJ/d0Z8RlwodogyrT9BvkLsBDbcPv+WMn8CsN2I2G/PF9s1bqjYVVr/gtt/1ASc3SVuqKlP/ZNu61DrVf3fNuRbHZ8GPKN67uRlaHez/vqqxpP7xq2EaYi2ku+0+A7yFbXryD9FeBn5quD6Ctu22MuXEjuGMpfU1oHX/+SFyh0RN6rMHVqm68l3Bt1hnrh1bXFDxXZt51CxS1ynPvWPWv8DG/Pbkn/G6DLyybCtP8c65n6iWf925O8UrfW3xC5rW4dYp57lnkC5GwP553KvJf8cwQ20HHuq/nddj3paY6v69yn1X1PXPyKuUzvH1Van5Z/WIGlFiojLRkyXk2+R0zt2iDKtnzUppf8HkFK6njzA9ISIeDP54B2LiB2iTOuH36WUbk35zMTvpZR+Uf7v18B/LCJu0mVOa/37AN8EXg78POUrkH6dUvpKSukrjbgHdYwbKrZrO/vWP8n171MmwJqI2D4i1pGvALwJIKX0r8DvFhE36TKntf4rIuKoMn9pROwDEBF7AL9dZOxqKXM11Z9SSv+RUvpcSulZ5Nsonkz+R7abSgAAB4hJREFU2ZxrqzKHiLX+7mWuiYjNgduTBwK3Lcu3IP+WYt+4oWKnsf4+ZUIeWJ97fmuAlNL3lxg7RJmzXv8Z5J/BelRKaYeU0jryXXN+Vp5riz2giv1pFds1bqjYlVr/fNu03v4blRkRe4+YHkS+01cnEXH2YmL71L/cbV3sOo2rrS31n0r+LvxR4BkR8dGI2KI895Dqf7eJiDdExGkRcXj13Ml941rqP2ye+rvG9aq/xJ5QYp+xzOvUp9z3At8CfkC+o9uvyXcG+Qfy7b5ZIPaJS4xdaplLbeuQ639Vh3Lb4kaVeTP5e3Jzugv5ZPcL54m7cETcULFd2zlU7FLWqU/9o8p9fWP+TcCPyHfwuYD8czf/KSIObMxvGxGnRD7me3pE1MeHu8Y26/8r8sUHrfW3xLa2tap7uzG1c5B16lM/cFDacDexvwKenlLanXwXyjc1yjkh8hXaRMQ+EXEtcF5E3BAR+1f1d46t6v/LUv9udf0j4jZp58Bt1XJLK2DU3snJadOJfNXEA4Fdqmk9+fZTvWOHKHPW6yffqviB1f+uJf8Gya3V8k6xQ5Rp/QngPMrvPtH47WbywdaL+sZNusxprb/x3F2BD5N/H2nkHSC6xg0VO43194i7njyQdF35e6eyfGs2vnK2U9yky5zi+rclHxD6Hvm1+NvyP18h3xK8d+xqKXOV1d/6O3Llua2qx2OPtf5eZb6w5PAG8m+ffxF4F/mqpOP7xg0VO4319yzzBeQrYN5Fvsr2qLJ8J6rfHuwaO0SZ1p8AvjPP6+87i4kdosxZrx+4lfzd65yW6dfV/+09YnoQ+RalvWN71j/2tg6xTn3a2rPM+rPgy4Gvk6/KrL/PfZR8Bd2TgDPL4y3Kcxf1jetT/xDtnPQ69ay/eQeP7y9Q39hjrb9XmS8m33nofo1l1zVj+sQNFWv98/Yv9eNm7LuB15KP+b4Q+PvFxC6h/pGxQ7RzmdZpofqvAtaW+XOr5y4fMX8O8OAyvwdw4Tz/t1Bs1/o7xQ3ZVqflnybeACcnp/aJfJuTR4x47vTFxA5R5qzXTx5YuuOIuIdXjzvFDlGm9ScoX1Jb4nZk4w/eneImXea01t8ScxDw+vli+sQNFTuN9fcps/q/rYBdxxU36TKnpX7yrSQfQD6wOu/t07rGrpYyV0P9wB5d9oWhYq2/e5kl/s7Ancv8dsChwL6LjRsqdhrr71nmXuX5e3fIaafYIcqc9fqBzwEvpdE3ku/odSzwhcXEDlHmrNcPXAHsPiKHP6gej31wu2f9Y2/rEOvUp609y7yKxknKZdmRwJXADdXyIQa3O9U/RDsnvU4967+0Mf/a6n/qgZixx1p/9zLLsrmTyt9MvtPNtXVMn7ihYme5fvJvQL+IPMB+LflObHPPbfJTgI35cQ1u96m/U+wQ7RxwnfrU/3zy549Hk38O4a3knwJ8NXBaI67PgHWf2K71d4obsq1Oyz9NvAFOTk5OTk5OTk5OTk5OTk5OTrM3kX+D9EQ2/N72T8qBxBOB7RcTO0SZs14/+eSHe43I4ZOqx2Mf3O5Z/9jbOsQ69WlrzzLfCDy2Je5A4Opq2RCD253qH6Kdk16nnvW/Bti6pczdgI9Uy8Yea/3dy6yePxg4F/jRqJg+cUPFzmL9wPHVtFNZfkfgfVXsEIPbfervFDtEOwdcp871l2UHAB8CLibfLerTwHMoA8klps+AdefYrvX3jBusrU7LO028AU5OTk5OTk5OTk5OTk5OTk5OTs2Jciv3ccYOUeas11/HMdDg9hDr1LX+5V6nuq1DlFkej31we6B9qs+A9UTXaRzlTmM/MU31A1sC910otmvcULGzXv98OWWAwe0h9tOh2jnEOo2jzBHlHkCHAeu+sUvNVVvccrfVaZgpSoIkSZIkSZKkFSEivp9Suvs4Y4coc9br71nmUSmlU8cZO+A27Vr/2NepxHbd/mMvs0+5A63TpPepSW/TqesnZr3+aVynKa5/VbxPDfjeM8Q6Tfq9b+repzQcB8wlSZIkSZK07CLislFPAXuklLboGztEmbNef58y57PYQYOhtuk42rqUgZBxtHWIMtvKHXf9k96n+sQN0dZp7Cdmvf5pXKdprX8+q+V9ajlOQhhqm056/VfLPqXJWDvpBkiSJEmSJGkm7Qz8V+Cn1fIAvrHI2CHKnPX6O5e5wAHmnRcZO8g27Vr/QOvUua1DlNmn3IHqn+g+Nelt2qfMgWKtf3WUaf2rpE/pU3/X2KHee4ZYp0m/903j+5QmwwFzSZIkSZIkTcKngK1TSpfUT0TElxcZO0SZs15/nzKHGAgZaptOeiCoa1uHKLNPuUPUP+l9atLbdBr7iVmvfxrXaVrrXy3vU5M+CWGobTrp9V8t+5QmwFuyS5IkSZIkSVqyiDgFODWl9LWW505PKR2+mNhJtnXS6zTUdhpi/YcwxPaf9DaVNDmT7tMn3c7V8j416XWa1rZqfg6YS5IkSZIkSZIkSZJm0ppJN0CSJEmSJEmSJEmSpElwwFySJEmSJEmSJEmSNJMcMJckSZIkSZIkSZIkzSQHzCVJkiRJkiRJkiRJM+n/A5PqBkTRXTYKAAAAAElFTkSuQmCC\n"
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "imp= pd.DataFrame(xgbc.feature_importances_)\n",
        "f_imp= imp.set_axis(['Score'], axis=1, inplace=False)\n",
        "f_imp"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 423
        },
        "id": "dbMm6DEE2PcC",
        "outputId": "e64f9339-5bb9-49f6-a995-1c15b0206225"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "            Score\n",
              "0    0.000000e+00\n",
              "1    0.000000e+00\n",
              "2    0.000000e+00\n",
              "3    0.000000e+00\n",
              "4    0.000000e+00\n",
              "..            ...\n",
              "162  3.177611e-05\n",
              "163  2.727999e-04\n",
              "164  1.295364e-02\n",
              "165  1.561814e-12\n",
              "166  1.334184e-01\n",
              "\n",
              "[167 rows x 1 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-a8475308-7a4a-4405-af6f-6d8ac885cf29\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Score</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>162</th>\n",
              "      <td>3.177611e-05</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>163</th>\n",
              "      <td>2.727999e-04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>164</th>\n",
              "      <td>1.295364e-02</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>165</th>\n",
              "      <td>1.561814e-12</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>166</th>\n",
              "      <td>1.334184e-01</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>167 rows × 1 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a8475308-7a4a-4405-af6f-6d8ac885cf29')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-a8475308-7a4a-4405-af6f-6d8ac885cf29 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-a8475308-7a4a-4405-af6f-6d8ac885cf29');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 45
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "##\n",
        "from google.colab import files\n",
        "\n",
        "f_imp.to_csv('sxl_UnderMACCS_XGB_HPT_FeatureImp.csv', encoding = 'utf-8-sig') \n",
        "files.download('sxl_UnderMACCS_XGB_HPT_FeatureImp.csv')"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 17
        },
        "id": "pHZQE1pP3uEI",
        "outputId": "69ac7677-aa40-45f2-dbdf-4d8aa389fe2e"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_b6208764-46e0-4687-8763-9ecdf8cf285c\", \"sxl_UnderX_MFP.csv\", 4005039)"
            ]
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!cp 'sxl_UnderMACCS_XGB_HPT_FeatureImp.csv' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ],
      "metadata": {
        "id": "GUJ4LMk44X-x"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Decision Boundary"
      ],
      "metadata": {
        "id": "l04k910kuG41"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "s150q6HT4HRt"
      },
      "outputs": [],
      "source": [
        " #### plotting  trail             https://scikit-learn.org/stable/auto_examples/ensemble/plot_voting_decision_regions.html#sphx-glr-auto-examples-ensemble-plot-voting-decision-regions-py\n",
        "from itertools import product\n",
        "\n",
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "from sklearn import datasets\n",
        "from sklearn.tree import DecisionTreeClassifier\n",
        "from sklearn.neighbors import KNeighborsClassifier\n",
        "from sklearn.svm import SVC\n",
        "from sklearn.ensemble import VotingClassifier\n",
        "\n",
        "# Loading some example data\n",
        "iris = datasets.load_iris()\n",
        "X = iris.data[:, [0, 2]]\n",
        "y = iris.target\n",
        "\n",
        "# Training classifiers\n",
        "clf1 = DecisionTreeClassifier(max_depth=4)\n",
        "clf2 = KNeighborsClassifier(n_neighbors=7)\n",
        "clf3 = SVC(gamma=0.1, kernel=\"rbf\", probability=True)\n",
        "eclf = VotingClassifier(\n",
        "    estimators=[(\"dt\", clf1), (\"knn\", clf2), (\"svc\", clf3)],\n",
        "    voting=\"soft\",\n",
        "    weights=[2, 1, 2],\n",
        ")\n",
        "\n",
        "clf1.fit(X, y)\n",
        "clf2.fit(X, y)\n",
        "clf3.fit(X, y)\n",
        "eclf.fit(X, y)\n",
        "\n",
        "# Plotting decision regions\n",
        "x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1\n",
        "y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1\n",
        "xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.1), np.arange(y_min, y_max, 0.1))\n",
        "\n",
        "f, axarr = plt.subplots(2, 2, sharex=\"col\", sharey=\"row\", figsize=(10, 8))\n",
        "\n",
        "for idx, clf, tt in zip(\n",
        "    product([0, 1], [0, 1]),\n",
        "    [clf1, clf2, clf3, eclf],\n",
        "    [\"Decision Tree (depth=4)\", \"KNN (k=7)\", \"Kernel SVM\", \"Soft Voting\"],\n",
        "):\n",
        "\n",
        "    Z = clf.predict(np.c_[xx.ravel(), yy.ravel()])\n",
        "    Z = Z.reshape(xx.shape)\n",
        "\n",
        "    axarr[idx[0], idx[1]].contourf(xx, yy, Z, alpha=0.4)\n",
        "    axarr[idx[0], idx[1]].scatter(X[:, 0], X[:, 1], c=y, s=20, edgecolor=\"k\")\n",
        "    axarr[idx[0], idx[1]].set_title(tt)\n",
        "\n",
        "plt.show()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# Testing PRB diverse molecules\n",
        "\n",
        "---\n",
        "\n",
        "\n",
        "\n",
        "---\n",
        "\n"
      ],
      "metadata": {
        "id": "fRdXx_gPgGve"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# load the model from disk\n",
        "import joblib\n",
        "loaded_model = joblib.load('/content/drive/MyDrive/PhD/XGBoost_MACCS/sexualsXGBoostHPTFInal_UMACCS_model.sav')\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)\n",
        "# predict\n",
        "xgb_predict =loaded_model.predict(Xt_test)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "dgqIYv6tC9wg",
        "outputId": "8c0ea909-df09-4ea0-961f-38e1828a98dd"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.9696816574027286\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(loaded_model,Xt_train, Yt_train, cv=10)"
      ],
      "metadata": {
        "id": "6GeWQ5ptgq2J"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"%0.4f accuracy with a standard deviation of %0.4f\" % (scores.mean(), scores.std()))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "bec66c30-623b-42f0-8603-77fedc1678a4",
        "id": "Jez9PqsFgq2J"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.9687 accuracy with a standard deviation of 0.0044\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgb_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgb_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgb_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgb_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgb_predict)\n",
        "cm"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "75418fc2-6860-4606-a9f2-b0efa75cf212",
        "id": "5u6f9cizgq2K"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.969682\n",
            "Recall 0.712042\n",
            "precision 0.964539\n",
            "F1 score: 0.819277\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[1783,    5],\n",
              "       [  55,  136]])"
            ]
          },
          "metadata": {},
          "execution_count": 17
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgb_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgb_predict))\n",
        "print('F1 score:',f1_score(Yt_test, xgb_predict))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "338b4f42-ff67-4318-a4a6-8b759c39e256",
        "id": "BWw4OTG7gq2K"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "ROCAUC score: 0.854622732117549\n",
            "Accuracy score: 0.9696816574027286\n",
            "F1 score: 0.8192771084337349\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgb_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgb_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgb_predict)\n",
        "print(matrix)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "7e3526fd-0cc0-4f63-ca05-752a4b8ba188",
        "id": "EMTMRAZCgq2K"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cohens kappa: 0.803139\n",
            "ROC AUC: 0.854623\n",
            "[[1783    5]\n",
            " [  55  136]]\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "17d63506-e9e7-48e0-fcee-db15d68a510e",
        "id": "Ky15xDY8gq2K"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Test Set: 1979\n",
            "0    1788\n",
            "1     191\n",
            "Name: Target, dtype: int64\n",
            "[[1783    5]\n",
            " [  55  136]]\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###Import model\n",
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/Asxl_undersmpl_MFP/PBR test set\n",
        "!ls '/content/drive/MyDrive/PhD/Asxl_undersmpl_MFP/PBR test set'"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "JV2Moun9gOr-",
        "outputId": "7e6647b8-4e05-4449-8d6e-d3caf2af9b22"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/drive/MyDrive/PhD/Asxl_undersmpl_MFP/PBR test set\n",
            "PRBdata.csv  PRB_test_set2.csv\tPRB_test_set.csv\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "prb= pd.read_csv(\"PRB_test_set2.csv\", sep= \";\")\n",
        "prb= prb.dropna()"
      ],
      "metadata": {
        "id": "aOneX6-SgOzL"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "prb"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 574
        },
        "id": "2YYtZly3gPFn",
        "outputId": "8884c33d-2744-429d-bf7b-19276dc6a1f5"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "    Compound ID                                             SMILES pLDH2 µM  \\\n",
              "0     MMV000008                  CCN(CC)CCCC(C)Nc1ccnc2cc(Cl)ccc12    85,78   \n",
              "2     MMV000043  COc1cc(C)c2c(Oc3cccc(c3)C(F)(F)F)c(OC)cc(NC(C)...    56,47   \n",
              "3     MMV000051  CCC[C@@H]1C[C@H](N(C)C1)C(=O)N[C@H]([C@H](C)Cl...    72,93   \n",
              "4     MMV000059  O1C(=CC=C1C2=CC=C(C(=N)NOC)C=C2)C3=CC=C(C(=N)N...    -3,01   \n",
              "5     MMV000725  ClC3=C(OCC(O)C[N]1[C](=N)[N](CCN(CC)CC)C2=C1C=...     95,4   \n",
              "..          ...                                                ...      ...   \n",
              "395   MMV690653  FC3=C2N=C(N(C1=C(OC)C=CC(=C1)C(F)(F)F)[C@H](C2...     22,9   \n",
              "396   MMV690706  ONC(=O)C1(CS(=O)(=O)c2ccc(Oc3ccc(Cl)cc3)cc2)CC...    28,12   \n",
              "397   MMV811071                        CN(C)CCNC(=O)c1cccc2cccnc12     9,84   \n",
              "398   MMV831201  FC(F)(C1N2N=CC(C(NCC(C=C3)=CC=C3OC)=O)=C2NC(C(...    37,21   \n",
              "399   MMV975972                    NC1=CC(=NNC1=O)c2nc3ccccc3[nH]2    31,47   \n",
              "\n",
              "    Luciferase assay1µM ATP assay1µM PrestoBlue1µM  Sexual hit  \\\n",
              "0                 29,65            0         16,93           0   \n",
              "2                     0            0         47,86           1   \n",
              "3                     0            0         10,27           0   \n",
              "4                     0         0,62         11,76           0   \n",
              "5                     0        82,19             0           1   \n",
              "..                  ...          ...           ...         ...   \n",
              "395                   0            0         11,08           0   \n",
              "396                2,48            0         22,62           0   \n",
              "397                   0            0             0           0   \n",
              "398                   0         2,93             0           0   \n",
              "399                1,36          5,5         28,32           1   \n",
              "\n",
              "    Luciferase assay Unnamed: 8 ATP assay Unnamed: 10 PrestoBlue® Unnamed: 12  \\\n",
              "0              29,65       5,51         0           0       16,93           6   \n",
              "2                  0      79,63         0       69,98       47,86        71,7   \n",
              "3                  0          0         0        1,18       10,27       24,21   \n",
              "4                  0          0      0,62           0       11,76        9,28   \n",
              "5                  0      91,64     82,19       90,71           0           0   \n",
              "..               ...        ...       ...         ...         ...         ...   \n",
              "395                0       6,89         0           0       11,08        1,05   \n",
              "396             2,48          0         0           0       22,62       28,18   \n",
              "397                0      10,08         0           0           0           0   \n",
              "398                0       6,49      2,93        4,83           0       34,64   \n",
              "399             1,36          0       5,5           0       28,32       78,81   \n",
              "\n",
              "    Final Primary Screen Gametocyte Inhibition (%) 5 µM  Shit Compound ID.1  \n",
              "0                                                    6    0.0     MMV000008  \n",
              "2                                                 79,6    1.0     MMV000043  \n",
              "3                                                 24,2    0.0     MMV000051  \n",
              "4                                                 91,6    1.0     MMV000725  \n",
              "5                                                  5,8    0.0     MMV001014  \n",
              "..                                                 ...    ...           ...  \n",
              "395                                               14,8    0.0     MMV690547  \n",
              "396                                               21,3    0.0     MMV690555  \n",
              "397                                                6,9    0.0     MMV690621  \n",
              "398                                                6,9    0.0     MMV690653  \n",
              "399                                               28,2    0.0     MMV690706  \n",
              "\n",
              "[399 rows x 16 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-5759d2a7-ac36-4a7b-96a9-7aa0abe55a63\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Compound ID</th>\n",
              "      <th>SMILES</th>\n",
              "      <th>pLDH2 µM</th>\n",
              "      <th>Luciferase assay1µM</th>\n",
              "      <th>ATP assay1µM</th>\n",
              "      <th>PrestoBlue1µM</th>\n",
              "      <th>Sexual hit</th>\n",
              "      <th>Luciferase assay</th>\n",
              "      <th>Unnamed: 8</th>\n",
              "      <th>ATP assay</th>\n",
              "      <th>Unnamed: 10</th>\n",
              "      <th>PrestoBlue®</th>\n",
              "      <th>Unnamed: 12</th>\n",
              "      <th>Final Primary Screen Gametocyte Inhibition (%) 5 µM</th>\n",
              "      <th>Shit</th>\n",
              "      <th>Compound ID.1</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>MMV000008</td>\n",
              "      <td>CCN(CC)CCCC(C)Nc1ccnc2cc(Cl)ccc12</td>\n",
              "      <td>85,78</td>\n",
              "      <td>29,65</td>\n",
              "      <td>0</td>\n",
              "      <td>16,93</td>\n",
              "      <td>0</td>\n",
              "      <td>29,65</td>\n",
              "      <td>5,51</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>16,93</td>\n",
              "      <td>6</td>\n",
              "      <td>6</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV000008</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>MMV000043</td>\n",
              "      <td>COc1cc(C)c2c(Oc3cccc(c3)C(F)(F)F)c(OC)cc(NC(C)...</td>\n",
              "      <td>56,47</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>47,86</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>79,63</td>\n",
              "      <td>0</td>\n",
              "      <td>69,98</td>\n",
              "      <td>47,86</td>\n",
              "      <td>71,7</td>\n",
              "      <td>79,6</td>\n",
              "      <td>1.0</td>\n",
              "      <td>MMV000043</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>MMV000051</td>\n",
              "      <td>CCC[C@@H]1C[C@H](N(C)C1)C(=O)N[C@H]([C@H](C)Cl...</td>\n",
              "      <td>72,93</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>10,27</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1,18</td>\n",
              "      <td>10,27</td>\n",
              "      <td>24,21</td>\n",
              "      <td>24,2</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV000051</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>MMV000059</td>\n",
              "      <td>O1C(=CC=C1C2=CC=C(C(=N)NOC)C=C2)C3=CC=C(C(=N)N...</td>\n",
              "      <td>-3,01</td>\n",
              "      <td>0</td>\n",
              "      <td>0,62</td>\n",
              "      <td>11,76</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0,62</td>\n",
              "      <td>0</td>\n",
              "      <td>11,76</td>\n",
              "      <td>9,28</td>\n",
              "      <td>91,6</td>\n",
              "      <td>1.0</td>\n",
              "      <td>MMV000725</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>MMV000725</td>\n",
              "      <td>ClC3=C(OCC(O)C[N]1[C](=N)[N](CCN(CC)CC)C2=C1C=...</td>\n",
              "      <td>95,4</td>\n",
              "      <td>0</td>\n",
              "      <td>82,19</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>91,64</td>\n",
              "      <td>82,19</td>\n",
              "      <td>90,71</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>5,8</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV001014</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>395</th>\n",
              "      <td>MMV690653</td>\n",
              "      <td>FC3=C2N=C(N(C1=C(OC)C=CC(=C1)C(F)(F)F)[C@H](C2...</td>\n",
              "      <td>22,9</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>11,08</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>6,89</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>11,08</td>\n",
              "      <td>1,05</td>\n",
              "      <td>14,8</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV690547</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>396</th>\n",
              "      <td>MMV690706</td>\n",
              "      <td>ONC(=O)C1(CS(=O)(=O)c2ccc(Oc3ccc(Cl)cc3)cc2)CC...</td>\n",
              "      <td>28,12</td>\n",
              "      <td>2,48</td>\n",
              "      <td>0</td>\n",
              "      <td>22,62</td>\n",
              "      <td>0</td>\n",
              "      <td>2,48</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>22,62</td>\n",
              "      <td>28,18</td>\n",
              "      <td>21,3</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV690555</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>397</th>\n",
              "      <td>MMV811071</td>\n",
              "      <td>CN(C)CCNC(=O)c1cccc2cccnc12</td>\n",
              "      <td>9,84</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>10,08</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>6,9</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV690621</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>398</th>\n",
              "      <td>MMV831201</td>\n",
              "      <td>FC(F)(C1N2N=CC(C(NCC(C=C3)=CC=C3OC)=O)=C2NC(C(...</td>\n",
              "      <td>37,21</td>\n",
              "      <td>0</td>\n",
              "      <td>2,93</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>6,49</td>\n",
              "      <td>2,93</td>\n",
              "      <td>4,83</td>\n",
              "      <td>0</td>\n",
              "      <td>34,64</td>\n",
              "      <td>6,9</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV690653</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>399</th>\n",
              "      <td>MMV975972</td>\n",
              "      <td>NC1=CC(=NNC1=O)c2nc3ccccc3[nH]2</td>\n",
              "      <td>31,47</td>\n",
              "      <td>1,36</td>\n",
              "      <td>5,5</td>\n",
              "      <td>28,32</td>\n",
              "      <td>1</td>\n",
              "      <td>1,36</td>\n",
              "      <td>0</td>\n",
              "      <td>5,5</td>\n",
              "      <td>0</td>\n",
              "      <td>28,32</td>\n",
              "      <td>78,81</td>\n",
              "      <td>28,2</td>\n",
              "      <td>0.0</td>\n",
              "      <td>MMV690706</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>399 rows × 16 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5759d2a7-ac36-4a7b-96a9-7aa0abe55a63')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-5759d2a7-ac36-4a7b-96a9-7aa0abe55a63 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-5759d2a7-ac36-4a7b-96a9-7aa0abe55a63');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 23
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "dchm2= prb[\"SMILES\"]\n",
        "dchm2"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "88ffce14-85ac-4617-d3b1-8b80cdb85da5",
        "id": "8SuUGdbhlQzC"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0                      CCN(CC)CCCC(C)Nc1ccnc2cc(Cl)ccc12\n",
              "2      COc1cc(C)c2c(Oc3cccc(c3)C(F)(F)F)c(OC)cc(NC(C)...\n",
              "3      CCC[C@@H]1C[C@H](N(C)C1)C(=O)N[C@H]([C@H](C)Cl...\n",
              "4      O1C(=CC=C1C2=CC=C(C(=N)NOC)C=C2)C3=CC=C(C(=N)N...\n",
              "5      ClC3=C(OCC(O)C[N]1[C](=N)[N](CCN(CC)CC)C2=C1C=...\n",
              "                             ...                        \n",
              "395    FC3=C2N=C(N(C1=C(OC)C=CC(=C1)C(F)(F)F)[C@H](C2...\n",
              "396    ONC(=O)C1(CS(=O)(=O)c2ccc(Oc3ccc(Cl)cc3)cc2)CC...\n",
              "397                          CN(C)CCNC(=O)c1cccc2cccnc12\n",
              "398    FC(F)(C1N2N=CC(C(NCC(C=C3)=CC=C3OC)=O)=C2NC(C(...\n",
              "399                      NC1=CC(=NNC1=O)c2nc3ccccc3[nH]2\n",
              "Name: SMILES, Length: 399, dtype: object"
            ]
          },
          "metadata": {},
          "execution_count": 24
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "mols2 = [Chem.MolFromSmiles(x) for x in dchm2]\n",
        "featurizer = MACCSKeysFingerprint()\n",
        "maccs2 = featurizer.featurize(mols2)\n",
        "maccs2"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "509af5ba-88e9-415d-94fb-90208a9d5849",
        "id": "Djld3eHzlQzC"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[0, 0, 0, ..., 0, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       ...,\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0]])"
            ]
          },
          "metadata": {},
          "execution_count": 25
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#Split\n",
        "\n",
        "Xtest = np.array(maccs2)\n",
        "Ytest = np.array(list(prb[\"Sexual hit\"]))\n",
        "print(\"Input\",Xt[0])\n",
        "print(\"Target\",Yt[0])\n",
        "\n",
        "#Split\n",
        "from sklearn.model_selection import train_test_split\n",
        "Xt_train, Xt_test = train_test_split(Xt, test_size=0.2)\n",
        "Yt_train, Yt_test = train_test_split(Yt, test_size=0.2)\n",
        "\n",
        "y_true= Yt_test\n",
        "\n",
        "Yt_train = keras.utils.to_categorical(Yt_train)\n",
        "Yt_test = keras.utils.to_categorical(Yt_test)\n",
        "\n",
        "print(\"Input\",Xt_train[0])\n",
        "print(\"Target\",Yt_train[0])\n",
        "print(\"Xt-train input shape:\", Xt_train.shape)\n",
        "print(\"Yt-train label shape:\", Yt_train.shape)\n",
        "# print(Xt_train.shape)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "3de28b3d-bccd-446f-dd58-7b0b02d16884",
        "id": "P3onptoAlQzD"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 1 0 1 0 1 1 0 0 1 1 1 1 0 0 0 1 1 1 0 0 0 1 1 1 0 1 1 0 0 0 1 0 0 0 0 1\n",
            " 1 0 0 0 0 0 1 1 0 1 1 1 0 0 1 0 0 1 1 0 1 0 0 0 0 0 1 1 0 0 0 1 0 0 1 0 1\n",
            " 1 0 0 1 0 1 1 1 1 0 1 0 0 1 1 1 1 1 0]\n",
            "Target 1\n",
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 1 0 1 0 1 1 0 0 1 0 1 1 1 0 0 0 0 0 0 1 1 1 0 0 0 1 0 0 0 0 0 0 1 1 1 0\n",
            " 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 1 1 1 1 0 0 1 0 1 0 0 1 1 0 0 0 1 1 1 0 0 1\n",
            " 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 0]\n",
            "Target [0. 1.]\n",
            "Xt-train input shape: (7912, 167)\n",
            "Yt-train label shape: (7912, 2)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "Xtest = np.array(maccs2)\n",
        "Ytest = np.array(list(prb[\"Sexual hit\"]))\n",
        "print(\"Input\",Xt[0])\n",
        "print(\"Target\",Yt[0])\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "wFLwfcbp0eGL",
        "outputId": "4c9f04ef-92c3-4139-f797-a77c8fb06ac7"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 1 0 1 0 1 1 0 0 1 1 1 1 0 0 0 1 1 1 0 0 0 1 1 1 0 1 1 0 0 0 1 0 0 0 0 1\n",
            " 1 0 0 0 0 0 1 1 0 1 1 1 0 0 1 0 0 1 1 0 1 0 0 0 0 0 1 1 0 0 0 1 0 0 1 0 1\n",
            " 1 0 0 1 0 1 1 1 1 0 1 0 0 1 1 1 1 1 0]\n",
            "Target 1\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###check to see if hits are in correct places\n",
        "print(maccs2[0:4])\n",
        "print(Ytest[0:4])\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "2d7e6884-78eb-49d9-c4f9-6033fc7eacce",
        "id": "bzroqstglQzD"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            "  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0\n",
            "  0 0 0 0 0 0 0 0 1 0 0 0 0 1 1 1 0 0 1 1 0 0 0 0 0 0 1 0 1 1 0 1 1 1 0 1\n",
            "  1 0 0 1 0 0 1 1 1 0 1 0 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1 1 0 1 1 0 0 1 1 0\n",
            "  0 1 0 1 1 1 0 1 0 1 0 1 1 0 1 0 1 1 1 1 0 1 0]\n",
            " [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            "  0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0\n",
            "  1 0 0 0 0 0 0 1 0 0 1 0 1 0 0 0 0 0 1 1 1 1 0 0 0 1 1 0 1 1 0 0 1 1 1 1\n",
            "  1 0 1 1 1 1 0 1 1 1 1 0 0 1 0 0 0 1 1 1 0 0 0 1 0 1 1 1 0 1 0 0 0 1 1 1\n",
            "  1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0]\n",
            " [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            "  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0\n",
            "  1 0 0 1 0 0 0 1 0 1 0 1 0 1 1 0 1 1 1 1 1 1 0 1 1 1 1 0 1 0 0 1 0 0 0 1\n",
            "  1 0 1 1 0 0 1 1 1 1 1 0 1 1 1 0 0 0 0 1 0 1 0 1 0 0 1 0 0 1 0 1 1 1 1 1\n",
            "  0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0]\n",
            " [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0\n",
            "  0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0 1\n",
            "  0 0 0 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 1 0 0 0 0 0\n",
            "  0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 1 1 0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 1 0\n",
            "  0 1 1 0 0 1 0 1 1 0 0 0 1 1 1 1 1 1 1 1 1 1 0]]\n",
            "[0 1 0 0]\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df=[]\n",
        "df = pd.DataFrame(maccs2)\n",
        "#df[\"Target\"]= sxl[\"Target\"]\n",
        "df"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 423
        },
        "outputId": "3689696f-17f2-4072-db92-ed5582be0562",
        "id": "NQ-5kMgZlQzD"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     0    1    2    3    4    5    6    7    8    9    ...  157  158  159  \\\n",
              "0      0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "1      0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "2      0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "3      0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "4      0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "..   ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...   \n",
              "394    0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "395    0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "396    0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "397    0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "398    0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "\n",
              "     160  161  162  163  164  165  166  \n",
              "0      1    1    1    1    0    1    0  \n",
              "1      1    1    1    1    1    1    0  \n",
              "2      1    1    0    1    1    1    0  \n",
              "3      1    1    1    1    1    1    0  \n",
              "4      1    1    1    1    1    1    0  \n",
              "..   ...  ...  ...  ...  ...  ...  ...  \n",
              "394    1    1    1    1    1    1    0  \n",
              "395    0    1    1    1    1    1    0  \n",
              "396    1    1    1    1    1    1    0  \n",
              "397    1    1    1    1    1    1    0  \n",
              "398    0    1    1    1    1    1    0  \n",
              "\n",
              "[399 rows x 167 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-b3ffa471-29c7-4e55-b0d2-f1f1210b4a1d\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "      <th>1</th>\n",
              "      <th>2</th>\n",
              "      <th>3</th>\n",
              "      <th>4</th>\n",
              "      <th>5</th>\n",
              "      <th>6</th>\n",
              "      <th>7</th>\n",
              "      <th>8</th>\n",
              "      <th>9</th>\n",
              "      <th>...</th>\n",
              "      <th>157</th>\n",
              "      <th>158</th>\n",
              "      <th>159</th>\n",
              "      <th>160</th>\n",
              "      <th>161</th>\n",
              "      <th>162</th>\n",
              "      <th>163</th>\n",
              "      <th>164</th>\n",
              "      <th>165</th>\n",
              "      <th>166</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>394</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>395</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>396</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>397</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>398</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>399 rows × 167 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b3ffa471-29c7-4e55-b0d2-f1f1210b4a1d')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-b3ffa471-29c7-4e55-b0d2-f1f1210b4a1d button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-b3ffa471-29c7-4e55-b0d2-f1f1210b4a1d');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 29
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "xgb_predict = loaded_model.predict(df)"
      ],
      "metadata": {
        "id": "xBNIC21hlQzD"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "df= xgb_predict\n",
        "df= pd.DataFrame(df)\n",
        "print(df.value_counts())\n",
        "df"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 476
        },
        "id": "eTcNdEPjk7s-",
        "outputId": "35f03820-ee4f-4aa8-85fd-8d795d7371c9"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0    297\n",
            "1    102\n",
            "dtype: int64\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     0\n",
              "0    1\n",
              "1    0\n",
              "2    0\n",
              "3    1\n",
              "4    1\n",
              "..  ..\n",
              "394  1\n",
              "395  0\n",
              "396  0\n",
              "397  0\n",
              "398  0\n",
              "\n",
              "[399 rows x 1 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-6c7c4eca-7dc5-4b5a-8c09-1514d489c4fb\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>394</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>395</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>396</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>397</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>398</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>399 rows × 1 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6c7c4eca-7dc5-4b5a-8c09-1514d489c4fb')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-6c7c4eca-7dc5-4b5a-8c09-1514d489c4fb button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-6c7c4eca-7dc5-4b5a-8c09-1514d489c4fb');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 31
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "prd= df.set_axis(['Predicted'], axis=1, inplace=False)\n",
        "ht= prb[\"Sexual hit\"]\n",
        "print(ht)\n",
        "Yt = np.array(list(prb[\"Sexual hit\"]))\n",
        "#prd['Actual'] = prd['Actual'].fillna(0)\n",
        "#prd.Actual = prd.Actual.round(0)\n",
        "print(Yt)\n",
        "print(xgb_predict)\n",
        "prd\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "2KV9fn071kS-",
        "outputId": "76f12516-2888-4a50-8381-75ea21fa5145"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0      0\n",
            "2      1\n",
            "3      0\n",
            "4      0\n",
            "5      1\n",
            "      ..\n",
            "395    0\n",
            "396    0\n",
            "397    0\n",
            "398    0\n",
            "399    1\n",
            "Name: Sexual hit, Length: 399, dtype: int64\n",
            "[0 1 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 1 0 0 0 1 0 1 0 0 1 0 0 0 1 0 0 1 0 1 0 0\n",
            " 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1\n",
            " 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 1 0 0 0 1 0 0 0 1 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]\n",
            "[1 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1\n",
            " 0 1 0 0 0 1 1 1 0 1 0 0 0 0 0 0 1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0\n",
            " 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 1 1 0 0 0 0 0 0 1 0 1 0 0 1 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 1 0 0 0 0 1 0 1 0 0 1 1 1 0 0 0 0 1 0 0 0 0 1 1 0 0 0 0 0 1 0 0\n",
            " 0 0 0 0 0 0 0 0 1 0 0 1 1 1 1 0 0 0 0 1 0 0 0 0 1 0 1 1 0 1 0 1 0 0 1 0 0\n",
            " 0 1 0 1 1 0 0 1 1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 1 1 0 1 0 0 1 0 1\n",
            " 0 0 0 0 1 1 0 0 1 1 0 1 0 1 0 0 0 0 0 1 0 1 0 0 0 1 0 1 0 0 1 0 0 0 0 1 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 1 0 0 0 0 0\n",
            " 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 0 0 0 0 0 1 0 1 0 0\n",
            " 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0 0 0 1 1 1 0 0 1 0 1 0 1 0 0 0 0 1\n",
            " 1 0 0 1 0 0 1 0 1 0 0 1 0 1 0 0 0 0 0 0 1 1 0 0 1 0 0 0 0]\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     Predicted\n",
              "0            1\n",
              "1            0\n",
              "2            0\n",
              "3            1\n",
              "4            1\n",
              "..         ...\n",
              "394          1\n",
              "395          0\n",
              "396          0\n",
              "397          0\n",
              "398          0\n",
              "\n",
              "[399 rows x 1 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-03713704-9605-456d-8975-1683da9ac43c\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Predicted</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>394</th>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>395</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>396</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>397</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>398</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>399 rows × 1 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-03713704-9605-456d-8975-1683da9ac43c')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-03713704-9605-456d-8975-1683da9ac43c button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-03713704-9605-456d-8975-1683da9ac43c');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 32
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt,xgb_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt,xgb_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt,xgb_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt,xgb_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt,xgb_predict)\n",
        "cm"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "499db696-604d-413e-d5c9-e9204defaa41",
        "id": "JJ34P8Lg4zu-"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.694236\n",
            "Recall 0.307692\n",
            "precision 0.156863\n",
            "F1 score: 0.207792\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[261,  86],\n",
              "       [ 36,  16]])"
            ]
          },
          "metadata": {},
          "execution_count": 33
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt, xgb_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt, xgb_predict))\n",
        "print('F1 score:',f1_score(Yt, xgb_predict))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "f40256e4-a034-47b0-a5ef-bae39d34b1a4",
        "id": "yY-aHhkr4zvA"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "ROCAUC score: 0.5299268454888051\n",
            "Accuracy score: 0.6942355889724311\n",
            "F1 score: 0.2077922077922078\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt, xgb_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt, xgb_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt, xgb_predict)\n",
        "print(matrix)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "05df0e9f-8eca-4ee3-b90e-a2e964e0fad5",
        "id": "Pqicg2yF4zvB"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cohens kappa: 0.042488\n",
            "ROC AUC: 0.529927\n",
            "[[261  86]\n",
            " [ 36  16]]\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Tlr5nq31llry"
      },
      "source": [
        "## Asexual stage"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "GiGevf5olob3",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "outputId": "680fc5d5-ceef-446c-ddf8-83b41153d67e"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/drive/MyDrive/PhD/PTS_datasets\n",
            " ABSActiveInactiveFeatCorrelationOnABSActives.csv\n",
            " ABSActiveInactiveFeatCorrelationOnABSInactives.csv\n",
            " absdualGBMFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " absdualLRFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " absdualRFFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " absdualsvmFinalizedhpt5005_UMFP_model_prediction_on_pbox.csv\n",
            " asexualsFeaturesZtestprop.csv\n",
            " asexualsFeaturesZtestpropInact.csv\n",
            " asexualsFeaturesZtestproportionsActvsInactv.csv\n",
            " asexualsFeaturesZtestpropTopABSfeat.csv\n",
            " asexualsFeaturesZtestpropTopDualfeat.csv\n",
            " asexualsFeaturesZtestpropTopfeat.csv\n",
            " asexualsGBMhpt_UMFP_model5atom500bitFinal.pkl\n",
            " asexualsLogisticRegressionFinalHPT_UMFP_model5005.pkl\n",
            " asexualsSVCFinalHPT_UMFP_model5005.pkl\n",
            " axldeepinsighOverUnderXttestMFP.npy\n",
            " axldeepinsighOverUnderXttrainMFP.npy\n",
            " axldeepinsighOverUnderYttestMFP.npy\n",
            " axldeepinsighOverUnderYttrainMFP.npy\n",
            " axl_UnderMFP_GBM_HPT5005_FeatureImp.csv\n",
            " axl_UnderMFP_LR_HPT_FeatureImp.csv\n",
            " axl_UnderMFP_RF_HPT5005_FeatureImp2.csv\n",
            " CTCVAE_300bit5radiusMFP.pkl\n",
            " CTCVAE_300bit5raduisMFP_500samples.csv\n",
            " CTGAN_300bit5radiusMFP.pkl\n",
            " CTGAN_300bit5raduisMFP_500samples.csv\n",
            " data\n",
            " DualactiveFeaturesZtestprop.csv\n",
            " DualActiveInactiveFeatCorrelationOnDualActives.csv\n",
            " DualActiveInactiveFeatCorrelationOnDualInactives.csv\n",
            " finalized_model.sav\n",
            " GanSexualsU_MACCs.pkl\n",
            " image_at_epoch_0000.png\n",
            " M_asexuals_lib_hits_nd_clst_nhts.csv\n",
            " Miniconda3-py37_4.12.0-Linux-x86_64.sh\n",
            " M_sexual_LibrariesC_hits_nd_2ndclst_nhits.csv\n",
            "'Sexual_libraries_hits and nonhits_composition.csv'\n",
            " sexualsFeaturesZtestpropInact.csv\n",
            " SexualsFeaturesZtestpropTopABSfeat.csv\n",
            " SexualsFeaturesZtestpropTopDualfeat.csv\n",
            " sexualsGBMFinalHPT_UMFP_model5005.pkl\n",
            " sexualsLRFinalHPT_UMFP_model5005.pkl\n",
            " sexualsRFFinalHPT_UMFP_model5005.pkl\n",
            " sexualsSVCFinalHPT_UMFP_model5005.pkl\n",
            " sxl_UnderMACCS_LR_HPT_FeatureImp.csv\n",
            " sxl_UnderMFP_GBM_HPT5005_FeatureImp.csv\n",
            " sxl_UnderMFP_LR_HPT5005_FeatureImp.csv\n",
            " sxl_UnderMFP_RF_HPT5005_FeatureImp2.csv\n",
            " sxl_UnderMFP_RF_HPT_FeatureImp2.csv\n",
            " sxl_UnderX_MFP.csv\n",
            " sxl_UnderX_MFP.csv.npy\n",
            " sxl_UnderX_MFP.npy\n",
            " TCGANSexualsU_MACCs.pkl\n",
            "Yes    30393\n",
            "No     29143\n",
            "Name: Hit, dtype: int64\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                                                  Smiles  Hit\n",
              "0         Cc1cccnc1CN1CC[C@H](Oc2cccc(F)c2)[C@@](C)(O)C1  Yes\n",
              "1      CC(C)(C)C(=O)N1C[C@H](c2ccsc2)[C@H]2CN(C3CCCCC...  Yes\n",
              "2               CC(C)N(CCNC(=O)c1[nH]nc2ccc(I)cc12)C(C)C  Yes\n",
              "3                 CC(Nc1nc(-c2ccncc2)nc2c1CCNC2)c1ccccc1  Yes\n",
              "4               CC(C)C[C@H](N)COc1cccc(F)c1Oc1cccc(Cl)c1  Yes\n",
              "...                                                  ...  ...\n",
              "59531     O=C1CC[C@H]2[C@H](CCN2C(=O)C2CCOC2)N1Cc1ccncc1   No\n",
              "59532      Cc1cc(Nc2ccc(F)cn2)cc(C2CCN(Cc3ncc[nH]3)C2)n1   No\n",
              "59533           O=C(CCNc1ccccc1)NC1CCN(C(=O)C2CCCCC2)CC1   No\n",
              "59534       CN(C)c1nc2c(c(N3CCC(O)CC3)n1)CN(CC1CCNC1)CC2   No\n",
              "59535          Cc1cc(C(=O)N(C)C)nc(C2(C)CCCN2c2ccccc2)n1   No\n",
              "\n",
              "[59536 rows x 2 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-7d40ed57-d59c-47aa-aba0-e5d67f14fe3d\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Smiles</th>\n",
              "      <th>Hit</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>Cc1cccnc1CN1CC[C@H](Oc2cccc(F)c2)[C@@](C)(O)C1</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>CC(C)(C)C(=O)N1C[C@H](c2ccsc2)[C@H]2CN(C3CCCCC...</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>CC(C)N(CCNC(=O)c1[nH]nc2ccc(I)cc12)C(C)C</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>CC(Nc1nc(-c2ccncc2)nc2c1CCNC2)c1ccccc1</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>CC(C)C[C@H](N)COc1cccc(F)c1Oc1cccc(Cl)c1</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59531</th>\n",
              "      <td>O=C1CC[C@H]2[C@H](CCN2C(=O)C2CCOC2)N1Cc1ccncc1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59532</th>\n",
              "      <td>Cc1cc(Nc2ccc(F)cn2)cc(C2CCN(Cc3ncc[nH]3)C2)n1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59533</th>\n",
              "      <td>O=C(CCNc1ccccc1)NC1CCN(C(=O)C2CCCCC2)CC1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59534</th>\n",
              "      <td>CN(C)c1nc2c(c(N3CCC(O)CC3)n1)CN(CC1CCNC1)CC2</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59535</th>\n",
              "      <td>Cc1cc(C(=O)N(C)C)nc(C2(C)CCCN2c2ccccc2)n1</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>59536 rows × 2 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7d40ed57-d59c-47aa-aba0-e5d67f14fe3d')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-7d40ed57-d59c-47aa-aba0-e5d67f14fe3d button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-7d40ed57-d59c-47aa-aba0-e5d67f14fe3d');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ],
      "source": [
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/PTS_datasets/\n",
        "!ls '/content/drive/MyDrive/PhD/PTS_datasets/'\n",
        "import pandas as pd\n",
        "axl= pd.read_csv(\"M_asexuals_lib_hits_nd_clst_nhts.csv\")\n",
        "axl['Hit'] = axl['Hit'].replace(np.nan, \"No\")\n",
        "axl = axl.iloc[: , 1:]\n",
        "print(axl['Hit'].value_counts())\n",
        "axl"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "compounds =[]\n",
        "df1= axl[:20000]\n",
        "\n",
        "for _, smiles, hit in df1[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "df2= axl[20001:23766]\n",
        "\n",
        "for _, smiles, hit in df2[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "df3= axl[23767:25396]\n",
        "\n",
        "for _, smiles, hit in df3[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "\n",
        "df4= axl[25397:25662]\n",
        "\n",
        "for _, smiles, hit in df4[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "df5= axl[25663:26912]\n",
        "\n",
        "for _, smiles, hit in df5[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "df6= axl[26913:28399]\n",
        "\n",
        "for _, smiles, hit in df6[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "df7= axl[28400:]\n",
        "\n",
        "for _, smiles, hit in df7[[\"Smiles\", \"Hit\"]].itertuples():\n",
        "    compounds.append((Chem.MolFromSmiles(smiles),hit))\n",
        "\n",
        "len(compounds)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "euySuPqD80lf",
        "outputId": "92950bb7-3cc5-4474-a60e-37cc7a49dacb"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "59530"
            ]
          },
          "metadata": {},
          "execution_count": 15
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "axl[\"Target\"] = np.where(axl[\"Hit\"]== \"Yes\", 1,0)\n",
        "axl[\"Target\"].value_counts()"
      ],
      "metadata": {
        "id": "T8LvO5RZoWhO",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "20207b37-3599-4f70-c741-9ad8798badfd"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "1    30393\n",
              "0    29143\n",
              "Name: Target, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 16
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "compounds\n",
        "dpchm= pd.DataFrame (compounds, columns = ['mol', 'hit']) \n",
        "dpchm"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 423
        },
        "id": "yEWff97S88Fa",
        "outputId": "813f76b1-6fc9-444e-a1c7-6cf57f0b148c"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                                                    mol  hit\n",
              "0      <rdkit.Chem.rdchem.Mol object at 0x7f8258bda970>  Yes\n",
              "1      <rdkit.Chem.rdchem.Mol object at 0x7f8258bda9e0>  Yes\n",
              "2      <rdkit.Chem.rdchem.Mol object at 0x7f8258bdaa50>  Yes\n",
              "3      <rdkit.Chem.rdchem.Mol object at 0x7f8258bdaac0>  Yes\n",
              "4      <rdkit.Chem.rdchem.Mol object at 0x7f8258bda350>  Yes\n",
              "...                                                 ...  ...\n",
              "59525  <rdkit.Chem.rdchem.Mol object at 0x7f82577cd200>   No\n",
              "59526  <rdkit.Chem.rdchem.Mol object at 0x7f82577cd270>   No\n",
              "59527  <rdkit.Chem.rdchem.Mol object at 0x7f82577cd2e0>   No\n",
              "59528  <rdkit.Chem.rdchem.Mol object at 0x7f82577cd350>   No\n",
              "59529  <rdkit.Chem.rdchem.Mol object at 0x7f82577cd3c0>   No\n",
              "\n",
              "[59530 rows x 2 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-8c0f211a-a845-42f4-abce-818e20cf9027\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>mol</th>\n",
              "      <th>hit</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f8258bda970&gt;</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f8258bda9e0&gt;</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f8258bdaa50&gt;</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f8258bdaac0&gt;</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f8258bda350&gt;</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59525</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f82577cd200&gt;</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59526</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f82577cd270&gt;</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59527</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f82577cd2e0&gt;</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59528</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f82577cd350&gt;</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59529</th>\n",
              "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f82577cd3c0&gt;</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>59530 rows × 2 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8c0f211a-a845-42f4-abce-818e20cf9027')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-8c0f211a-a845-42f4-abce-818e20cf9027 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-8c0f211a-a845-42f4-abce-818e20cf9027');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 17
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#dchm= axl[\"Smiles\"]\n",
        "#dchm\n",
        "dpchm[\"Target\"] = np.where(dpchm[\"hit\"]== \"Yes\", 1,0)\n",
        "dpchm[\"Target\"].value_counts()\n",
        "\n",
        "dchm= dpchm[\"mol\"]\n",
        "dchm"
      ],
      "metadata": {
        "id": "8LN7BRQlnnyH",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "c0e0d2a4-9c64-4e73-dc4f-e65ba7744dd7"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0        <rdkit.Chem.rdchem.Mol object at 0x7f8258bda970>\n",
              "1        <rdkit.Chem.rdchem.Mol object at 0x7f8258bda9e0>\n",
              "2        <rdkit.Chem.rdchem.Mol object at 0x7f8258bdaa50>\n",
              "3        <rdkit.Chem.rdchem.Mol object at 0x7f8258bdaac0>\n",
              "4        <rdkit.Chem.rdchem.Mol object at 0x7f8258bda350>\n",
              "                               ...                       \n",
              "59525    <rdkit.Chem.rdchem.Mol object at 0x7f82577cd200>\n",
              "59526    <rdkit.Chem.rdchem.Mol object at 0x7f82577cd270>\n",
              "59527    <rdkit.Chem.rdchem.Mol object at 0x7f82577cd2e0>\n",
              "59528    <rdkit.Chem.rdchem.Mol object at 0x7f82577cd350>\n",
              "59529    <rdkit.Chem.rdchem.Mol object at 0x7f82577cd3c0>\n",
              "Name: mol, Length: 59530, dtype: object"
            ]
          },
          "metadata": {},
          "execution_count": 18
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# MACCSKeysFingerprint"
      ],
      "metadata": {
        "id": "wVrxUD324-f4"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install deepchem"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "379631c9-6036-4a6f-a8b8-bc86665cc30a",
        "id": "3UwaRovr4-f4"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n",
            "Requirement already satisfied: deepchem in /usr/local/lib/python3.9/dist-packages (2.7.1)\n",
            "Requirement already satisfied: numpy>=1.21 in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.22.4)\n",
            "Requirement already satisfied: rdkit in /usr/local/lib/python3.9/dist-packages (from deepchem) (2022.9.5)\n",
            "Requirement already satisfied: joblib in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.1.1)\n",
            "Requirement already satisfied: pandas in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.4.4)\n",
            "Requirement already satisfied: scikit-learn in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.2.2)\n",
            "Requirement already satisfied: scipy<1.9 in /usr/local/lib/python3.9/dist-packages (from deepchem) (1.8.1)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.9/dist-packages (from pandas->deepchem) (2022.7.1)\n",
            "Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.9/dist-packages (from pandas->deepchem) (2.8.2)\n",
            "Requirement already satisfied: Pillow in /usr/local/lib/python3.9/dist-packages (from rdkit->deepchem) (8.4.0)\n",
            "Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->deepchem) (3.1.0)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.9/dist-packages (from python-dateutil>=2.8.1->pandas->deepchem) (1.15.0)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import deepchem as dc\n",
        "from deepchem.feat import MACCSKeysFingerprint\n",
        "#mols = [Chem.MolFromSmiles(x) for x in dchm]\n",
        "featurizer = MACCSKeysFingerprint()\n",
        "maccs = featurizer.featurize(dchm)\n",
        "maccs"
      ],
      "metadata": {
        "id": "WOxXQ1shn7dl",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "86c536e1-68c9-4bfb-9316-e61a7affdc50"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       ...,\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0],\n",
              "       [0, 0, 0, ..., 1, 1, 0]])"
            ]
          },
          "metadata": {},
          "execution_count": 20
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#Split\n",
        "\n",
        "Xt = np.array(maccs)\n",
        "Yt = np.array(list(axl[\"Target\"]))\n",
        "print(\"Input\",Xt[0])\n",
        "print(\"Target\",Yt[0])\n",
        "\n",
        "#Split\n",
        "from sklearn.model_selection import train_test_split\n",
        "Xt_train, Xt_test = train_test_split(Xt, test_size=0.2)\n",
        "Yt_train, Yt_test = train_test_split(Yt, test_size=0.2)\n",
        "\n",
        "y_true= Yt_test\n",
        "\n",
        "Yt_train = keras.utils.to_categorical(Yt_train)\n",
        "Yt_test = keras.utils.to_categorical(Yt_test)\n",
        "\n",
        "print(\"Input\",Xt_train[0])\n",
        "print(\"Target\",Yt_train[0])\n",
        "print(\"Xt-train input shape:\", Xt_train.shape)\n",
        "print(\"Yt-train label shape:\", Yt_train.shape)\n",
        "# print(Xt_train.shape)"
      ],
      "metadata": {
        "id": "zN3AE1njoKnX",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "6e5b9c64-1177-4125-a8c2-75f4559759e9"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 1 0\n",
            " 0 1 0 0 0 1 0 0 0 0 0 1 1 1 0 0 1 1 0 0 0 1 0 1 1 0 1 0 0 0 1 0 0 1 1 0 0\n",
            " 1 1 1 0 1 1 0 1 0 1 1 1 0 0 1 1 1 1 1 0 0 1 0 1 0 0 1 1 1 0 0 1 1 1 1 0 1\n",
            " 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0]\n",
            "Target 1\n",
            "Input [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            " 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0\n",
            " 1 0 0 1 0 1 0 0 0 1 0 1 1 0 0 0 0 0 0 1 0 0 1 0 0 0 1 1 0 0 0 1 1 1 0 0 0\n",
            " 1 1 0 0 1 1 0 1 0 1 1 1 1 0 1 0 0 0 1 0 1 0 0 1 0 0 1 1 1 0 1 1 0 0 1 0 1\n",
            " 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\n",
            "Target [0. 1.]\n",
            "Xt-train input shape: (47624, 167)\n",
            "Yt-train label shape: (47628, 2)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###check to see if hits are in correct places\n",
        "maccs[0:4]\n",
        "Yt[0:4]\n",
        "maccs[9887:9890]\n",
        "Yt[9887:9890]"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "dd0744ae-d7eb-4263-8a20-7b79bc74844f",
        "id": "FWf3AC68ArvO"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([1, 1, 1])"
            ]
          },
          "metadata": {},
          "execution_count": 22
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df=[]\n",
        "df = pd.DataFrame(maccs)\n",
        "#df[\"Target\"]= sxl[\"Target\"]\n",
        "df"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 423
        },
        "outputId": "8d6c097d-7b7d-4632-aaff-9aeaabdf91e8",
        "id": "FJWGJ7bqArvv"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "       0    1    2    3    4    5    6    7    8    9    ...  157  158  159  \\\n",
              "0        0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "1        0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "2        0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "3        0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "4        0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "...    ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...   \n",
              "59525    0    0    0    0    0    0    0    0    0    0  ...    1    1    1   \n",
              "59526    0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "59527    0    0    0    0    0    0    0    0    0    0  ...    0    1    1   \n",
              "59528    0    0    0    0    0    0    0    0    0    0  ...    1    1    0   \n",
              "59529    0    0    0    0    0    0    0    0    0    0  ...    0    1    0   \n",
              "\n",
              "       160  161  162  163  164  165  166  \n",
              "0        1    1    1    1    1    1    0  \n",
              "1        1    1    1    1    1    1    0  \n",
              "2        1    1    1    1    1    1    0  \n",
              "3        1    1    1    1    0    1    0  \n",
              "4        1    1    1    1    1    1    0  \n",
              "...    ...  ...  ...  ...  ...  ...  ...  \n",
              "59525    0    1    1    1    1    1    0  \n",
              "59526    1    1    1    1    0    1    0  \n",
              "59527    0    1    1    1    1    1    0  \n",
              "59528    1    1    1    1    1    1    0  \n",
              "59529    1    1    1    1    1    1    0  \n",
              "\n",
              "[59530 rows x 167 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-8631f5ab-3748-4cd6-8a9d-3da3c7d03af6\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "      <th>1</th>\n",
              "      <th>2</th>\n",
              "      <th>3</th>\n",
              "      <th>4</th>\n",
              "      <th>5</th>\n",
              "      <th>6</th>\n",
              "      <th>7</th>\n",
              "      <th>8</th>\n",
              "      <th>9</th>\n",
              "      <th>...</th>\n",
              "      <th>157</th>\n",
              "      <th>158</th>\n",
              "      <th>159</th>\n",
              "      <th>160</th>\n",
              "      <th>161</th>\n",
              "      <th>162</th>\n",
              "      <th>163</th>\n",
              "      <th>164</th>\n",
              "      <th>165</th>\n",
              "      <th>166</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59525</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59526</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59527</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59528</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>59529</th>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>59530 rows × 167 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8631f5ab-3748-4cd6-8a9d-3da3c7d03af6')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-8631f5ab-3748-4cd6-8a9d-3da3c7d03af6 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-8631f5ab-3748-4cd6-8a9d-3da3c7d03af6');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 23
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "dpchm['hit']"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "XIm1AgWrBmg7",
        "outputId": "0cfbc112-7527-48f6-ad67-fb62e61fc616"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0        Yes\n",
              "1        Yes\n",
              "2        Yes\n",
              "3        Yes\n",
              "4        Yes\n",
              "        ... \n",
              "59525     No\n",
              "59526     No\n",
              "59527     No\n",
              "59528     No\n",
              "59529     No\n",
              "Name: hit, Length: 59530, dtype: object"
            ]
          },
          "metadata": {},
          "execution_count": 24
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "Xt_train, Xt_test, Yt_train, Yt_test = train_test_split(df, dpchm['hit'],test_size=0.2, random_state=42)"
      ],
      "metadata": {
        "id": "phjij2ycArvw"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "QfxdrvcHyUYp"
      },
      "outputs": [],
      "source": [
        "######################################################################XGBoost (https://www.analyticsvidhya.com/blog/2020/07/10-techniques-to-deal-with-class-imbalance-in-machine-learning/)\n",
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "\n",
        "xgbc = GradientBoostingClassifier()\n",
        "\n",
        "# fit the predictor and target\n",
        "xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "xgbc_predict = xgbc.predict(Xt_test)# check performance\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "8931bccf-a97d-423a-97d7-2f37d3439d8a",
        "id": "XWWGcBpeyUYr"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content\n",
            "0.9032420628254662\n"
          ]
        }
      ],
      "source": [
        "# Save Model Using joblib\n",
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "%cd /content/\n",
        "# save the model to disk\n",
        "filename = 'asexualsXGBoost_UMACCS_model.sav'\n",
        "joblib.dump(xgbc, filename)\n",
        " \n",
        "# some time later...\n",
        " \n",
        "# load the model from disk\n",
        "loaded_model = joblib.load(filename)\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "teWNbQ74yUYs"
      },
      "outputs": [],
      "source": [
        "!cp 'asexualsXGBoost_UMACCS_model.sav' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "44a9b357-5cb7-4dd2-e725-07168b76df45",
        "id": "l7mQ-SpZyUYs"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/drive/MyDrive/PhD/XGBoost_MACCS\n",
            " asexualsXGBoost_UMACCS_model.sav\n",
            " sexualsXGBoostHPTFInal_UMACCS_model.sav\n",
            " sexualsXGBoost_UMACCS_model.sav\n",
            "'sxl_UnderMACCS_XGB_HPT_FeatureImp (1).csv'\n",
            " sxl_UnderMACCS_XGB_HPT_FeatureImp.csv\n"
          ]
        }
      ],
      "source": [
        "###Import model\n",
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/XGBoost_MACCS\n",
        "!ls '/content/drive/MyDrive/PhD/XGBoost_MACCS'"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "84ed926a-5ed9-4f4d-a624-37400f208e2e",
        "id": "VuXA73QDyUYs"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.9032420628254662\n"
          ]
        }
      ],
      "source": [
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "# load the model from disk\n",
        "loaded_model = joblib.load('/content/drive/MyDrive/PhD/XGBoost_MACCS/asexualsXGBoost_UMACCS_model.sav')\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "xgbc_predict= np.where(xgbc_predict== \"Yes\", 1,0)\n",
        "Yt_test= np.where(Yt_test== \"Yes\", 1,0)"
      ],
      "metadata": {
        "id": "YiwXQGL2hlf7"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "xgbc_predict\n",
        "Yt_test"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Lr1Rlh9whCx1",
        "outputId": "f59a349f-1f5f-4607-9a9c-8f7ac5a9fa6f"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([0, 1, 0, ..., 1, 0, 1])"
            ]
          },
          "metadata": {},
          "execution_count": 29
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "7fb0f187-f4ec-42b3-e73c-cd46c5fdb70d",
        "id": "sQhwcyTyyUYs"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.903242\n",
            "Recall 0.891650\n",
            "precision 0.915306\n",
            "F1 score: 0.903323\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[5372,  498],\n",
              "       [ 654, 5382]])"
            ]
          },
          "metadata": {},
          "execution_count": 30
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgbc_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgbc_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgbc_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgbc_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgbc_predict)\n",
        "cm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "b24d59a7-6636-4f2a-8128-a44eb865fa3d",
        "id": "gu6lWkl9yUYt"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "ROCAUC score: 0.9034059696336462\n",
            "Accuracy score: 0.9032420628254662\n",
            "F1 score: 0.9033232628398791\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgbc_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgbc_predict))\n",
        "print('F1 score:',f1_score(Yt_test,xgbc_predict))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "581e657b-757b-4ce4-b862-08cb24c7e06e",
        "id": "Eh4E4JxAyUYt"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cohens kappa: 0.806517\n",
            "ROC AUC: 0.903406\n",
            "[[5372  498]\n",
            " [ 654 5382]]\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgbc_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgbc_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgbc_predict)\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 218
        },
        "outputId": "fcb52680-3db3-456a-9518-c8fb19151b29",
        "id": "hhKWhVUpyUYt"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Test Set: 11906\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "AttributeError",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-33-d39a7402854a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Test Set: {len(Xt_test)}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mYt_test\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalue_counts\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmatrix\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mAttributeError\u001b[0m: 'numpy.ndarray' object has no attribute 'value_counts'"
          ]
        }
      ],
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "eqTRJp6syUYt"
      },
      "outputs": [],
      "source": [
        "##################################################Cross validation kfold=10\n",
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "\n",
        "xgbc = GradientBoostingClassifier()\n",
        "\n",
        "# fit the predictor and target\n",
        "fit= xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "xgbc_predict = xgbc.predict(Xt_test)# check performance\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "LGA7H_jbyUYt"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(xgbc,Xt_train, Yt_train, cv=10)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "ad57a48a-5569-4429-c7a3-50a1f4ae943f",
        "id": "7lJmYppUyUYt"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.9081 accuracy with a standard deviation of 0.0030\n"
          ]
        }
      ],
      "source": [
        "print(\"%0.4f accuracy with a standard deviation of %0.4f\" % (scores.mean(), scores.std()))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "dc1034af-3d42-42af-f2b6-8a73563bb718",
        "id": "QdMXtuBHyUYt"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Accuracy: 0.966650\n",
            "Recall 0.701571\n",
            "precision 0.937063\n",
            "F1 score: 0.802395\n"
          ]
        },
        {
          "data": {
            "text/plain": [
              "array([[1779,    9],\n",
              "       [  57,  134]])"
            ]
          },
          "execution_count": 17,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgbc_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgbc_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgbc_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgbc_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgbc_predict)\n",
        "cm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "9f9ea2cc-40ef-4b9c-b940-423d820863cf",
        "id": "49nrIx_5yUYu"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "ROCAUC score: 0.8482685617906462\n",
            "Accuracy score: 0.9666498231430015\n",
            "F1 score: 0.8023952095808383\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgbc_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgbc_predict))\n",
        "print('F1 score:',f1_score(Yt_test,xgbc_predict))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "e9ce5720-1e00-4ac4-cd65-ecc695c60ecc",
        "id": "f2UKTsiHyUYu"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Cohens kappa: 0.784593\n",
            "ROC AUC: 0.848269\n",
            "[[1779    9]\n",
            " [  57  134]]\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgbc_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgbc_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgbc_predict)\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "a49de83a-2654-40c1-856b-942302eef1d9",
        "id": "s4IKLRHbyUYu"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Test Set: 1979\n",
            "0    1788\n",
            "1     191\n",
            "Name: Target, dtype: int64\n",
            "[[1779    9]\n",
            " [  57  134]]\n"
          ]
        }
      ],
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Cpi44FtFyUYu"
      },
      "source": [
        "# Hyperparameter Tuning\n",
        "\n",
        "---\n",
        "\n",
        "Random Forest Hyperparameters we’ll be Looking at:\n",
        "\n",
        "*   Number of trees (n_estimators)\n",
        "*   Number of Samples (subsample)\n",
        "*   Number of Features (max_features)\n",
        "*   Learning Rate\n",
        "*   Tree Depth (max_depth)\n",
        "---\n",
        "https://machinelearningmastery.com/gradient-boosting-machine-ensemble-in-python/\n",
        "https://www.analyticsvidhya.com/blog/2016/02/complete-guide-parameter-tuning-gradient-boosting-gbm-python/\n",
        "https://machinelearningmastery.com/gradient-boosting-with-scikit-learn-xgboost-lightgbm-and-catboost/"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "HIZ6ULanyUYu"
      },
      "outputs": [],
      "source": [
        "\n",
        "# evaluate gradient boosting algorithm for classification\n",
        "from numpy import mean\n",
        "from numpy import std\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import cross_val_score\n",
        "from sklearn.model_selection import RepeatedStratifiedKFold\n",
        "from sklearn.ensemble import GradientBoostingClassifier"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 450
        },
        "outputId": "be4996ea-423e-4f1b-c973-b16d9f28644b",
        "id": "kXkC4XGtyUYv"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">10 0.840 (0.005)\n",
            ">50 0.891 (0.005)\n",
            ">100 0.908 (0.004)\n",
            ">500 0.933 (0.004)\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "KeyboardInterrupt",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-20-8ddf8479e2a1>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     40\u001b[0m         \u001b[0;31m# evaluate the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 41\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mevaluate_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     42\u001b[0m         \u001b[0;31m# store the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     43\u001b[0m         \u001b[0mresults\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscores\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m<ipython-input-20-8ddf8479e2a1>\u001b[0m in \u001b[0;36mevaluate_model\u001b[0;34m(model, X, y)\u001b[0m\n\u001b[1;32m     29\u001b[0m         \u001b[0mcv\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mRepeatedStratifiedKFold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn_splits\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m10\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_repeats\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrandom_state\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     30\u001b[0m         \u001b[0;31m# evaluate the model and collect the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 31\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcross_val_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mscoring\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'accuracy'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcv\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     32\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mscores\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     33\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_val_score\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, error_score)\u001b[0m\n\u001b[1;32m    518\u001b[0m         \u001b[0mfit_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfit_params\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    519\u001b[0m         \u001b[0mpre_dispatch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpre_dispatch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 520\u001b[0;31m         \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    521\u001b[0m     )\n\u001b[1;32m    522\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mcv_results\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"test_score\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_validate\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, return_train_score, return_estimator, error_score)\u001b[0m\n\u001b[1;32m    281\u001b[0m             \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    282\u001b[0m         )\n\u001b[0;32m--> 283\u001b[0;31m         \u001b[0;32mfor\u001b[0m \u001b[0mtrain\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgroups\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    284\u001b[0m     )\n\u001b[1;32m    285\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m   1054\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1055\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieval_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1056\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1057\u001b[0m             \u001b[0;31m# Make sure that we get a last message telling us we are done\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1058\u001b[0m             \u001b[0melapsed_time\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_start_time\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36mretrieve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    933\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    934\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'supports_timeout'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 935\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    936\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    937\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/_parallel_backends.py\u001b[0m in \u001b[0;36mwrap_future_result\u001b[0;34m(future, timeout)\u001b[0m\n\u001b[1;32m    540\u001b[0m         AsyncResults.get from multiprocessing.\"\"\"\n\u001b[1;32m    541\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 542\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfuture\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    543\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mCfTimeoutError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    544\u001b[0m             \u001b[0;32mraise\u001b[0m \u001b[0mTimeoutError\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/concurrent/futures/_base.py\u001b[0m in \u001b[0;36mresult\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    428\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__get_result\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    429\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 430\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_condition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    431\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    432\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_state\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mCANCELLED\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mCANCELLED_AND_NOTIFIED\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/threading.py\u001b[0m in \u001b[0;36mwait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    294\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m    \u001b[0;31m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    295\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 296\u001b[0;31m                 \u001b[0mwaiter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macquire\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    297\u001b[0m                 \u001b[0mgotit\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    298\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          ]
        }
      ],
      "source": [
        "\n",
        "# explore gradient boosting number of trees effect on performance\n",
        "from numpy import mean\n",
        "from numpy import std\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import cross_val_score\n",
        "from sklearn.model_selection import RepeatedStratifiedKFold\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "from matplotlib import pyplot\n",
        " \n",
        " \n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# define number of trees to consider\n",
        "\tn_trees = [10, 50, 100, 500, 1000]\n",
        "\tfor n in n_trees:\n",
        "\t\tmodels[str(n)] = GradientBoostingClassifier(n_estimators=n)\n",
        "\treturn models\n",
        "\n",
        "\n",
        " # define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "\n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        "\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 380
        },
        "outputId": "e5906d71-1c9e-42cc-f51d-92a2a4f37cd3",
        "id": "iBZDtd9iyUYv"
      },
      "outputs": [
        {
          "output_type": "error",
          "ename": "KeyboardInterrupt",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-22-08f84213023d>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     26\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     27\u001b[0m         \u001b[0;31m# evaluate the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 28\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mevaluate_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     29\u001b[0m         \u001b[0;31m# store the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     30\u001b[0m         \u001b[0mresults\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscores\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m<ipython-input-22-08f84213023d>\u001b[0m in \u001b[0;36mevaluate_model\u001b[0;34m(model, X, y)\u001b[0m\n\u001b[1;32m     14\u001b[0m         \u001b[0mcv\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mRepeatedStratifiedKFold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn_splits\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m10\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_repeats\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrandom_state\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     15\u001b[0m         \u001b[0;31m# evaluate the model and collect the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 16\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcross_val_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mscoring\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'accuracy'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcv\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     17\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mscores\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     18\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_val_score\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, error_score)\u001b[0m\n\u001b[1;32m    518\u001b[0m         \u001b[0mfit_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfit_params\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    519\u001b[0m         \u001b[0mpre_dispatch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpre_dispatch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 520\u001b[0;31m         \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    521\u001b[0m     )\n\u001b[1;32m    522\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mcv_results\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"test_score\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_validate\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, return_train_score, return_estimator, error_score)\u001b[0m\n\u001b[1;32m    281\u001b[0m             \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    282\u001b[0m         )\n\u001b[0;32m--> 283\u001b[0;31m         \u001b[0;32mfor\u001b[0m \u001b[0mtrain\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgroups\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    284\u001b[0m     )\n\u001b[1;32m    285\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m   1054\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1055\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieval_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1056\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1057\u001b[0m             \u001b[0;31m# Make sure that we get a last message telling us we are done\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1058\u001b[0m             \u001b[0melapsed_time\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_start_time\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36mretrieve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    933\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    934\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'supports_timeout'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 935\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    936\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    937\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/_parallel_backends.py\u001b[0m in \u001b[0;36mwrap_future_result\u001b[0;34m(future, timeout)\u001b[0m\n\u001b[1;32m    540\u001b[0m         AsyncResults.get from multiprocessing.\"\"\"\n\u001b[1;32m    541\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 542\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfuture\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    543\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mCfTimeoutError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    544\u001b[0m             \u001b[0;32mraise\u001b[0m \u001b[0mTimeoutError\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/concurrent/futures/_base.py\u001b[0m in \u001b[0;36mresult\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    428\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__get_result\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    429\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 430\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_condition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    431\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    432\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_state\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mCANCELLED\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mCANCELLED_AND_NOTIFIED\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/threading.py\u001b[0m in \u001b[0;36mwait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    294\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m    \u001b[0;31m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    295\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 296\u001b[0;31m                 \u001b[0mwaiter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macquire\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    297\u001b[0m                 \u001b[0mgotit\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    298\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          ]
        }
      ],
      "source": [
        "\n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# explore sample ratio from 10% to 100% in 10% increments\n",
        "\tfor i in (0.1, 1.1, 0.1):\n",
        "\t\tkey = '%.1f' % i\n",
        "\t\tmodels[key] = GradientBoostingClassifier(subsample=i, n_estimators=500)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        " # define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 466
        },
        "outputId": "bb73484d-2164-4597-d254-b756847e205e",
        "id": "RS_M0VwKyUYv"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">1 0.963 (0.019)\n",
            ">2 0.935 (0.094)\n",
            ">3 0.953 (0.047)\n",
            ">4 0.916 (0.098)\n",
            ">5 0.898 (0.109)\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "KeyboardInterrupt",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-19-42d68f428fb7>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     25\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     26\u001b[0m         \u001b[0;31m# evaluate the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 27\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mevaluate_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     28\u001b[0m         \u001b[0;31m# store the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     29\u001b[0m         \u001b[0mresults\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscores\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m<ipython-input-19-42d68f428fb7>\u001b[0m in \u001b[0;36mevaluate_model\u001b[0;34m(model, X, y)\u001b[0m\n\u001b[1;32m     13\u001b[0m         \u001b[0mcv\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mRepeatedStratifiedKFold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn_splits\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m10\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_repeats\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrandom_state\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     14\u001b[0m         \u001b[0;31m# evaluate the model and collect the results\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 15\u001b[0;31m         \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcross_val_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mscoring\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'accuracy'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcv\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     16\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mscores\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     17\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_val_score\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, error_score)\u001b[0m\n\u001b[1;32m    518\u001b[0m         \u001b[0mfit_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfit_params\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    519\u001b[0m         \u001b[0mpre_dispatch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpre_dispatch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 520\u001b[0;31m         \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    521\u001b[0m     )\n\u001b[1;32m    522\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mcv_results\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"test_score\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_validation.py\u001b[0m in \u001b[0;36mcross_validate\u001b[0;34m(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, return_train_score, return_estimator, error_score)\u001b[0m\n\u001b[1;32m    281\u001b[0m             \u001b[0merror_score\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merror_score\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    282\u001b[0m         )\n\u001b[0;32m--> 283\u001b[0;31m         \u001b[0;32mfor\u001b[0m \u001b[0mtrain\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgroups\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    284\u001b[0m     )\n\u001b[1;32m    285\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m   1054\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1055\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieval_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1056\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1057\u001b[0m             \u001b[0;31m# Make sure that we get a last message telling us we are done\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1058\u001b[0m             \u001b[0melapsed_time\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_start_time\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36mretrieve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    933\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    934\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'supports_timeout'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 935\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    936\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    937\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/_parallel_backends.py\u001b[0m in \u001b[0;36mwrap_future_result\u001b[0;34m(future, timeout)\u001b[0m\n\u001b[1;32m    540\u001b[0m         AsyncResults.get from multiprocessing.\"\"\"\n\u001b[1;32m    541\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 542\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfuture\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    543\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mCfTimeoutError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    544\u001b[0m             \u001b[0;32mraise\u001b[0m \u001b[0mTimeoutError\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/concurrent/futures/_base.py\u001b[0m in \u001b[0;36mresult\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    428\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__get_result\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    429\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 430\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_condition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    431\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    432\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_state\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mCANCELLED\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mCANCELLED_AND_NOTIFIED\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/threading.py\u001b[0m in \u001b[0;36mwait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    294\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m    \u001b[0;31m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    295\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 296\u001b[0;31m                 \u001b[0mwaiter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macquire\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    297\u001b[0m                 \u001b[0mgotit\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    298\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          ]
        }
      ],
      "source": [
        "\n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# explore number of features from 1 to 20\n",
        "\tfor i in range(1,21):\n",
        "\t\tmodels[str(i)] = GradientBoostingClassifier(max_features=i, subsample=0.1, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        " # define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "rfCEkt-XyUYv"
      },
      "outputs": [],
      "source": [
        " \n",
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# define learning rates to explore\n",
        "\tfor i in [0.0001, 0.001, 0.01, 0.1, 1.0]:\n",
        "\t\tkey = '%.4f' % i\n",
        "\t\tmodels[key] = GradientBoostingClassifier(learning_rate=i, max_features=i, subsample=0.1, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        " # define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "nciC1bsjyUYv"
      },
      "outputs": [],
      "source": [
        "# get a list of models to evaluate\n",
        "def get_models():\n",
        "\tmodels = dict()\n",
        "\t# define max tree depths to explore between 1 and 10\n",
        "\tfor i in range(1,11):\n",
        "\t\tmodels[str(i)] = GradientBoostingClassifier(max_depth=i, learning_rate=i, max_features=i, subsample=0.1, n_estimators=1000)\n",
        "\treturn models\n",
        " \n",
        "# evaluate a given model using cross-validation\n",
        "def evaluate_model(model, X, y):\n",
        "\t# define the evaluation procedure\n",
        "\tcv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
        "\t# evaluate the model and collect the results\n",
        "\tscores = cross_val_score(model, X, y, scoring='accuracy', cv=cv, n_jobs=-1)\n",
        "\treturn scores\n",
        " \n",
        " # define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "# get the models to evaluate\n",
        "models = get_models()\n",
        "# evaluate the models and store results\n",
        "results, names = list(), list()\n",
        "for name, model in models.items():\n",
        "\t# evaluate the model\n",
        "\tscores = evaluate_model(model, X, y)\n",
        "\t# store the results\n",
        "\tresults.append(scores)\n",
        "\tnames.append(name)\n",
        "\t# summarize the performance along the way\n",
        "\tprint('>%s %.3f (%.3f)' % (name, mean(scores), std(scores)))\n",
        "# plot model performance for comparison\n",
        "pyplot.boxplot(results, labels=names, showmeans=True)\n",
        "pyplot.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "9fd8a61b-1c83-4bd2-f7b1-f8fe3f7a5598",
        "id": "TeRbgnTHyUYv"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Best: 0.935999 using {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.892449 (0.002100) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.925899 (0.001743) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.935999 (0.002730) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.922665 (0.001785) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.859357 (0.015328) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 500, 'subsample': 0.1}\n",
            "0.699836 (0.037649) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n"
          ]
        }
      ],
      "source": [
        "# example of grid searching key hyperparameters for gradient boosting on a classification dataset\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import RepeatedStratifiedKFold\n",
        "from sklearn.model_selection import GridSearchCV\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "# define dataset\n",
        "X = Xt_train\n",
        "y = Yt_train\n",
        "# define the model with default hyperparameters\n",
        "model = GradientBoostingClassifier()\n",
        "# define the grid of values to search\n",
        "grid = dict()\n",
        "grid['n_estimators'] = [ 500]\n",
        "grid['learning_rate'] = [ 0.01, 0.1]\n",
        "grid['subsample'] = [0.1]\n",
        "grid['max_depth'] = [3, 7, 9]\n",
        "# define the evaluation procedure\n",
        "cv = RepeatedStratifiedKFold(n_splits=2, n_repeats=1, random_state=1)\n",
        "# define the grid search procedure\n",
        "grid_search = GridSearchCV(estimator=model, param_grid=grid, n_jobs=-1, cv=cv, scoring='accuracy')\n",
        "# execute the grid search\n",
        "grid_result = grid_search.fit(X, y)\n",
        "# summarize the best score and configuration\n",
        "print(\"Best: %f using %s\" % (grid_result.best_score_, grid_result.best_params_))\n",
        "# summarize all scores that were evaluated\n",
        "means = grid_result.cv_results_['mean_test_score']\n",
        "stds = grid_result.cv_results_['std_test_score']\n",
        "params = grid_result.cv_results_['params']\n",
        "for mean, stdev, param in zip(means, stds, params):\n",
        "    print(\"%f (%f) with: %r\" % (mean, stdev, param))"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "# Best: 0.969877 using {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
        "xgbc = GradientBoostingClassifier( learning_rate=0.01, subsample=0.1, n_estimators=500, max_depth= 9)\n",
        "\n",
        "# fit the predictor and target\n",
        "xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "gbm_predict = xgbc.predict(Xt_test)# check performance"
      ],
      "metadata": {
        "id": "sW6gXwF9ZFjj"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "gbm_predict= np.where(gbm_predict== \"Yes\", 1,0)\n",
        "Yt_test= np.where(Yt_test== \"Yes\", 1,0)"
      ],
      "metadata": {
        "id": "DyTIJJLEaYkO"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,gbm_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,gbm_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,gbm_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,gbm_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,gbm_predict)\n",
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, gbm_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, gbm_predict))\n",
        "print('F1 score:',f1_score(Yt_test, gbm_predict))\n",
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, gbm_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, gbm_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, gbm_predict)\n",
        "print(matrix)\n",
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(xgbc,Xt_train, Yt_train, cv=10)\n",
        "\n",
        "print(\"%0.2f accuracy with a standard deviation of %0.2f\" % (scores.mean(), scores.std()))\n",
        "print(scores.mean())\n",
        "print(scores.std())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "90415a9d-ec6f-47d1-e012-3049cf6c3359",
        "id": "Xrxk_hmJZFjj"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.941206\n",
            "Recall 0.926441\n",
            "precision 0.956224\n",
            "F1 score: 0.941097\n",
            "ROCAUC score: 0.9414148837807906\n",
            "Accuracy score: 0.9412061145640853\n",
            "F1 score: 0.9410972736452372\n",
            "Cohens kappa: 0.882441\n",
            "ROC AUC: 0.941415\n",
            "[[5614  256]\n",
            " [ 444 5592]]\n",
            "0.94 accuracy with a standard deviation of 0.00\n",
            "0.942613015260165\n",
            "0.0021048002663797438\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Save Model Using joblib\n",
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "%cd /content/\n",
        "# save the model to disk\n",
        "filename = 'asexualsGBM_HPTFInal_UMACCS_model.pkl'\n",
        "joblib.dump(xgbc, filename)\n",
        " \n",
        "# some time later...\n",
        "Yt_test= np.where(Yt_test== 1, \"Yes\",\"No\")\n",
        "# load the model from disk\n",
        "loaded_model = joblib.load(filename)\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "777b80cb-5799-4425-e4c0-33710cdf993b",
        "id": "j8tlkmucZFjj"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content\n",
            "0.9412061145640853\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "1KCyA5yQZFjk"
      },
      "outputs": [],
      "source": [
        "!cp 'asexualsGBM_HPTFInal_UMACCS_model.pkl' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#Feature Importance\n",
        "---\n",
        "\n",
        "https://scikit-learn.org/stable/modules/permutation_importance.html#permutation-importance\n",
        "https://scikit-learn.org/stable/auto_examples/ensemble/plot_gradient_boosting_regression.html\n"
      ],
      "metadata": {
        "id": "54ph6hAAyUYw"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# load library\n",
        "from sklearn.ensemble import GradientBoostingClassifier\n",
        "# Best: 0.935999 using {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 500, 'subsample': 0.1}\n",
        "xgbc = GradientBoostingClassifier( learning_rate=0.01, subsample=0.1, n_estimators=500, max_depth= 9)\n",
        "\n",
        "# fit the predictor and target\n",
        "xgbc.fit(Xt_train, Yt_train)\n",
        "\n",
        "# predict\n",
        "xgbc_predict = xgbc.predict(Xt_test)# check performance"
      ],
      "metadata": {
        "id": "6N6iOIp4yUYw"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "xgbc_predict= np.where(xgbc_predict== \"Yes\", 1,0)\n",
        "Yt_test= np.where(Yt_test== \"Yes\", 1,0)"
      ],
      "metadata": {
        "id": "xxOrPeJh_2FI"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "xgbc_predict\n",
        "Yt_test"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "lchpKLwI_FRM",
        "outputId": "53e842c8-92f0-4647-ec57-42adf3f51c28"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([0, 1, 0, ..., 1, 0, 1])"
            ]
          },
          "metadata": {},
          "execution_count": 37
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "7040d75d-f67a-4071-8653-a5bf976abfbc",
        "id": "MDyHnydVyUYw"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content\n",
            "0.9422140097429867\n"
          ]
        }
      ],
      "source": [
        "# Save Model Using joblib\n",
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "%cd /content/\n",
        "# save the model to disk\n",
        "filename = 'asexualsGBoostHPTFInal_UMACCS_model.sav'\n",
        "joblib.dump(xgbc, filename)\n",
        " \n",
        "# some time later...\n",
        " \n",
        "# load the model from disk\n",
        "loaded_model = joblib.load(filename)\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "N_eLP6E1yUYw"
      },
      "outputs": [],
      "source": [
        "!cp 'asexualsGBoostHPTFInal_UMACCS_model.sav' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "1e6b7e39-62d4-4829-8198-58b434c7e13d",
        "id": "kKkHdNXyyUYw"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/drive/MyDrive/PhD/XGBoost_MACCS\n",
            "sexualsXGBoostHPTFInal_UMACCS_model.sav  sxl_UnderMACCS_XGB_HPT_FeatureImp.csv\n",
            "sexualsXGBoost_UMACCS_model.sav\n"
          ]
        }
      ],
      "source": [
        "###Import model\n",
        "#Optional: move to the desired location:\n",
        "%cd /content/drive/MyDrive/PhD/XGBoost_MACCS\n",
        "!ls '/content/drive/MyDrive/PhD/XGBoost_MACCS'"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "a270fb1a-5f47-44ba-89bf-6819e903b16a",
        "id": "nJv2FgEQyUYw"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.9422140097429867\n"
          ]
        }
      ],
      "source": [
        "import pandas\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "import joblib\n",
        "\n",
        "# load the model from disk\n",
        "loaded_model = joblib.load('/content/drive/MyDrive/PhD/XGBoost_MACCS/asexualsGBoostHPTFInal_UMACCS_model.sav')\n",
        "result = loaded_model.score(Xt_test, Yt_test)\n",
        "print(result)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "mURQ6LBAyUYw"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import cross_val_score\n",
        "scores = cross_val_score(xgbc,Xt_train, Yt_train, cv=10)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "af1db2da-cac0-4ec9-8f21-42409c10398d",
        "id": "dXYFrlkRyUYx"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.94 accuracy with a standard deviation of 0.00\n",
            "0.9432849841848429\n",
            "0.0027284821085352827\n"
          ]
        }
      ],
      "source": [
        "print(\"%0.2f accuracy with a standard deviation of %0.2f\" % (scores.mean(), scores.std()))\n",
        "print(scores.mean())\n",
        "print(scores.std())"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "bc7e0b72-2d80-408d-f624-4da3adaafc76",
        "id": "hK1C9LmsyUYx"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.942214\n",
            "Recall 0.926773\n",
            "precision 0.957877\n",
            "F1 score: 0.942068\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([[5624,  246],\n",
              "       [ 442, 5594]])"
            ]
          },
          "metadata": {},
          "execution_count": 38
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score\n",
        "# accuracy: (tp + tn) / (p + n)\n",
        "accuracy = accuracy_score(Yt_test,xgbc_predict)\n",
        "print('Accuracy: %f' % accuracy)\n",
        "recall= recall_score(Yt_test,xgbc_predict)\n",
        "print(\"Recall %f\" % recall)\n",
        "precision= precision_score(Yt_test,xgbc_predict)\n",
        "print(\"precision %f\" % precision)\n",
        "# f1: 2 tp / (2 tp + fp + fn)\n",
        "f1 = f1_score(Yt_test,xgbc_predict)\n",
        "print('F1 score: %f' % f1)\n",
        "cm= confusion_matrix(Yt_test,xgbc_predict)\n",
        "cm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "b0d4f934-576e-4587-df6c-1d4b71c324d5",
        "id": "D9Im5hMuyUYx"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "ROCAUC score: 0.9424323451680604\n",
            "Accuracy score: 0.9422140097429867\n",
            "F1 score: 0.9420680363758842\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score\n",
        "print('ROCAUC score:',roc_auc_score(Yt_test, xgbc_predict))\n",
        "print('Accuracy score:',accuracy_score(Yt_test, xgbc_predict))\n",
        "print('F1 score:',f1_score(Yt_test,xgbc_predict))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "a18f91bd-3039-489c-9c3d-4ac10152a624",
        "id": "Tz9dh5dQyUYx"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cohens kappa: 0.884459\n",
            "ROC AUC: 0.942432\n",
            "[[5624  246]\n",
            " [ 442 5594]]\n"
          ]
        }
      ],
      "source": [
        "from sklearn.metrics import recall_score, precision_recall_curve,precision_score, confusion_matrix, accuracy_score, f1_score, roc_auc_score, cohen_kappa_score\n",
        "# kappa\n",
        "kappa = cohen_kappa_score(Yt_test, xgbc_predict)\n",
        "print('Cohens kappa: %f' % kappa)\n",
        "# ROC AUC\n",
        "auc = roc_auc_score(Yt_test, xgbc_predict)\n",
        "print('ROC AUC: %f' % auc)\n",
        "# confusion matrix\n",
        "matrix = confusion_matrix(Yt_test, xgbc_predict)\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 217
        },
        "outputId": "c5307330-3977-4132-e522-08b7168d65d1",
        "id": "aBZpOatPyUYx"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Test Set: 11906\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "AttributeError",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-42-d39a7402854a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Test Set: {len(Xt_test)}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mYt_test\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalue_counts\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmatrix\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mAttributeError\u001b[0m: 'numpy.ndarray' object has no attribute 'value_counts'"
          ]
        }
      ],
      "source": [
        "print(f\"Test Set: {len(Xt_test)}\")\n",
        "print(Yt_test.value_counts())\n",
        "print(matrix)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import matplotlib.pyplot as plt\n",
        "plt.rcParams[\"figure.figsize\"] = (35,10)"
      ],
      "metadata": {
        "id": "wgp7ccnLyUYx"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# feature importance\n",
        "import matplotlib.pyplot as pyplot\n",
        "print(xgbc.feature_importances_)\n",
        "# plot\n",
        "pyplot.bar(range(len(xgbc.feature_importances_)), xgbc.feature_importances_)\n",
        "plt.xticks([x for x in range(len(xgbc.feature_importances_))], rotation=90)\n",
        "pyplot.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "outputId": "7bf61436-4d96-4eec-bb83-7aee1e8d8a0b",
        "id": "imyk5goEyUYx"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[0.00000000e+00 0.00000000e+00 0.00000000e+00 3.58832528e-07\n",
            " 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00\n",
            " 7.21761492e-04 0.00000000e+00 0.00000000e+00 1.51253923e-03\n",
            " 0.00000000e+00 7.63899824e-04 2.60572295e-04 2.89043385e-09\n",
            " 1.21974647e-05 8.56051944e-04 2.89588127e-09 3.81985306e-03\n",
            " 3.14551654e-07 3.35426968e-05 5.02068674e-03 2.33392892e-03\n",
            " 1.65898409e-03 7.06085542e-03 1.41195303e-04 8.10553472e-04\n",
            " 2.17000652e-03 6.64724576e-04 1.61324261e-04 5.70934988e-08\n",
            " 1.22134795e-03 1.62978719e-03 8.32208692e-04 5.66135191e-07\n",
            " 3.75715427e-03 4.67474390e-03 5.00565724e-03 1.93138017e-05\n",
            " 3.97850057e-04 4.22995138e-03 4.36743204e-03 2.03367918e-03\n",
            " 2.09568782e-06 1.50238401e-03 2.83314490e-03 5.80551954e-03\n",
            " 1.35920153e-04 6.40324564e-03 1.28157455e-03 7.67085110e-04\n",
            " 9.49471690e-03 6.09010325e-03 2.71087051e-03 5.43417744e-04\n",
            " 3.07759460e-04 6.07460249e-03 7.65202757e-04 5.49671821e-03\n",
            " 4.56454163e-04 7.41938676e-04 1.33751630e-02 3.54909340e-04\n",
            " 2.34411756e-03 1.36674847e-02 3.94779528e-03 7.65480231e-04\n",
            " 2.14489376e-03 4.03611040e-03 1.75261665e-03 1.86425317e-03\n",
            " 3.21512136e-03 9.36639111e-04 3.73091465e-03 3.74234654e-03\n",
            " 1.18247111e-03 6.58209492e-03 1.70267706e-03 6.82639634e-03\n",
            " 5.33559004e-03 3.15802982e-03 9.40444531e-03 4.12336736e-03\n",
            " 7.65675923e-03 3.48683222e-03 3.65389755e-02 2.80393192e-03\n",
            " 1.83814590e-03 4.39685000e-03 5.60443838e-03 6.20498467e-03\n",
            " 3.86185279e-03 6.80754868e-03 3.71412906e-03 5.48458905e-03\n",
            " 4.33745219e-03 5.94483407e-03 1.41369768e-02 2.25526350e-02\n",
            " 1.94544399e-02 1.51217444e-02 1.26145741e-03 1.36027692e-02\n",
            " 5.11470405e-03 5.74973962e-03 5.72036601e-03 1.64277080e-03\n",
            " 4.32864143e-03 3.92495488e-03 3.76357590e-03 7.50372543e-03\n",
            " 4.66132565e-03 6.51533967e-03 7.59777873e-03 5.40028302e-03\n",
            " 4.52402132e-03 1.32416491e-02 2.80225506e-03 1.68650490e-02\n",
            " 4.77912167e-03 1.81786497e-03 2.04674795e-03 5.21600387e-03\n",
            " 6.79500776e-03 2.88152244e-02 4.96845400e-03 2.73173593e-03\n",
            " 5.34471388e-03 1.21318825e-02 1.87076964e-03 4.87650856e-02\n",
            " 1.41979368e-02 1.22865255e-02 3.60436453e-02 8.75879008e-03\n",
            " 3.56680344e-03 1.57899303e-03 6.69237914e-03 4.62585964e-03\n",
            " 8.36344220e-03 6.97970845e-03 3.39327486e-03 2.56647990e-03\n",
            " 5.53359212e-03 1.64302269e-01 4.23021455e-03 3.42579407e-03\n",
            " 3.30007657e-03 4.96875302e-03 5.69478206e-03 7.43501535e-03\n",
            " 9.62599224e-03 4.98546569e-03 3.85141846e-03 6.01055324e-03\n",
            " 4.01264371e-03 3.27429483e-03 2.61439394e-03 4.67541364e-03\n",
            " 3.77174282e-03 5.73451232e-04 1.24059557e-03 1.02552234e-03\n",
            " 4.25951073e-03 4.13541630e-04 3.04922096e-02]\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 2520x720 with 1 Axes>"
            ],
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAB8wAAAJICAYAAAAEpx6WAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nOzdX4hn93nf8c/jncpJY2I79lJa/WEVrEA2JIRktGmhVksM7oqAthdSKzlQqRiUEHTVmHZLQXGVm7hp415EF95iN46FkYVpy4K3VYx9ESiu2bWayqwVtRtFkVYNeGIpDqoxylpPL+YnmP461p7dmfWYfV4vWDjne77n7DPXb875VXcHAAAAAAAAAKZ5y0EPAAAAAAAAAAAHQTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgpI2DHmDdu9/97j5y5MhBjwEAAAAAAADAdeArX/nKn3X34d2ufd8F8yNHjuTcuXMHPQYAAAAAAAAA14Gq+pPvds0n2QEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEbaOOgBAAAAAAAAuPaOnPzcm15//jd+4Xs0CcD3D2+YAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAw0qJgXlXHq+rZqrpQVSd3uX5HVT1VVZeq6u61a7dU1e9V1TNV9bWqOrI/owMAAAAAAADA1btsMK+qQ0keTXJnkqNJ7quqo2vbXkjyQJJP7/KI303ym93940mOJfn6XgYGAAAAAAAAgP2wsWDPsSQXuvu5JKmqx5OcSPK1NzZ09/Ora6/vvHEV1je6+/Orfa/uz9gAAAAAAAAAsDdLPsl+Y5IXd5xfXK0t8WNJ/ryq/kNV/feq+s3VG+sAAAAAAAAAcKAW/Yb5HmwkeW+SDyW5PcmPZvvT7f+Pqnqwqs5V1bmtra1rPBIAAAAAAAAALAvmLyW5ecf5Tau1JS4m+YPufq67LyX5T0l+Zn1Td5/q7s3u3jx8+PDCRwMAAAAAAADA1VsSzM8mua2qbq2qG5Lcm+T0wuefTfKOqnqjgv98dvz2OQAAAAAAAAAclMsG89Wb4Q8leTLJM0me6O7zVfVIVd2VJFV1e1VdTHJPko9V1fnVvd/J9ufYv1BVX01SSf7dtflTAAAAAAAAAGC5jSWbuvtMkjNraw/vOD6b7U+173bv55P81B5mBAAAAAAAAIB9t+ST7AAAAAAAAABw3RHMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGGlRMK+q41X1bFVdqKqTu1y/o6qeqqpLVXX3Ltd/uKouVtVv78fQAAAAAAAAALBXlw3mVXUoyaNJ7kxyNMl9VXV0bdsLSR5I8unv8phfT/L7Vz8mAAAAAAAAAOyvJW+YH0tyobuf6+7Xkjye5MTODd39fHc/neT19Zur6meT/LUkv7cP8wIAAAAAAADAvlgSzG9M8uKO84urtcuqqrck+TdJPnTlowEAAAAAAADAtbPoN8z34FeSnOnui2+2qaoerKpzVXVua2vrGo8EAAAAAAAAAMnGgj0vJbl5x/lNq7Ul/laS91bVryR5W5IbqurV7j65c1N3n0pyKkk2Nzd74bMBAAAAAAAA4KotCeZnk9xWVbdmO5Tfm+QDSx7e3b/4xnFVPZBkcz2WAwAAAAAAAMBBuOwn2bv7UpKHkjyZ5JkkT3T3+ap6pKruSpKqur2qLia5J8nHqur8tRwaAAAAAAAAAPZqyRvm6e4zSc6srT284/hstj/V/mbP+J0kv3PFEwIAAAAAAADANXDZN8wBAAAAAAAA4HokmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADDSomBeVcer6tmqulBVJ3e5fkdVPVVVl6rq7h3rP11VX6qq81X1dFX9w/0cHgAAAAAAAACu1mWDeVUdSvJokjuTHE1yX1UdXdv2QpIHknx6bf1bSf5Rd/9EkuNJ/m1VvWOvQwMAAAAAAADAXm0s2HMsyYXufi5JqurxJCeSfO2NDd39/Ora6ztv7O7/ueP4f1fV15McTvLne54cAAAAAAAAAPZgySfZb0zy4o7zi6u1K1JVx5LckOSPrvReAAAAAAAAANhvi37DfK+q6q8n+VSSf9zdr+9y/cGqOldV57a2tr4XIwEAAAAAAAAw3JJg/lKSm3ec37RaW6SqfjjJ55L8i+7+b7vt6e5T3b3Z3ZuHDx9e+mgAAAAAAAAAuGpLgvnZJLdV1a1VdUOSe5OcXvLw1f7/mOR3u/uzVz8mAAAAAAAAAOyvywbz7r6U5KEkTyZ5JskT3X2+qh6pqruSpKpur6qLSe5J8rGqOr+6/R8kuSPJA1X1B6t/P31N/hIAAAAAAAAAuAIbSzZ195kkZ9bWHt5xfDbbn2pfv++xJI/tcUYAAAAAAAAA2HdLPskOAAAAAAAAANcdwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRFgXzqjpeVc9W1YWqOrnL9Tuq6qmqulRVd69du7+q/tfq3/37NTgAAAAAAAAA7MVlg3lVHUryaJI7kxxNcl9VHV3b9kKSB5J8eu3eH0nya0l+LsmxJL9WVe/c+9gAAAAAAAAAsDdL3jA/luRCdz/X3a8leTzJiZ0buvv57n46yetr9/69JJ/v7pe7+5Ukn09yfB/mBgAAAAAAAIA9WRLMb0zy4o7zi6u1JfZyLwAAAAAAAABcM4t+w/xaq6oHq+pcVZ3b2to66HEAAAAAAAAAGGBJMH8pyc07zm9arS2x6N7uPtXdm929efjw4YWPBgAAAAAAAICrtySYn01yW1XdWlU3JLk3yemFz38yyfur6p1V9c4k71+tAQAAAAAAAMCBumww7+5LSR7Kduh+JskT3X2+qh6pqruSpKpur6qLSe5J8rGqOr+69+Ukv57t6H42ySOrNQAAAAAAAAA4UBtLNnX3mSRn1tYe3nF8NtufW9/t3k8k+cQeZgQAAAAAAACAfbfkk+wAAAAAAAAAcN0RzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhpUTCvquNV9WxVXaiqk7tcf2tVfWZ1/ctVdWS1/leq6pNV9dWqeqaq/vn+jg8AAAAAAAAAV+eywbyqDiV5NMmdSY4mua+qjq5t+2CSV7r7PUk+muQjq/V7kry1u38yyc8m+aU3YjoAAAAAAAAAHKQlb5gfS3Khu5/r7teSPJ7kxNqeE0k+uTr+bJL3VVUl6SQ/VFUbSX4wyWtJ/mJfJgcAAAAAAACAPVgSzG9M8uKO84urtV33dPelJN9M8q5sx/P/k+RPk7yQ5F9398t7nBkAAAAAAAAA9mzRb5jvwbEk30nyN5LcmuRXq+pH1zdV1YNVda6qzm1tbV3jkQAAAAAAAABgWTB/KcnNO85vWq3tumf1+fW3J/lGkg8k+S/d/Zfd/fUk/zXJ5vp/0N2nunuzuzcPHz585X8FAAAAAAAAAFyhJcH8bJLbqurWqrohyb1JTq/tOZ3k/tXx3Um+2N2d7c+w/3ySVNUPJfmbSf5wPwYHAAAAAAAAgL24bDBf/Sb5Q0meTPJMkie6+3xVPVJVd622fTzJu6rqQpJ/kuTkav3RJG+rqvPZDu//vruf3u8/AgAAAAAAAACu1MaSTd19JsmZtbWHdxx/O8k9u9z36m7rAAAAAAAAAHDQlnySHQAAAAAAAACuO4I5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIwnmAAAAAAAAAIwkmAMAAAAAAAAwkmAOAAAAAAAAwEiCOQAAAAAAAAAjCeYAAAAAAAAAjCSYAwAAAAAAADCSYA4AAAAAAADASII5AAAAAAAAACMJ5gAAAAAAAACMJJgDAAAAAAAAMJJgDgAAAAAAAMBIgjkAAAAAAAAAIy0K5lV1vKqeraoLVXVyl+tvrarPrK5/uaqO7Lj2U1X1pao6X1Vfraof2L/xAQAAAAAAAODqXDaYV9WhJI8muTPJ0ST3VdXRtW0fTPJKd78nyUeTfGR170aSx5L8cnf/RJK/m+Qv9216AAAAAAAAALhKS94wP5bkQnc/192vJXk8yYm1PSeSfHJ1/Nkk76uqSvL+JE939/9Iku7+Rnd/Z39GBwAAAAAAAICrtySY35jkxR3nF1dru+7p7ktJvpnkXUl+LElX1ZNV9VRV/dO9jwwAAAAAAAAAe7fxPXj+305ye5JvJflCVX2lu7+wc1NVPZjkwSS55ZZbrvFIAAAAAAAAALDsDfOXkty84/ym1dque1a/W/72JN/I9tvov9/df9bd30pyJsnPrP8H3X2quze7e/Pw4cNX/lcAAAAAAAAAwBVaEszPJrmtqm6tqhuS3Jvk9Nqe00nuXx3fneSL3d1Jnkzyk1X1V1ch/e8k+dr+jA4AAAAAAAAAV++yn2Tv7ktV9VC24/ehJJ/o7vNV9UiSc919OsnHk3yqqi4keTnbUT3d/UpV/Va2o3snOdPdn7tGfwsAAAAAAAAALLboN8y7+0y2P6e+c+3hHcffTnLPd7n3sSSP7WFGAAAAAAAAANh3Sz7JDgAAAAAAAADXHcEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkTYOegAAAAAAAOD/d+Tk5970+vO/8Qvfo0kA4PrlDXMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYCTBHAAAAAAAAICRBHMAAAAAAAAARhLMAQAAAAAAABhJMAcAAAAAAABgJMEcAAAAAAAAgJEEcwAAAAAAAABGEswBAAAAAAAAGEkwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYKRFwbyqjlfVs1V1oapO7nL9rVX1mdX1L1fVkbXrt1TVq1X1of0ZGwAAAAAAAAD25rLBvKoOJXk0yZ1Jjia5r6qOrm37YJJXuvs9ST6a5CNr138ryX/e+7gAAAAAAAAAsD+WvGF+LMmF7n6uu19L8niSE2t7TiT55Or4s0neV1WVJFX195P8cZLz+zMyAAAAAAAAAOzdkmB+Y5IXd5xfXK3tuqe7LyX5ZpJ3VdXbkvyzJP9y76MCAAAAAAAAwP5Z9Bvme/DhJB/t7lffbFNVPVhV56rq3NbW1jUeCQAAAAAAAACSjQV7Xkpy847zm1Zru+25WFUbSd6e5BtJfi7J3VX1r5K8I8nrVfXt7v7tnTd396kkp5Jkc3Ozr+YPAQAAAAAAAIArsSSYn01yW1Xdmu0wfm+SD6ztOZ3k/iRfSnJ3ki92dyd57xsbqurDSV5dj+UAAAAAAAAAcBAuG8y7+1JVPZTkySSHknyiu89X1SNJznX36SQfT/KpqrqQ5OVsR3UAAAAAAAAA+L615A3zdPeZJGfW1h7ecfztJPdc5hkfvor5AAAAAAAAAOCaeMtBDwAAAAAAAAAAB0EwBwAAAAAAAGAkwRwAAAAAAACAkQRzAAAAAAAAAEYSzAEAAAAAAAAYSTAHAAAAAAAAYKSNgx4AgP/b3p2Hy1LUBx//FlxArsh2QVC2iwoacBdBIwZcg5IAAXxF8yoa0cQNXpfE66sR45aLMRqNS4IsBowi8rqg4EbE1yTIorILCMIVUDSIsiRGBaz3j6rz3j51es50nzN95sz09/M89Zye7t+pqu7qqenp6umWJEmSJsPqNWfNu3zd2gOXqCaSJEmSJI2GA+aSJEmSJEmSJGkOL5aTJPWBt2SXJEmSJEmSJEmSJPWSA+aSJEmSJEmSJEmSpF5ywFySJEmSJEmSJEmS1EsOmEuSJEmSJEmSJEmSeskBc0mSJEmSJEmSJElSLzlgLkmSJEmSJEmSJEnqJQfMJUmSJEmSJEmSJEm95IC5JEmSJEmSJEmSJKmXHDCXJEmSJEmSJEmSJPWSA+aSJEmSJEmSJEmSpF5ywFySJEmSJEmSJEmS1EsOmEuSJEmSJEmSJEmSeskBc0mSJEmSJEmSJElSLzlgLkmSJEmSJEmSJEnqJQfMJUmSJEmSJEmSJEm95IC5JEmSJEmSJEmSJKmXHDCXJEmSJEmSJEmSJPXSinFXQJIkSZIkSZIkSZKm1eo1Zw2NWbf2wCWoier4C3NJkiRJkiRJkiRJUi85YC5JkiRJkiRJkiRJ6iUHzCVJkiRJkiRJkiRJveSAuSRJkiRJkiRJkiSpl1aMuwKSJEmSJEmSJNVZveaseZevW3vgEtVEkiRNK39hLkmSJEmSJEmSJEnqJQfMJUmSJEmSJEmSJEm95IC5JEmSJEmSJEmSJKmXHDCXJEmSJEmSJEmSJPWSA+aSJEmSJEmSJEmSpF5ywFySJEmSJEmSJEmS1EsOmEuSJEmSJEmSJEmSeskBc0mSJEmSJEmSJElSLzlgLkmSJEmSJEmSJEnqJQfMJUmSJEmSJEmSJEm95IC5JEmSJEmSJEmSJKmXHDCXJEmSJEmSJEmSJPWSA+aSJEmSJEmSJEmSpF5ywFySJEmSJEmSJEmS1EsOmEuSJEmSJEmSJEmSeskBc0mSJEmSJEmSJElSLzlgLkmSJEmSJEmSJEnqJQfMJUmSJEmSJEmSJEm95IC5JEmSJEmSJEmSJKmXVoy7ApIkSZIkSZoeq9ecNTRm3doDl6AmkiRJkjScvzCXJEmSJEmSJEmSJPWSA+aSJEmSJEmSJEmSpF5ywFySJEmSJEmSJEmS1EuNBsxDCAeEEK4JIVwXQlhTs3yTEMKn8vILQgir8/xnhBC+E0K4PP996mirL0mSJEmSJEmSJEnSwgwdMA8hbAh8CHgWsAfwvBDCHkXYS4BfxBgfArwPOC7P/xnwhzHGRwBHAqeOquKSJEmSJEmSJEmSJC1Gk1+Y7w1cF2O8Psb4G+A04OAi5mDgn/L0GcDTQgghxnhxjPHHef6VwKYhhE1GUXFJkiRJkiRJkiRJkhajyYD5DsBNldc353m1MTHGe4A7gFVFzGHAd2OMv15YVSVJkiRJkiRJkiRJGp0VS1FICGFP0m3anzlg+Ti1sxMAACAASURBVMuAlwHsvPPOS1ElSZIkSZIkSZIkSVLPNRkw/xGwU+X1jnleXczNIYQVwBbAbQAhhB2BzwIvjDH+oK6AGOPxwPEAe+21V2yzApIkSZIkSZpMq9ecNe/ydWsPXKKaSJIkSeqrJrdkvwjYLYSwawhhY+AI4Mwi5kzgyDx9OPD1GGMMIWwJnAWsiTH++6gqLUmSJEmSJEmSJEnSYg0dMM/PJH8V8BXgKuD0GOOVIYS3hRAOymEnAqtCCNcBrwXW5PmvAh4CvCWEcElO9x/5WkiSJEmSJEmSJEmS1FKjZ5jHGM8Gzi7mvaUy/SvgOTX/9w7gHYusoyRJkiRJkiRJkiRJI9fkluySJEmSJEmSJEmSJE0dB8wlSZIkSZIkSZIkSb3kgLkkSZIkSZIkSZIkqZccMJckSZIkSZIkSZIk9ZID5pIkSZIkSZIkSZKkXlox7gpIkiRJkiRJkuqtXnPWvMvXrT1wiWoiSZI0nfyFuSRJkiRJkiRJkiSplxwwlyRJkiRJkiRJkiT1kgPmkiRJkiRJkiRJkqRecsBckiRJkiRJkiRJktRLK8ZdAUmSJEmSJGk+q9ecNTRm3doDl6AmkiRJkqaNvzCXJEmSJEmSJEmSJPWSA+aSJEmSJEmSJEmSpF7yluySJEmSJEmal7dEl6TlzX5akqSF8xfmkiRJkiRJkiRJkqRe8hfmkiRJkiaKv56RJI3KsM8UP08kSZKk6eeAuSRJkqRWHLCWJEmq50UYkiRJk8dbskuSJEmSJEmSJEmSeskBc0mSJEmSJEmSJElSL3lLdkmSJEmSJEmSFmGSHlvkowMkSZrNX5hLkiRJkiRJkiRJknrJAXNJkiRJkiRJkiRJUi85YC5JkiRJkiRJkiRJ6iUHzCVJkiRJkiRJkiRJveSAuSRJkiRJkiRJkiSplxwwlyRJkiRJkiRJkiT1kgPmkiRJkiRJkiRJkqReWjHuCkiSJEmSJEmSJEnLxeo1Zw2NWbf2wCWoiaSl4IC5JEmSlo1hX0j9MippGnkyTpIkSZKk8fGW7JIkSZIkSZIkSZKkXvIX5pIkSZIkSZIkacG8Y44kaZI5YC5JkiRJkiRJklThRQCS1B/ekl2SJEmSJEmSJEmS1EsOmEuSJEmSJEmSJEmSeslbskuSJEmSNGW8haikcRnW/3Td94y7fEnS8uUxsqRBHDCXJM3hwaMkSZIkSZIkSeoDB8wlSZIkSb3mxYIaNfcpSZqf/aSmjfu0JE02B8wlSZL0/3kLS0nLnf2UJPWPA1GShrGfkCQthgPmkiRJmjieDJEkjYoXYUiSJElSvzlgLkmSNKE8wT8ZbCdJ0nLm55QkSdLy4w8FpKXlgLkkSZI0YfziLEnzm8Z+chrXaVq1uQjBCxYkSaPQ9+MEP08lLZYD5pIkSZIkNeTJOEmaDn0fXOrCtG5TP/slSZp+DphL0jI0rV8yNX08cSBJkqQ+8DuatPz5PpWmyyS9pz0/Jk0+B8wlSdIsk/SFRJIkSdJkmqTvHZM0EDJJdZXGxfeJNFq+pzQNHDCXJEkTq+kB+SSdjJMkSYN5Mq4Zj336zfeJJGkUPJ5Qn3k81T8OmEuSJEmaWuP+kjvu8jV93KckjYoDIZIkTQe/I0iL54C5JNXwxIGmjfu0JGlU2pyM8cSNpklXx1O+TzQJ/D4haZT87FNf9f3ztO/rr+XNAXNJkiRJknrMk9aSJElLZxqPvbyodjI4YC0N5oC5JEmSJE0pT0aNjyejJEmSJEmaDA6YS5IkLSMObo2eg1aStPTseyVpfvaT4+X2l6T52U+qbxwwl6QJ58GLJGka+HkmSZIkSev5HUmSlo4D5pKkZccvBBonf+EtaRg/pyRJUp/4HUmSJE07B8wlqUf8kitJ0vLUZhDez/NmvLBhcrhPS8PZp2nU3KfGy88+SZKWFwfMpSnglxxp+fN92m+2vyRJkiRJ7fhdWpK0VBoNmIcQDgDeD2wInBBjXFss3wQ4BXgccBvw3BjjurzsjcBLgHuBo2OMXxlZ7SVJGjOvCldfeeJC0ijZp0gaJY/RJUmS+qPpsZ/fOzWfoQPmIYQNgQ8BzwBuBi4KIZwZY/xeJewlwC9ijA8JIRwBHAc8N4SwB3AEsCfwQOCcEMLuMcZ7R70i0jhNa0c7KScZpnX7T6NJ2afGzX1a08Z9urlx95PjLn+c+r6f9n39JUmSJElSfzX5hfnewHUxxusBQginAQcD1QHzg4G35ukzgA+GEEKef1qM8dfADSGE63J+3xpN9SVJfdfnwZ1p5aCNxmka+5RpXCdJkiRJkjS9JulcxiTVVYM1GTDfAbip8vpmYJ9BMTHGe0IIdwCr8vzzi//dYcG1lbQsObjVb5N0QDBJdZVGyX569Nymzdn3SpIkSZIkaTkLMcb5A0I4HDggxnhUfv0CYJ8Y46sqMVfkmJvz6x+QBtXfCpwfY/x4nn8i8KUY4xlFGS8DXpZfPhS4ZvGrpha2AX42xljLn77yp3GdLL/f5U/jOlm++5TlT1f507hOlt/v8qdxnSzffcryp6v8aVwny3efsnzLX+55Wn6/y5/GdbJ896mmeWo0dokxblu7JMY4bwKeCHyl8vqNwBuLmK8AT8zTK0gNHMrYapxp+STg2+OMtfzpK38a18ny+13+NK6T5btPWf50lT+N62T5/S5/GtfJ8t2nLH+6yp/GdbJ89ynLt/zlnqfl97v8aVwny3efapqnqfu0AcNdBOwWQtg1hLAxcARwZhFzJnBknj4c+HpMrX0mcEQIYZMQwq7AbsCFDcqUJEmSJEmSJEmSJKlTQ59hHtMzyV9F+nX4hsBJMcYrQwhvI139cCZwInBqCOE64OekQXVy3OnA94B7gFfGGO/taF0kSZIkSZIkSZIkSWps6IA5QIzxbODsYt5bKtO/Ap4z4H/fCbxzEXVU944fc6zlT1/507hOlt/v8qdxnSzffcryp6v8aVwny+93+dO4TpbvPmX501X+NK6T5btPWb7lL/c8Lb/f5U/jOlm++5SWiZDvky9JkiRJkiRJkiRJUq80eYa5JEmSJEmSJEmSJElTxwFzSZIkSZIkSZIkSVIvNXqGuaZLCOFhwMHADnnWj4AzY4xXjSDfHYALYoz/WZl/QIzxy5XXewMxxnhRCGEP4ADg6hjj2UPyPyXG+MKGddkX2Bu4Isb41cr8fYCrYox3hhA2BdYAjwW+B7wrxnhHJfZo4LMxxpuGlLUxcATw4xjjOSGE5wO/C1wFHB9jvLuIfxBwKLATcC/wfeATMcY7m6ybNEohhPvHGP9j3PWQpKVk3zcZbKfJYVtJo+V7SpIkSZKWlr8w75kQwhuA04AAXJhTAD4ZQljTIp8XF6+PBj4PvBq4IoRwcGXxuypxxwIfAD4SQvhr4IPAfYE1IYQ3VeLOLNIXgENnXtfU58LK9EtzvvcDji3W6yTgl3n6/cAWwHF53slFtm8HLggh/GsI4RUhhG0HbI6TgQOBY0IIpwLPAS4AHg+cULOd/gG4T16+CWng/PwQwv4D8p9IIYT7j7sOSyGEsEUIYW0I4eoQws9DCLeFEK7K87ZcgvK3DyF8JITwoRDCqhDCW0MIl4cQTg8hPKCI3bpIq4ALQwhbhRC2HmGdVi3y//cKIZwbQvh4CGGnEMLXQgh3hBAuCiE8ZhH5rggh/GkI4cshhMty+lII4c9CCBs1zOP44vWGOc+3hxCeVCx7c2V6ZQjhL0IIfx5CuE8I4UW5P3t3CGGzBuV+f8D8R1amNwohvDnn+64QwsrKsleFELbJ0w8JIXwzhHB7COGCEMIjijw/E0L4nw3r9aAQwkkhhHeEEDYLIXw0hHBFCOHTIYTVlbgNQgh/EkI4K4RwaQjhuyGE0+r6vXG2U3694LZabDvl5Y3aatztlOPH1v+FKez7ch4j7//G2U65/EZttVTtlMtadp9Tk9JOObbv7yk/pybgc8r3VG2dll3fJ0mSJEnLRozR1KNE+jXzRjXzNwaubZHPjcXry4HN8vRq4NvAMfn1xUXchsBK4E5g8zx/U+CyStx3gY8D+wP75b+35On9aupTLeMiYNs8fV/g8sqyq6plFHlcUuZJuqjkmcCJwK3Al4EjgftV4i7Lf1cAPwU2zK9DdZ2q65+nVwLfyNM7V9chz9sCWAtcDfwcuI30q/W1wJZLsK9sD3wE+BCwCnhrrv/pwAOK2K2LtApYB2wFbD3COq1a5P/vBZyb962dgK8Bd+R95jELzPMrwBuA7Ytt9wbgqy3y+VJlenPgr4FTgecXcR8uXn+ZdKHKGuCyXO5Oed7ni9jfAjcU6e789/pK3AHFfnhizvsTwHZFnmuBbSrb93rgOuCHFO9V0vv6zcCDh2yLC4FnAc8DbgIOz/OfBnyriN0MeBtwZW7LW4HzgRfV5PvJvE8/AdgxpyfkeZ+aZ3+u7tc3F3mekLfL/wK+A7y3ur6V6dOBvwU+DPwL6aKeJwN/A5xa5HkXqX+8M0/fRbobxV3AneU2rUz/LfAxUj/5PuCUyrIrK9NnAX+Up/cH/r3I80fAGaR+53Tgj4CNB7TVN4GX5/3vCuB1ef97CfD1StzJpD5kX+Dvcps9AzgHePVyaac2bdVFO7Vpq3G306j6Pyp9X5v+jw76vjb9Hx30fW36P9r1fRPxOdVFO7Vpqy7aqU1bddFOvqc6e0/5ObV+etl+TjEhfV+b9xRTeoxe+Z/tSHd/e2y5Pg3barO2/zNPXo2/wwIHjTJP4CHAYcAeNcsanwcAVhTtsdd8dQC2BR4DPHLQtiSd49iHdMe8Q/N0aLltHzZgft15qm2K1xsAG+TpjfO+0nS7vqLpfpTz3bKYv3F1XYGnkPqqZ9Xk8ciW22TnmfJI59MOBx4+IHYvUn960KBt2WVbNWmnxbTVYtupTVt12U4t22qq+76m+Y6q78vxjfu/Jn3fKNpqlO3Upq1G3U7ztVWX7dS0rbrq+/L8sX9OjaLvy8sa938d9n2LaqvFtNNi2qpJO42yrUxLn8ZeAdMSN3gafN2lZv4uwDXFvMsGpMuBXxexVxavNyOdJHgvlYFoZg9slwPE1bgNgNeQBjQfneddP896XUoanF0FfLtYVi3z08CL8/TJwF55enfgouL/ypNTG+XO/pPArZX5V+SObivSCait8/z7UBmgz/MuBzbJ01tV60q6fXw11pM8E3CSh+J9M98y1h9Yl+lxwC2VuP+T1/8Q4Mz8ema/KffL6v5dXshSXgTyutyuj6jMu6Gm3tWTpicA7yD1Ea8BPlfu05Xpc4HHV95T5XvxBuA9wI25LV4DPLCm/PnWqew3Pg+8iHSy+rXAXwK7Af9EesxCNfb787TV9yvT9+b9rbo/z7z+TfF/1Qt9VgDHA58h3T2iuh6X5L8B+An5wIj6C2s+AJzC7IGEOe1Us60uIR8YlvlW90Xm9nVl+Rfnv5sDLwDOJu3/JwPPXEhb1ZRxfv67CXP7ybG1U5u26qKd2rTVuNuprOt8y2jY9+XYRv3fkHVaUN9XU8bA/o8O+r6WbdWm75uIz6ku2qlNW3XRTm3aqot28j3V2XvKz6n108v2c4oJ6fvavKeY3mP0R5O+Z11FuvjhHNJ5i/OBxw5qx5r63ViZfkT+/5tI76etKssuLP7vSbnsK0kna78G/CD/7xOL2EOLdBjpfXgocGgl7s2V6T1IP1y4gXRR+T5Fnuey/nvvC3LsCaRzB+WFIPfk7fMS5hmYyNv+tpzXs0h9z7/kdXpeEbtHzvM64Deku+XdQLpwZotK3DNzzJdy/U4g7bfXUbynm7ZTfv0U4GbgZ8BXgdUD9vlDSD9QuIX0iMEL8jrdDPxhkedri/S6nP9rgdcWsdWLx/YlvQ/Ozdvq2ZVll87sR8CfA+eRzkF8DfjrIs97gWtJdy2cM/hXxK7J2/tq4Kj898S8P762Ercf6Ycp5wC/AL4I/DvwDWCnIs+Rt1XTdmrTVl20U5u26qKd2rQVHfR9bfo/Ouj72vR/dND3ten/aNj3jaqtFtpObdqqi3Zq01ZdtFObtmIKP6fooO9r0//RQd83qrZaaDu1aaum7dRlW5mWPo29AqYlbvD0vPCZDun4nGY6pAOK2J+SDgp2KdJq0vO6q7FfJw9sV+atIJ2kubcy7wJgZZ7eoDJ/i7LzyvN3JA1yf7DsCIu4daw/AXU9+RfQpEHPS4pyPkY6sLiANKh7PfB/gUcVeV48T3krK9OvyXn8EDg6d7AfJR04HFv83zGkAeKPkj5kZgbvtwW+WcR6kmf99Lks05M8pA/hv2D2ycjtSBcYnFPkeS/pvXJuTfrvebbvm0gHGatq2unSyvQ7Bm3DmvfUe0mPLZhzIUrRTmVdytdXka8KJZ+0HFR+ke+TSb+M+kle/5dVln2LdPD0HNL76pA8f7+atr+0eH1R/rsBcHWx7PycZ7Xv2QB4LnBBZd61wM4D3ns3Fa+vrok5NrfXtZV51X7opPnWIc97XN5Xjs51rL1giNT3zHwRKk8UV/eNd5L6vgcB/5v0C7ZdgBcDXxzUTpV5q4A/o/Irrzz/O6T35N6kg8aZi5AewuyT5t8hX9BC6pu+WVn2veXSTm3bqmU7/dGwdmrTVgtsp8ePqp3yvEb9Hw37vnL759e1/R/z932X1dR1aN9XbteaulT3jZH3fXl5o/6vZr+Zr+9bzp9T5eDXSNupTVt10U5t2qqLdvI91dl7alo/p4YeT+TXXX5OlccTu7Hw44mJ6fuK99T76N8x+iUUJ+fz/CfU5FOeuKyewPx5Je7fSOc+tgReTzqxO7PvlN/7LiQNXDwx73/7Vvax8k5Md5NOAJ9EuvjjZNJF8ydTeT8W2/Qs8i+GSPv4eUWeV1S3E/muaqQ70tXdse4PgH8mDTR8HjgC2LQmbhtgV9JdJmbWfbuaPM8HHlqp3z/l6ZcCZxT71OqadtqVuf3GBwakv2fuHS4uAvbM04eT+s4nlG1FugPg9pV1mqnzLjX7313Ap4C3kPrSY0kn749l7jmaaludSx78IvVxtT9wIA0IbJqnV9Rs04uBh5P6y+tIJ8bXDNh+V5LuuLgq17t6t8Qrijxnlu0KfDZPP4PiBxVdtFXTdmrTVl20U5u26qKd2rQVHfR9ObZR/0cHfV9NWw3s/+ig76vEDu3/aNj3tWmrLtqpTVt10U5t2qqLdmrTVkzh5xQd9H2Vug7t/+ig72vTVl20U5u2atpOXbaVaenT2CtgGkOjpy+pTyCdEDksT29YE3ci+UO4Ztknitc7UvkldLHsSZXpTQbEbENlsLVm+YEUV6I3XNeVwK418zcHHkU6iVR7Gx1g9xblPJA8QEs62Dkc2HtA7J55+cDbkuS45XySx4HY9fO3Ao4jXQDxC9JtJ6/K87Yu8rgC2G1Ae99UrPsGxfIXkQ5UfljMfxs1tyIiDYSdUVdWXn4Q6aDzJzXLbmb9Qf31zL5NTHmQ9eq8rz6VdIvM9+ft+VfMvdV43YnTDUlfEk6uzHsU6Q4LXwIelvO8Pa//7xb/fx7rvywcBHylsqy8sGQ16UDnP0hXsX4/T3+KSj8BvJLiAprq+havP05xsVGefxRwd+X1CQPa6cHAvw0oawPSCe5/pbhIqRJzcpG2y/O3B/6lZh+6gPQF6y7ge8C7mHv19DfryhpQ/tOAa/I+uy/pIpxr83Y9uBL3VNIFLdeSLnDZJ8/fFnj3gHa6NbfRTH6dt9NC2qphO32saTvl+S8e1lYjbKdDatrputxOM18u5rRTnt+o/6Nh35dfN+r/6KDvy8sb9X900Pfl+Y9mbv/3i7z+1eOpNn3fxH1Ojaqd2rQVNRdKztNOdZ9Tc9qpTVt10U5T/J5abFvNOaZo2k759WrGdDyR53XxOXUys0+uDvucehFL9zm10OOJmffUVaT307Lv+4a9p1iex+hN+r6Dmf89NfDRcMB1xetfkX4NdWxNur0SV36Xe0reb55Qri+zT3aXJ9TL2MeTLpB/eWXeDTX1rr2Dx6DXwA55+lzgPpU2KO/kV813U+B/kO5GcRuVczTMvrCm/LFDua+U26paRvWk9bVUbp9bmb9xTTvdBbyM9Di7Mv1sSPl7kvqDQwZtR+aepC/baWfSuYnjWP+DjSYXdn1nnmXnkW9BS/qxwMwvw+7ToD57k86T3MzcgaiZR/xtSOrzqhdjXVHGVWKrdSv3k5G3VdN2atNWXbRTm7bqop3atBUd9H0D2qq2/6ODvq+mrQb2f3TQ9+Xljfq/mu1U2/e1aasu2qlNW3XRTm3aqot2atNWTOHnFB30fQP+t7b/o4O+r01bddFObdqqaTt12VampU9jr4DJZKpPzD5xWp7k2aqI9STP3LKWciD2YcDTy+3F3Ls2HE6+aq2mvtVBq3cDT6+JOYCaA/Vc/tOGlV/Gkg5gH17GMvfAfuYKwe0pnmOZ5+9POkl8Mekq0bNJBzQbFXGntdj/f6fJOuU2vZB0su7fWH9V4LbA0TX57kM6EFxFuq3V6ylujZPj9mb9XQ32yPvtnLg2sQPiDqTmGT1F7JNJVzMOKn+fBZS/J+l9uKh1qil/z3m26ROb5ln5n1U5fbzhfjNn/xxlbF1bVWIeANzWUfmndpDnFyk+D2bWkcrznVrm+eS8X5W32m3U9+XXrfq/yvJ98z419PZduZ5vroulRf9HB31fi21a9n275/lz+r78Ht0iT68kfb5/kXQ8UV4wM/LPqVz+5nl6U9Ln+BfK8ou4lbmMcwbUc+SfU23aqdimmw7Zpo9s0lakAc2dGpY/8vdUy/JnxVI5nljke+opw9ppAW3VaL0q7XT7fO2U521MOknzDNJn1B+TLtZ8ZbFPbQK8cGb7A88n3TXrlTXrNF/sxi1iNyrqWY17Aen4+xUDyj+yYV3LfP8Y+NAi13/jovxB23Rj0kVlzxmWZ17+YNJtDj9A+uX2n5H7mYW8p2h/jP4g0nHR+0knIWvLr4n9R9J3oc2LmOp76S007/u+y/r31J/WbP8276mZbTqzTi8fsE3bfE59gPTrtucCv5vTc/O8Dxax5wGPG1C36vfeS6nvj6+lOF5j9oXiZR8656Ql6SKUY0iDBntTf4L7dtId3b5Augh05aA8cztdSfos+WBex2NJt+V8fRFbexc80p30jqy8PpP0KLYPki6s/1vSd59jqXyvzbGfId1N7Uk57qQ8fyNmX9j1RlL//AbSe+/5efpi4I1Fnl+n+H5dWXZD8frbFD++IF2MfwlwV3XdWf+s0b0r8zesa6e87GDSDwQOr2unHPNL1j968C7Wn7TegNmDq4/M+9UpOf2AdIHRt5n7uLtB7RSY+3i5j5EeUfd50uP/TiX1gScCp1fiTsrz/pj0vn5vnr+SuXdtGHlbNW2nhbTVKNupTVt10U5t2ooO+r78ulH/Rwd9X45r1P/RQd+X5zXq/2jY97Vpqy7aqW1bjbqd2rRVF+3Upq2Yws8pOuj7hrTVrP6PDvq+edpqTdlWXbTTQtpqWDt12VampU8zzzuTNEFCCC+OMZ5ceX046VfX19TEHhJj/FyefjfpNijnFDEHAH8fY9xtIeXXLN+UdDudK6qxIYRji9APxxhvDSFsT/pVyAuLfPYnnYTZnXRbkpuAz5EOju6pxJ0WYzyiSd2brlMI4ZGkX/DsRjow/JMY4/dDCNuSnqfzgRx3NOkk3VWkXwYeE2P8fF723RjjY4tyHgbsQLpl539W5h8QY/xyg7hnxRi/VHn9auBVTcpvU9em9ewiNtfzFaSLRZps09/JeZ4/ZJseS3o20grSgf3epGfpPIN0QP7OAXH7kL5szIprE7vIPGvruch1apPnouvasvwzmeuppANlYowHDYgLpMGWWXFdxTatZ1exi1ynpnkOrGeOvzDGuHeePorUv3yOdCePL8QY19bkRwhhX9I+cEWM8at1McNii7Jfmsv+bF3ZNbGvaFLPNnUNITw5x12+0HVaTF2H5Hkl6Veu94QQjgf+i/Trzafl+YdWYvchXaV/Z/4sfyPwGPKvR2OMd1Tiro4x3jFf3IDyfwmcUZa/gHrOlL+S9OV6UPnVdZqJfSzps71cp6HrPoK6viGXX27TO3I+PyCdlPh0jPFnA9r7aNIt7m6qW76Q2KL8T+byb20Ye/pi69rFOg2oa+16tczzn0mfZ5sCd5BuSfhZUvuHGOORRdxK0knJzUgn/GbFNYglxviitrE1cbX1HEH5o1z/xWzTsp5Hk24L+k3g2aQTY7eTHpHyihjjN6gIITyIdFv6nUh37/o+6ddQdy4wrnH5OfYPSY8JGxb74Fz+jvOVX6nrYZW6XjMkdt71WsA2fXAlz3uG1PVZpJORO+RZPwLOjDGeXcQ9lHRb27r38XYxxp/m6eeTTmieX8TsDPxljPGllXkHke7g9sua+h8WY3x3WVZevgPpQoy9YowPKpbtV4R/N8Z4VwhhO+DwGOOHivgtSCeLZ7733gx8PsZ4dRH3+hjje+rqU8RtTjo2iqTBiANIF8rfCLw9xnhLJXZL0uMV9iCdvF2b67oF8DvVbZi/d9W10/eK8rcGflVu0wF1fTpwa4zx0mL+FsCrKt8nHk86zvpVEbeadKH7xwfkf1/SBfj7xBh/r2b5LsWsH8cY7w4hbAP8XozxM5XYDUnHZNV2+kqM8fYiz+fHGD8xbN1z7ArSHfAi6fhob9K+cCPwoRjjf+W4jUi3H55pp5NijPfmY5b7xxh/WOS7B+nC/5G0VdN2yvNat9Uo2ynHD22rLtopxzZuqxDCs6lvpwX1fTPrRYP+bxF93wOBv6Om78vLy/7vOzHG/6zr/0bd9+XYsv/7fdLFdrP6vzZ9X44f+jmV2+m2uuPihbZTnte6rUbZTjl+aFuNqJ1+SLrL6SR8Tm0JvLLLz6mavu+WGONvFtP35bhG/V9XfV+OH9pWXbRTnrcUn1MjaSuNQVwGo/Ymk6ldYp7nudfEvniUcQsov1Fsy/JHHrvQ2kJW+gAACiNJREFUbUq6cmyzPL2adDXYMfl1eRujo0knqj4HrGP2LSart255dZO4BZTfKLZl+Y3WqU2+C9imV7fYVhuSTrLeyexfPJbPXRoaN+48p7j875JuTbs/6a4S+wO35On9KnEXN4nrKrZpPRdQ/tjWv02eNf3GRcx+nlX12dAXVqZfSrrC91jSFbprijwbxTYtewGx1fKPmqf8Mu7ixa7TIrbpwHrm5dXb1JX9Yvk4lCtZ/ziU40knWfbNeX+mbVyb8ruo54DY9y3VOrXcpheTrj5/JunK/FtJt2c7ErhfkecdwI9Jt9h+xcx+UpeaxrYsf+R1LeJeTuVOFwtdpzZ1rSl/vjxnbk24Avgp+dFWQGD2Z1+juK5ip7H8lnleXlm+EvhGnt6Z+uPJr5LuPnIe6Rfz7yRd2LJ/27gFlN8otmX5x7SIbbr+I9+mJpPJZDJNYiINAI4srqtYBjyGdAnLH+v6myYnAatGGddV7LjLN3Wfxl4Bk8lUn0i38ahLlwO/bpFP0wHrGxda/ijq2rSei4ntYpsy9zksm5FOxL6XuSfNmw5YtxkwblN+o9iW5XcxYD/ybVpTRrnskrZx485zisvfAHgN6Zfoj87z6m5N1Siuq9hpLL9NnnnZpaTHh6wCvt1k32BEg9tNy15AbNPyuxqw72Kbfpp8oRfpNl975endgYuK2C4GtxuV30U9x71OLcsvl21E+sXRJ0lXys/aFxjx4HbL8kde1y7WqU1dW+Z5BenW4FuRbre3dZ5/n6K9G8V1FTuN5bfM83Jgkzy9FZU+lbm3RWw6YN12ELxN+UNjF1D+qAfsR75N87wtgLWsf978bXl6LbDlgNir54ttGtdV7ISWP3T7D0rAl5rEdRVr+bPjgM1Jtzo+lXR3vOqyD88TW96y98Nt48adZyV27bD177j8Juu/PfAR0gVFq0i/XLwMOB14QPF/dbGXLyZ2BHkuqq4dr/+Hh+U7IG5QnlvXpHWkz8Kt54lbVRfXVWzTenYVu8h1alP+oPWvPmpyC9JdQy8j3b1ruyLPMvbExcYWcVu2yHPLQXVdRJ7jXqdh5a8lXyANPI702KhrSXcY2G9A3F457royrqvYAXFz6tllXU1Ln1YgabnajnRLml8U8wPpKv31M0K4bEAeIefTKq5t+U1j25TfUezItynw0xDCo2OMlwDEdAujPyA9u+URxf9uEPMtw2OM60K65fwZ+bYtYQFxbctvGtum/C5iu9imAL8JIayM6VY+j5uZmW/j9NsFxI07z6ksP8b4W+B9IYRP578/hbnHK03juoqdxvLb5JltAXyH9F6LIYQHxBhvCSFsRtGnhRC2Ig1GhZhvJRhj/K8Qwj1Fnk1jm5bdNrZp+V2sU1fb9Cjg/SGENwM/A74VQriJ9JiTo4rY6qNULg0h7BVj/HYIYXfg7gXEtSm/i3qOe53a5DtrX4wx3k16tt+ZId3KvVgcf0v69eZX8+3vngU8D3gP6RnBbWPblN9FXbtYpzZ1bZPniaRBqA2BNwGfDiFcDzwBOG0BcV3FTmP5bfI8AbgohHAB8GTgOICQHq/0c+ZaQboV+SakizWJMd6Y94WFxLUpv01s0/K7iO1qm55OevzLU2KMP8l5bk+6hfjppAtZytj9i9gji9imcV3FLtfy59um5faflWcI4bHUC6THaK2f0UGs5TfPk3Qx37Wkx8X8SUiP8Ht+jPHXpP5yvtjDBsQ2jRt3nm3Wf6nKHxT7MdIzsO9LegTaPwMHAocA/0C6VfF8sc9eZOxi81xsXZdy/evybZPnz0gDWVU7kO4OF4EHtYzrKrbv5b+LdMErpGed/4T0yJtDgX8ktS0DYm8ZQWw17j0t8nzPPHVdaJ7jXqdh5R8YY1xTyfe5McaL8nfkT5AGkcu4v5knrqvYcZevcShH0E0m0/JIpBNC+w5Y9oni9U9JX5J2KdJq0rOdWsUtoPxGsS3LH3lsR9t0R2D7AXk+qXj9dfKvNivzVgCnAPe2jVtA+Y1iW5Y/8tgutmmev8mAPLcBHtE2btx5Tmv5NTEHkp7zOzCmTVxXsdNYfps8i/9bCexaeb2OdMXsDfnvA/L8zZj7y93GsU3KbhvbtPylXKfFbtPK/2wOPIp00UrtrflIA/YfIz3v+QLSgO71pOfqPqptXNvyR13P5bBOLcrfvcV77OJ5lq1cSGzL8kde1y7WqU1d2+SZ5z0QeGCe3hI4HNh7oXFdxU5j+S3z3DMvf9iQ9j+G9AuYj5IG5GfuILEt8M22cW3LbxrbpvwOY0e6TfO8a+bJ55qFxHaRZ9/LJ1388HXSwFKZ/rv4v5HHWn6rPMtj0TeRHtuziuF30amNnZQ8J6z86h08yjs+zndnt5HEWn6rPF9HGgisnuO4oRrTJq6rWMuf9/1dvh557KTkuUzKv4r1jy07v1h2edu4rmLHXb5pPGnsFTCZTItPNB+wbjxgPM56dhnbRV1b5Nl0wLrxgHFH7TTyQfiu1mvc28pkMi08scjB7eVY13Gv06jyZISD2x23S+Pyx71Oo8yXjga3O2qjpgPWY12ncW8n0/gTzQeCGw+Cj7OeXcZ2sE2/CvwFs28Buh3wBuCchcR2kWffyyc9EmG3AW14U/F65LGW3yrPq0h3YqvOexFwJfDDhcROSp4TVv6llel3FPFzHts06ljLb55nnrcj6bFM7wXux+DHoTWK6yq2z+UDNwOvJQ2wX0+6E9vMssu6jp2UPJdJ+a8mHX88lfQ4hPcD+wF/BZzaNq6r2HGXbxpPGnsFTCaTyWQymUwmk8lkMplM/UukZ5Aex/rnbf+cNOB0HLDVQmK7yLPv5ZMufnjogDY8pHg98ljLb5Xnu4Gn18QdAFy7kNhJyXPCyn8bsFlN3EOAM4p5I4+1/OZ5FssPAs4HfjIopk1cV7F9LB84tkjb5vnbA6d0HTspeS6H8vP8/YFPARcDlwNnAy8j//K6bVxXseMu37T0aewVMJlMJpPJZDKZTCaTyWQymaqJfCv3UcZ2kWffy5/GdbJ89ynLt/x5lm8KPHxYbNO4rmL7Xv4k7VPLJU/Ln5zyTd2lkBtCkiRJkiRJWhZCCDfGGHceZWwXefa9/GlcJ8t3n7J8y1/ueVp+v8ufxnWy/Hax6saKcVdAkiRJkiRJ/RNCuGzQItKztFvHdpFn38ufxnWyfPcpy7f85Z6n5fe7/GlcJ8tvF6ul54C5JEmSJEmSxmE74PeBXxTzA3DeAmO7yLPv5U/jOlm++5TlW/5yz9Py+13+NK6T5beL1RJzwFySJEmSJEnj8EVgsxjjJeWCEMI3FhjbRZ59L38a18ny3acs3/KXe56W3+/yp3GdLL9drJaYzzCXJEmSJEmSJEmSJPXSBuOugCRJkiRJkiRJkiRJ4+CAuSRJkiRJkiRJkiSplxwwlyRJkiRJkiRJkiT1kgPmkiRJkiRJkiRJkqRecsBckiRJkiRJkiRJktRL/w88lF7TqQG/cAAAAABJRU5ErkJggg==\n"
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "imp= pd.DataFrame(xgbc.feature_importances_)\n",
        "f_imp= imp.set_axis(['Score'], axis=1, inplace=False)\n",
        "f_imp"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "outputId": "d80e902f-fe0e-47d1-8399-f661659a3668",
        "id": "H2nUYEgRyUYy"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "            Score\n",
              "0    0.000000e+00\n",
              "1    0.000000e+00\n",
              "2    0.000000e+00\n",
              "3    3.588325e-07\n",
              "4    0.000000e+00\n",
              "..            ...\n",
              "162  1.240596e-03\n",
              "163  1.025522e-03\n",
              "164  4.259511e-03\n",
              "165  4.135416e-04\n",
              "166  3.049221e-02\n",
              "\n",
              "[167 rows x 1 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-36e0ff48-1946-49a6-8f4b-6f661c469e8d\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Score</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>3.588325e-07</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>162</th>\n",
              "      <td>1.240596e-03</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>163</th>\n",
              "      <td>1.025522e-03</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>164</th>\n",
              "      <td>4.259511e-03</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>165</th>\n",
              "      <td>4.135416e-04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>166</th>\n",
              "      <td>3.049221e-02</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>167 rows × 1 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-36e0ff48-1946-49a6-8f4b-6f661c469e8d')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-36e0ff48-1946-49a6-8f4b-6f661c469e8d button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-36e0ff48-1946-49a6-8f4b-6f661c469e8d');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 45
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "##\n",
        "from google.colab import files\n",
        "\n",
        "f_imp.to_csv('asxl_UnderMACCS_GB_HPT_FeatureImp.csv', encoding = 'utf-8-sig') \n",
        "files.download('asxl_UnderMACCS_GB_HPT_FeatureImp.csv')"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 17
        },
        "outputId": "558df66c-f3a9-4453-e253-31b805388117",
        "id": "pDGu3j2_yUYy"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_0a560f4b-3557-450c-a08a-07fa2b73cf4a\", \"asxl_UnderMACCS_GB_HPT_FeatureImp.csv\", 3967)"
            ]
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!cp 'asxl_UnderMACCS_GB_HPT_FeatureImp.csv' /content/drive/MyDrive/PhD/XGBoost_MACCS"
      ],
      "metadata": {
        "id": "WnXejM1syUYy"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Decision Boundary"
      ],
      "metadata": {
        "id": "aSpCFhloyUYy"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "K66FZmL-yUYy"
      },
      "outputs": [],
      "source": [
        " #### plotting  trail             https://scikit-learn.org/stable/auto_examples/ensemble/plot_voting_decision_regions.html#sphx-glr-auto-examples-ensemble-plot-voting-decision-regions-py\n",
        "from itertools import product\n",
        "\n",
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "from sklearn import datasets\n",
        "from sklearn.tree import DecisionTreeClassifier\n",
        "from sklearn.neighbors import KNeighborsClassifier\n",
        "from sklearn.svm import SVC\n",
        "from sklearn.ensemble import VotingClassifier\n",
        "\n",
        "# Loading some example data\n",
        "iris = datasets.load_iris()\n",
        "X = iris.data[:, [0, 2]]\n",
        "y = iris.target\n",
        "\n",
        "# Training classifiers\n",
        "clf1 = DecisionTreeClassifier(max_depth=4)\n",
        "clf2 = KNeighborsClassifier(n_neighbors=7)\n",
        "clf3 = SVC(gamma=0.1, kernel=\"rbf\", probability=True)\n",
        "eclf = VotingClassifier(\n",
        "    estimators=[(\"dt\", clf1), (\"knn\", clf2), (\"svc\", clf3)],\n",
        "    voting=\"soft\",\n",
        "    weights=[2, 1, 2],\n",
        ")\n",
        "\n",
        "clf1.fit(X, y)\n",
        "clf2.fit(X, y)\n",
        "clf3.fit(X, y)\n",
        "eclf.fit(X, y)\n",
        "\n",
        "# Plotting decision regions\n",
        "x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1\n",
        "y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1\n",
        "xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.1), np.arange(y_min, y_max, 0.1))\n",
        "\n",
        "f, axarr = plt.subplots(2, 2, sharex=\"col\", sharey=\"row\", figsize=(10, 8))\n",
        "\n",
        "for idx, clf, tt in zip(\n",
        "    product([0, 1], [0, 1]),\n",
        "    [clf1, clf2, clf3, eclf],\n",
        "    [\"Decision Tree (depth=4)\", \"KNN (k=7)\", \"Kernel SVM\", \"Soft Voting\"],\n",
        "):\n",
        "\n",
        "    Z = clf.predict(np.c_[xx.ravel(), yy.ravel()])\n",
        "    Z = Z.reshape(xx.shape)\n",
        "\n",
        "    axarr[idx[0], idx[1]].contourf(xx, yy, Z, alpha=0.4)\n",
        "    axarr[idx[0], idx[1]].scatter(X[:, 0], X[:, 1], c=y, s=20, edgecolor=\"k\")\n",
        "    axarr[idx[0], idx[1]].set_title(tt)\n",
        "\n",
        "plt.show()"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": []
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
